{
    "document_name": "24587-i40.docx",
    "content": [
        {
            "title": "Foreword",
            "description": "This Technical Specification has been produced by the 3rd Generation Partnership Project (3GPP).\nThe contents of the present document are subject to continuing work within the TSG and may change following formal TSG approval. Should the TSG modify the contents of the present document, it will be re-released by the TSG with an identifying change of release date and an increase in version number as follows:\nVersion x.y.z\nwhere:\nx\tthe first digit:\n1\tpresented to TSG for information;\n2\tpresented to TSG for approval;\n3\tor greater indicates TSG approved document under change control.\nY\tthe second digit is incremented for all changes of substance, i.e. technical enhancements, corrections, updates, etc.\nz\tthe third digit is incremented when editorial only changes have been incorporated in the document.\nIn the present document, certain modal verbs have the following meanings:\nshall\tindicates a mandatory requirement to do something\nshall not\tindicates an interdiction (prohibition) to do something\nNOTE 1:\tThe constructions \"shall\" and \"shall not\" are confined to the context of normative provisions, and do not appear in Technical Reports.\nNOTE 2:\tThe constructions \"must\" and \"must not\" are not used as substitutes for \"shall\" and \"shall not\". Their use is avoided insofar as possible, and they are not used in a normative context except in a direct citation from an external, referenced, non-3GPP document, or so as to maintain continuity of style when extending or modifying the provisions of such a referenced document.\nShould\tindicates a recommendation to do something\nshould not\tindicates a recommendation not to do something\nmay\tindicates permission to do something\nneed not\tindicates permission not to do something\nNOTE 3:\tThe construction \"may not\" is ambiguous and is not used in normative elements. The unambiguous constructions \"might not\" or \"shall not\" are used instead, depending upon the meaning intended.\nCan\tindicates that something is possible\ncannot\tindicates that something is impossible\nNOTE 4:\tThe constructions \"can\" and \"cannot\" shall not to be used as substitutes for \"may\" and \"need not\".\nWill\tindicates that something is certain or expected to happen as a result of action taken by an agency the behaviour of which is outside the scope of the present document\nwill not\tindicates that something is certain or expected not to happen as a result of action taken by an agency the behaviour of which is outside the scope of the present document\nmight\tindicates a likelihood that something will happen as a result of action taken by some agency the behaviour of which is outside the scope of the present document\nmight not\tindicates a likelihood that something will not happen as a result of action taken by some agency the behaviour of which is outside the scope of the present document\nIn addition:\nis\t(or any other verb in the indicative mood) indicates a statement of fact\nis not\t(or any other negative verb in the indicative mood) indicates a statement of fact\nNOTE 5:\tThe constructions \"is\" and \"is not\" do not indicate requirements.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "1\tScope",
            "description": "The present document specifies the protocols for vehicle-to-everything (V2X) services network as specified in 3GPP TS 23.287 [3] for:\na)\tV2X communication among the UEs over the PC5 interface; and\nb)\tV2X communication between the UE and the V2X application server over the Uu interface.\nThis specification also covers interworking with EPS for V2X services in 5GS.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "2\tReferences",
            "description": "The following documents contain provisions which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non-specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[2]\t3GPP TS 23.122: \"Non-Access-Stratum (NAS) functions related to Mobile Station (MS) in idle mode\".\n[3]\t3GPP TS 23.287: \"Architecture enhancements for 5G System (5GS) to support Vehicle-to-Everything (V2X) services\".\n[4]\t3GPP TS 23.502: \"Procedures for the 5G System (5GS); Stage 2\".\n[5]\t3GPP TS 24.386 \"User Equipment (UE) to V2X control function; protocol aspects; Stage 3\".\n[6]\t3GPP TS 24.501: \"Access-Stratum (NAS) protocol for 5G System (5GS); Stage 3\".\n[7]\t3GPP TS 24.588: \"Vehicle-to-Everything (V2X) services in 5G System (5GS); User Equipment (UE) policies; Stage 3\".\n[8]\t3GPP TS 38.300: \"NR; NR and NG-RAN Overall Description; Stage 2\".\n[9]\t3GPP TS 38.304: \"User Equipment (UE) procedures in Idle mode and RRC Inactive state\".\n[10]\t3GPP TS 38.323: \"NR; Packet Data Convergence Protocol (PDCP) specification\".\n[11]\t3GPP TS 38.331: \"NR; Radio Resource Control (RRC) protocol specification\".\n[12]\tETSI EN 302 636-3 v1.2.1: \"Intelligent Transport Systems (ITS); Vehicular Communications; GeoNetworking; Part 3: Network Architecture\".\n[13]\tIEEE 1609.3 2016: \"IEEE Standard for Wireless Access in Vehicular Environments (WAVE) -- Networking Services\".\n[14]\tIETF RFC 768: \"User Datagram Protocol\".\n[15]\tIETF RFC 4291: \"IP Version 6 Addressing Architecture\".\n[16]\tIETF RFC 4862: \"Neighbor Discovery for IP version 6 (IPv6)\".\n[17]\tISO 29281-1:2018: \"Intelligent transport systems -- Communication access for land mobiles (CALM) -- Non-IP networking -- Part 1: Fast networking & transport layer protocol (FNTP)\".\n[18]\tISO TS 17419 ITS-AID AssignedNumbers:\n[19]\tIETF RFC 1035: \"DOMAIN NAMES - IMPLEMENTATION AND SPECIFICATION\".\n[20]\t3GPP TS 33.536: \"Security aspects of 3GPP support for advanced Vehicle-to-Everything (V2X) services\".\n[21]\t3GPP TS 33.501: \"Security architecture and procedures for 5G system\".\n[22]\t3GPP TS 24.526: \"User Equipment (UE) policies for 5G System (5GS); Stage 3\".\n[23]\tISO/IEC 10118-3:2018: \"IT Security techniques – Hash-functions – Part 3: Dedicated hash-functions\".\n[24]\tCCSA YD/T 3707-2020: \"Technical requirements of network layer of LTE-based vehicular communication\".\n[25]\tIETF RFC 793: \"Transmission Control Protocol.\"\n[26]\t3GPP TS 24.007: \"Mobile radio interface signalling layer 3; General aspects\".\n[27]\t3GPP TS 24.554: \"Proximity-services (ProSe) in 5G System (5GS) protocol aspects; Stage 3\".\n[28]\t3GPP TS 24.577: \"Aircraft-to-Everything (A2X) services in 5G System (5GS) protocol aspects; Stage 3\".\n[29]\t3GPP TS 24.514: \"Ranging based services and sidelink positioning in 5G system(5GS); Stage 3\".\n[30]\t3GPP TS 38.355:\t\"NR; Sidelink Positioning Protocol (SLPP); Protocol specification\".\n[31]\tIETF RFC 4566: \"SDP: Session Description Protocol\".\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "3\tDefinitions of terms and abbreviations",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "3.1\tTerms",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the terms given in 3GPP TR 21.905 [1] and the following apply. A term defined in the present document takes precedence over the definition of the same term, if any, in 3GPP TR 21.905 [1].\nE-UTRA-PC5: PC5 reference point over E-UTRA. The term E-UTRA-PC5 used in the present document corresponds to the term LTE PC5 defined in 3GPP TS 23.287 [3].\nNR-PC5: PC5 reference point over NR. The term NR-PC5 used in the present document corresponds to the term NR PC5 defined in 3GPP TS 23.287 [3].\nPC5 QoS flow context: A context which includes a set of V2X service identifiers, a PQFI value and a set of PC5 QoS parameters.\nPC5 QoS rule: A rule which includes a PC5 QoS rule identifier, a PQFI value, a precedence value and optionally a set of packet filters. The PC5 QoS rule is associated with a PC5 QoS flow context.\nV2X service identifier: an identifier of a V2X service, e.g. PSID, ITS-AID, or AID of the V2X application. The term V2X service identifier used in the present document corresponds to the term V2X service type defined in 3GPP TS 23.287 [3].\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 23.287 [3] apply:\nApplication Identifier (AID)\nIntelligent Transport Systems (ITS)\nITS Application Identifier (ITS-AID)\nNR Tx Profile\nProvider Service Identifier (PSID)\nV2X communication\nV2X message\nV2X service\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 24.501 [6] apply:\n5G-EA\n5G-IA\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 24.501 [6] apply:\nUE local configuration\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 38.331 [11] apply:\nMBS Radio Bearer\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.2\tAbbreviations",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the abbreviations given in 3GPP TR 21.905 [1] , 3GPP TS 24.501 [6] and the following apply. An abbreviation defined in the present document takes precedence over the definition of the same abbreviation, if any, in 3GPP TR 21.905 [1] and 3GPP TS 24.501 [6].\nA2X\tAircraft-to-Everything\nE-UTRA\tEvolved Universal Terrestrial Radio Access\nFQDN\tFully Qualified Domain Name\nLSB\tLeast Significant 8 Bits\nMBS\tMulticast/Broadcast Services\nMSB\tMost Significant 8 Bits\nNR\tNew Radio\nNRPEK\tNR PC5 Encryption Key\nNRPIK\tNR PC5 Integrity Key\nV2X\tVehicle-to-Everything\nV2XP\tV2X Policy\nPQFI\tPC5 QoS Flow ID\nPQI\tPC5 5QI\nProSeP\t5G ProSe Policy\nRSLPP\tRanging and Sidelink Positioning Policy\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "4\tGeneral description",
            "description": "The present specification defines means for transport of V2X messages in 5GS and interworking to EPS. V2X messages are generated and consumed by upper layers of the UE and the V2X application server. V2X messages can contain IP data or non-IP data.\nThe V2X messages can be transported using:\na)\tV2X communication over PC5; and\nb)\tV2X communication over Uu.\nFor case a above:\n1)\tV2X communication over PC5 enables transfer of V2X messages among UEs;\n2)\tboth IP based and non-IP based V2X messages are supported over PC5; and\n3)\tfor V2X messages containing IP data, only IPv6 is used. IPv4 is not supported in this release of the specification.\nFor case b above:\n1)\tV2X communication over Uu enables transfer of V2X messages between a UE and a V2X application server. A UE using V2X communication over Uu:\ni)\tcan use unicast transport (in uplink, downlink or both of them);\nii)\tcan use MBS transport (in downlink only);\niii)\tcan use transport for uplink which is the same or different to the transport for downlink; and\niv)\tcan use also MBS transport for downlink without using any transport for uplink;\n2)\tboth IP based and non-IP based V2X messages are supported over Uu;\n3)\tV2X messages are carried over Uu in payload of either a UDP/IP packet or TCP/IP packet towards a V2X application server address;\nNOTE:\tFurther details about the use of UDP or TCP as a transport layer protocol are described in 3GPP TS 23.287 [3] clause 5.2.3.1.\n4)\tV2X messages carried over Uu are sent or received over unicast and MBS transport in this release of the specification; and\n5)\tV2X messages are carried over Uu using user data via user plane.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "5\tProvisioning of parameters for V2X configuration",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "5.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "V2X communication is configured by the use of V2X configuration parameters and their related procedures which allow configuration of necessary V2X configuration parameters.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5.2\tConfiguration and precedence of V2X configuration parameters",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.2.1\tGeneral",
                            "text_content": "UE's usage of V2X communication is controlled by V2X communication parameters.\nThe V2X communication parameters consist of the configuration parameters for V2X communication over PC5 and the configuration parameters for V2X communication over Uu.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.2.2\tPrecedence of V2X configuration parameters",
                            "text_content": "The V2X configuration parameters can be:\na)\tpre-configured in the ME;\nb)\tconfigured in the USIM;\nc)\tprovided as a V2XP using the UE policy delivery service as specified in 3GPP TS 24.501 [6] annex D;\nd)\tprovided by a V2X application server via V1 reference point; or\ne)\ta combination of case a), b), c) or d) above.\nThe UE shall use the V2X configuration parameters in the following order of decreasing precedence:\na)\tthe V2X configuration parameters provided as a V2XP using the UE policy delivery service as specified in annex D of 3GPP TS 24.501 [6];\nb)\tthe V2X configuration parameters provided by a V2X application server via V1 reference point;\nc)\tthe V2X configuration parameters configured in the USIM; and\nd)\tthe V2X configuration parameters pre-configured in the ME.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.2.3\tConfiguration parameters for V2X communication over PC5",
                            "text_content": "The configuration parameters for V2X communication over PC5 consist of:\na)\ta validity timer for the validity of the configuration parameters for V2X communication over PC5;\nb)\ta list of PLMNs and RATs in which the UE is authorized to use V2X communication over PC5 when the UE is served by E-UTRA or served by NR. Each entry of the list contains a PLMN ID and RATs in which the UE is authorized to use V2X communication over PC5;\nc)\tan indication of whether the UE is authorized to use V2X communication over PC5 when the UE is not served by E-UTRA and not served by NR;\nd)\tlist of RATs in which the UE is authorized to use V2X communication over PC5 and the radio parameters of the RAT for V2X communication over PC5 applicable per geographical area with an indication of whether these radio parameters of the RAT are \"operator managed\" or \"non-operator managed\" when the UE is not served by E-UTRA and not served by NR;\ne)\tvoid\nf)\toptionally, a list of V2X service identifier to PC5 RAT(s) and Tx profiles mapping rules. Each mapping rule contains one or more V2X service identifiers, PC5 RAT(s) and:\n1)\tif the PC5 RAT(s) include E-UTRA-PC5, Tx profiles corresponding to the E-UTRA-PC5;\n2)\tif the PC5 RAT(s) include NR-PC5, optionally NR Tx profile corresponding to the NR-PC5 for broadcast mode V2X communication over PC5 and groupcast mode V2X communication over PC5; or\n3)\tif the PC5 RAT(s) include NR-PC5, optionally NR Tx profile corresponding to transmitting and receiving initial signalling of the PC5 unicast link establishment;\nNOTE 1:\tThe value of a V2X service identifier that has an associated NR Tx profile is different than the value of any V2X service identifier that was used without having associated NR Tx profiles in previous releases.\ng)\tconfiguration parameters for privacy support, consisting of:\n1)\ta list of V2X services requiring privacy. Each entry of the list contains one or more V2X service identifiers and one or more geographical areas where the privacy is required; and\n2)\ta privacy timer value as specified in 3GPP TS 24.588 [7] clause 5.3;\nh)\tconfiguration parameters for a V2X communication over PC5 in E-UTRA-PC5, consisting of:\n1)\ta list of V2X service identifier to destination layer-2 ID mapping rules. Each mapping rule contains one or more V2X service identifiers and the destination layer-2 ID;\n2)\toptionally, a default destination layer-2 ID;\n3)\ta list of PPPP to PDB mapping rules. Each mapping rule contains a ProSe Per-Packet Priority (PPPP) and a Packet Delay Budget (PDB);\n4)\toptionally, list of V2X service identifier to V2X E-UTRA frequency mapping rules. Each mapping rule contains one or more V2X service identifiers and the V2X E-UTRA frequencies with associated geographical areas; and\n5)\toptionally, a list of the V2X services authorized for ProSe Per-Packet Reliability (PPPR). Each entry of the list contains one or more V2X service identifiers and a ProSe Per-Packet Reliability (PPPR) value; and\ni)\tconfiguration parameters for a V2X communication over PC5 in NR-PC5, consisting of:\n1)\toptionally, a list of V2X service identifier to V2X NR frequency mapping rules. Each mapping rule contains one or more V2X service identifiers and the V2X NR frequencies with associated geographical areas;\n2)\ta list of V2X service identifier to destination layer-2 ID for broadcast mapping rules. Each mapping rule contains one or more V2X service identifiers and the destination layer-2 ID for broadcast;\n3)\toptionally, a default destination layer-2 ID for broadcast;\n4)\ta list of V2X service identifier to destination layer-2 ID for groupcast mapping rules. Each mapping rule contains one or more V2X service identifiers and the destination layer-2 ID for groupcast;\n5)\ta list of V2X service identifier to default destination layer-2 ID for unicast initial signalling mapping rules. Each mapping rule contains one or more V2X service identifiers and the default destination layer-2 ID for initial signalling to establish unicast connection;\n6)\ta list of V2X service identifier to PC5 QoS parameters mapping rules. The PC5 QoS parameters are specified in clause 5.4.2 of 3GPP TS 23.287 [3];\n7)\tan AS configuration, including a list of SLRB mapping rules applicable when the UE is not served by E-UTRA and is not served by NR. Each SLRB mapping rule contains a PC5 QoS profile and an SLRB. The PC5 QoS profile contains the following parameters:\ni)\tthe PC5 QoS profile contains a PQI;\nii)\tif the PQI of the PC5 QoS profile identifies a GBR QoS, the PC5 QoS profile contains a PC5 flow bit rates consisting of a guaranteed flow bit rate (GFBR) and a maximum flow bit rate (MFBR);\niii)\tif the PQI of the PC5 QoS profile identifies a non-GBR QoS, the PC5 QoS profile contains the PC5 link aggregated bit rate consisting of a per link aggregate maximum bit rate (PC5 LINK-AMBR);\nNOTE 2:\tPC5 link aggregated bit rate is only used for unicast mode communications over PC5.\niv)\tthe PC5 QoS profile contains a range, which is only used for groupcast mode communications over PC5; and\nv)\tthe PC5 QoS profile can contain the priority level, the averaging window, and the maximum data burst volume. If one or more of the priority level, the averaging window or the maximum data burst volume are not contained in the PC5 QoS profile, their default values apply;\n8)\ta list of NR-PC5 unicast security policies. Each entry in the list contains an NR-PC5 unicast security policy composed of:\ni)\tone or more V2X service identifiers;\nii)\tthe signalling integrity protection policy for the V2X service identifier(s);\niii)\tthe signalling ciphering policy for the V2X service identifier(s);\niv)\tthe user plane integrity protection policy for the V2X service identifier(s);\nv)\tthe user plane ciphering policy for the V2X service identifier(s); and\nvi)\tone or more geographical areas where the NR-PC5 unicast security policy applies;\n9)\ta list of V2X service identifier to default mode of communication mapping rules. Each mapping rule contains one or more V2X service identifiers and the default mode of communication (one of unicast, groupcast or broadcast); and\n10)\tfor broadcast mode, groupcast mode and initial signalling of the PC5 unicast link establishment, PC5 DRX configurations (see 3GPP TS 38.331 [11]), including the mapping of PC5 QoS profile(s) to PC5 DRX cycle(s) and the default PC5 DRX configuration, when the UE is not served by E-UTRA and not served by NR.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.2.4\tConfiguration parameters for V2X communication over Uu",
                            "text_content": "The configuration parameters for V2X communication over Uu consist of:\na)\ta validity timer for the validity of the configuration parameters for V2X communication over Uu to 5GCN;\nb)\toptionally, a list of V2X service identifier to PDU session parameters mapping rules. Each mapping rule contains one or more V2X service identifiers of a the V2X service and one or more parameters for establishment of a PDU session for V2X communication over Uu for the V2X services:\n1)\tone of the \"IPv4\", \"IPv6\", \"IPv4v6\" or \"Unstructured\" PDU session types;\n2)\tan SSC mode;\n3)\ta list of zero or more S-NSSAIs;\n4)\ta list of zero or more DNNs; and\n5)\tone of the UDP or TCP transport layer protocol if the PDU session type is \"IPv4\", \"IPv6\" or \"IPv4v6\"; and\nc)\ta list of PLMNs in which the UE is configured to use V2X communication over Uu. For each PLMN, the list contains:\n1)\tfor transfer of a V2X message of a V2X service identified by a V2X service identifier:\ni)\ta list of V2X service identifier to V2X application server address mapping rules, applicable when the UE is registered to the PLMN. Each mapping rule contains:\nA)\tone or more V2X service identifiers;\nB)\ta V2X application server address for unicast consisting of:\n-\tan FQDN, or an IP address; and\n-\ta UDP port for uplink transport, a UDP port for downlink transport, a TCP port for bidirectional transport or any combination of them; and\nC)\toptionally a geographical area; and\nD)\toptionally, one or more V2X MBS configuration(s) for receiving V2X communication over Uu via MBS per V2X service identier consisting of:\n-\ta TMGI;\n-\ta list of service area identifiers (SAIs);\n-\ta frequency; and\n-\tan SDP body;\nEditor’s note (WI: TEI18_MBS4V2X, CR: 0276):\tThe details of the SDP body encoding are FFS.\nii)\toptionally, per type of data (IP and non-IP) and V2X message family (in case of non-IP) and optionally a geographical area, one or more default V2X application server addresses for the unicast V2X communication over Uu applicable when the UE is registered to the PLMN. Each V2X application server address consists of:\ni)\tan FQDN, or an IP address; and\nii)\ta UDP port for uplink transport, a UDP port for downlink transport, a TCP port for bidirectional transport or any combination of them; and\n2)\tfor transfer of a V2X message of a V2X service not identified by a V2X service identifier:\ni)\ta list of the V2X application servers per optional geographical area where usage of those V2X application servers applies, applicable when the UE is registered to the PLMN. Each entry of the list contains:\nA)\ta V2X application server address consisting of an FQDN, or an IP address; and\nB)\toptionally, a geographical area.\nii)\toptionally, one or more V2X MBS configuration(s) for receiving V2X communication over Uu via MBS consisting of:\nA)\ta TMGI;\nB)\ta list of service area identifiers (SAIs);\nC)\ta frequency; and\nD)\tan SDP body;\nEditor’s note (WI: TEI18_MBS4V2X, CR: 0276):\tThe details of the SDP body encoding are FFS.\n3)\toptionally, a V2X MBS configuration for receiving V2X application server information via MBS consisting of:\ni)\ta TMGI;\nii)\ta list of service area identifiers (SAIs);\niii)\ta frequency; and\niv)\tan SDP body;\nEditor’s note (WI: TEI18_MBS4V2X, CR: 0276):\tThe details of the SDP body encoding are FFS.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.3\tProcedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.3.1\tGeneral",
                            "text_content": "The procedure for provisioning of parameters for V2X configuration allows the UE to obtain information necessary for V2X communication.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.2\tUE-requested V2X policy provisioning procedure",
                            "text_content": "The UE-requested V2X policy provisioning procedure enables the UE to request V2X policy from the PCF in the following cases:\na)\tif the T5041 for a UE policy for V2X communication over PC5 expires;\nb)\tif the T5042 for a UE policy for V2X communication over Uu expires; or\nc)\tif there are no valid configuration parameters, e.g., for the current area, or due to abnormal situation.\nThe UE shall follow the principles of PTI handling for UE policy delivery service procedures defined in 3GPP TS 24.501 [6] clause D.1.2.\nIn order to initiate the UE-requested V2X policy provisioning procedure, the UE shall create a UE POLICY PROVISIONING REQUEST message (see example in figure 5.3.2.2.1). The UE:\na)\tshall allocate a PTI value currently not used and set the PTI IE to the allocated PTI value;\nb)\tshall include the Requested UE policies IE indicating whether the UE policies for V2X communication over PC5, the UE policies for V2X communication over Uu or both are requested;\nc)\tshall transport the UE POLICY PROVISIONING REQUEST message using the NAS transport procedure as specified in 3GPP TS 24.501 [6] clause 5.4.5; and\nd)\tshall start timer T5040.\nFigure 5.3.2.2.1 illustrates the UE-requested V2X policy provisioning procedure, which involves the interaction between the vehicle, roadside units (RSUs), and the central unit (CU). The figure depicts the process of policy request, approval, and assignment, highlighting the role of the CU in managing and distributing policies to ensure efficient communication and coordination among vehicles in a V2X network. The figure emphasizes the importance of real-time policy management for seamless V2X communication and the potential for enhancing road safety and traffic management.\nFigure 5.3.2.2.1: UE-requested V2X policy provisioning procedure\nUpon receipt of and accepting the UE POLICY PROVISIONING REQUEST message, the PCF shall create a MANAGE UE POLICY COMMAND message and shall behave as described in clause D.2.1 of 3GPP TS 24.501 [6].\nUpon receipt of the MANAGE UE POLICY COMMAND message with the same PTI as included in the UE POLICY PROVISIONING REQUEST message, the UE shall stop timer T5040 and handles the MANAGE UE POLICY COMMAND message as specified in clause D.2.1 of 3GPP TS 24.501 [6].\nIf new UE policies for V2X communication over PC5 are included in the MANAGE UE POLICY COMMAND message, the UE shall stop timer T5041 if it is running and start timer T5041 with the value included in the UE policies for V2X communication over PC5, and start using the new UE policies for V2X communication over PC5 included in the MANAGE UE POLICY COMMAND message.\nIf new UE policies for V2X communication over Uu are included in the MANAGE UE POLICY COMMAND message, the UE shall stop timer T5042 if it is running and start timer T5042 with the value included in the UE policies for V2X communication over Uu, and start using the new UE policies for V2X communication over Uu included in the MANAGE UE POLICY COMMAND message.\nUpon receipt and rejecting of the UE POLICY PROVISIONING REQUEST message, the PCF shall create a UE POLICY PROVISIONING REJECT message.\nThe PCF shall set the UPDS cause IE of the UE POLICY PROVISIONING REJECT message to indicate reason for rejecting the UE-requested V2X policy provisioning procedure.\nThe UPDS cause IE typically indicates one of the following UPDS cause values:\n#31\trequest rejected, unspecified;\n#32\tservice option not supported;\n#34\tservice option temporarily out of order;\n#35\tPTI already in use; or\n#95 – 111\tprotocol errors.\nThe PCF shall transport the UE POLICY PROVISIONING REJECT message to the UE via the AMF using the procedure specified in 3GPP TS 23.502 [4].\nUpon receipt of the UE POLICY PROVISIONING REJECT message, the UE shall stop timer T5040.\nThe following abnormal cases can be identified:\na)\tIndication from the lower layer of transmission failure of the UE POLICY PROVISIONING REJECT message.\nAfter receiving an indication from lower layer that the UE POLICY PROVISIONING REJECT message has not been successfully acknowledged (e.g. TCP ACK is not received), the PCF shall abort the procedure.\nThe following abnormal cases can be identified:\na)\tT5040 expired.\nThe UE shall, on the first expiry of the timer T5040, retransmit the UE POLICY PROVISIONING REQUEST message and shall reset and start timer T5040. This retransmission is repeated four times, i.e. on the fifth expiry of timer T5040, the UE shall abort the procedure and release the allocated PTI.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "6\tV2X communication",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "6.1\tV2X communication over PC5",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.1.1\tGeneral",
                            "text_content": "This clause describes the procedures at the UE, and between UEs, for V2X communication over PC5.\nThe UE shall support requirements for securing V2X communication over PC5.\nBoth IP based and non-IP based V2X communication over PC5 are supported. For IP based V2X communication, only IPv6 is used. IPv4 is not supported in this release of the present document.\nV2X communication over NR-PC5 supports broadcast mode, groupcast mode, and unicast mode. If upper layer of the UE indicates the mode of communication, the UE shall set the mode of communication based on the request of the upper layer. Otherwise, the UE shall set the mode of communication based on the mapping rules between the V2X service identifier and the default mode of communication defined in clause 5.2.3.\nNOTE:\tFurther details about whether broadcast, unicast or groupcast can be used over PC5 are described in 3GPP TS 23.287 [3] clause 5.2.1.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.1.2\tUnicast mode communication over NR based PC5",
                            "text_content": "This clause describes the PC5 signalling protocol procedures between two UEs for unicast mode of V2X communication. The following PC5 signalling protocol procedures are defined:\na)\tPC5 unicast link establishment;\nb)\tPC5 unicast link modification;\nc)\tPC5 unicast link release;\nd)\tPC5 unicast link identifier update;\ne)\tPC5 unicast link authentication;\nf)\tPC5 unicast link security mode control;\ng)\tPC5 unicast link keep-alive; and\nh)\tPC5 unicast link re-keying procedure.\nDepending on the type of the PC5 unicast link establishment procedure (i.e. UE oriented Layer-2 link establishment or V2X Service oriented Layer-2 link establishment in 3GPP TS 23.287[3]), the PC5 unicast link establishment procedure is used to establish a PC5 unicast link between two UEs or to establish multiple PC5 unicast links. The UE sending the request message is called the \"initiating UE\" and the other UE is called the \"target UE\". If the request message does not indicate the specific target UE (i.e. target user info is not included in the request message), and multiple target UEs are interested in the V2X service(s) indicated in the request message, then the initiating UE shall handle corresponding response messages received from those target UEs. The maximum number of NR PC5 unicast links established in a UE at a time shall not exceed an implementation-specific maximum number of established NR PC5 unicast links.\nNOTE:\tThe recommended maximum number of established NR PC5 unicasts link is 8.\nEditor’s note (WI: Ranging_SL, CR: 0282):\tThe RSPP metadata information used for PC5 unicast link establishment procedure for V2X capable UE to support ranging and sidelink positioning service is FFS and to be aligned with RAN.\nThe initiating UE shall meet the following pre-conditions before initiating this procedure:\na)\ta request from upper layers to transmit the packet for V2X service over PC5;\nb)\tthe communication mode is unicast mode (e.g. pre-configured as specified in clause 5.2.3 or indicated by upper layers);\nc)\tthe link layer identifier for the initiating UE (i.e. layer-2 ID used for unicast communication) is available (e.g. pre-configured or self-assigned) and is not being used by other existing PC5 unicast links to the same link layer identifier for the destination UE within the initiating UE;\nd)\tthe link layer identifier for the destination UE (i.e. the unicast layer-2 ID of the target UE or the broadcast layer-2 ID) is available to the initiating UE (e.g. pre-configured, obtained as specified in clause 5.2.3 or known via prior V2X communication);\nNOTE 1:\tIn the case where different V2X services are mapped to distinct default destination layer-2 IDs, when the initiating UE intends to establish a single unicast link that can be used for more than one V2X service identifiers, the UE can select any of the default destination layer-2 ID for unicast initial signalling.\ne)\tthe initiating UE is either authorised for V2X communication over PC5 in NR-PC5 in the serving PLMN, or has a valid authorization for V2X communication over PC5 in NR-PC5 when not served by E-UTRA and not served by NR. The UE considers that it is not served by E-UTRA and not served by NR if the following conditions are met:\n1)\tnot served by NR and not served by E-UTRA for V2X communication over PC5;\n2)\tin limited service state as specified in 3GPP TS 23.122 [2], if the reason for the UE being in limited service state is one of the following;\ni)\tthe UE is unable to find a suitable cell in the selected PLMN as specified in 3GPP TS 38.304 [9];\nii)\tthe UE received a REGISTRATION REJECT message or a SERVICE REJECT message with the 5GMM cause #11 \"PLMN not allowed\" as specified in 3GPP TS 24.501 [6]; or\niii)\tthe UE received a REGISTRATION REJECT message or a SERVICE REJECT message with the 5GMM cause #7 \"5GS services not allowed\" as specified in 3GPP TS 24.501 [6]; or\n3)\tin limited service state as specified in 3GPP TS 23.122 [2] for reasons other than i), ii) or iii) above, and located in a geographical area for which the UE is provisioned with \"non-operator managed\" radio parameters as specified in clause 5.2.3;\nf)\tthere is no existing PC5 unicast link for the pair of peer application layer IDs, or there is an existing PC5 unicast link for the pair of peer application layer IDs and:\n1)\tthe network layer protocol of the existing PC5 unicast link is not identical to the network layer protocol required by the upper layer in the initiating UE for this V2X service; or\n2)\tthe security policy (either signalling security policy or user plane security policy) corresponding to the V2X service identifier is not compatible with the security policy of the existing PC5 unicast link; and\ng)\tthe number of established PC5 unicast links is less than the implementation-specific maximum number of established NR PC5 unicast links allowed in the UE at a time.\nAfter receiving the service data or request from the upper layers, the initiating UE shall derive the PC5 QoS parameters and assign the PQFI(s) for the PC5 QoS flows(s) to be established as specified in clause 6.1.2.12.\nIn order to initiate the PC5 unicast link establishment procedure, the initiating UE shall create a DIRECT LINK ESTABLISHMENT REQUEST message. The initiating UE:\na)\tshall include the source user info set to the initiating UE's application layer ID received from upper layers;\nb)\tshall include the V2X service identifier(s) received from upper layer;\nc)\tshall include the target user info set to the target UE's application layer ID if received from upper layers or if the destination layer-2 ID is the unicast layer-2 ID of target UE;\nd)\tshall include the Key establishment information container if the UE PC5 unicast signalling integrity protection policy is set to \"signalling integrity protection required\" or \"signalling integrity protection preferred\", and may include the Key establishment information container if the UE PC5 unicast signalling integrity protection policy is set to \"signalling integrity protection not needed\";\nNOTE 2:\tThe Key establishment information container is provided by upper layers.\ne)\tshall include a Nonce_1 set to the 128-bit nonce value generated by the initiating UE for the purpose of session key establishment over this PC5 unicast link if the UE PC5 unicast signalling integrity protection policy is set to \"signalling integrity protection required\" or \"signalling integrity protection preferred\";\nf)\tshall include its UE security capabilities indicating the list of algorithms that the initiating UE supports for the security establishment of this PC5 unicast link;\ng)\tshall include the MSB of KNRP-sess ID chosen by the initiating UE as specified in 3GPP TS 33.536 [20] if the UE PC5 unicast signalling integrity protection policy is set to \"signalling integrity protection required\" or \"signalling integrity protection preferred\";\nh)\tmay include a KNRP ID if the initiating UE has an existing KNRP for the target UE;\ni)\tshall include its UE PC5 unicast signalling security policy. In the case where the different V2X services are mapped to the different PC5 unicast signalling security policies, when the initiating UE intends to establish a single unicast link that can be used for more than one V2X service, each of the signalling security polices of those V2X services shall be compatible, e.g. \"signalling integrity protection not needed\" and \"signalling integrity protection required\" are not compatible; and\nj)\tshall include the RSPP metadata to provide the RSPP metadata information e.g., the specific role(s) to be discovered if the V2X service identifier is indicating \"ranging and sidelink positioning\".\nAfter the DIRECT LINK ESTABLISHMENT REQUEST message is generated, the initiating UE shall pass this message to the lower layers for transmission along with:\na)\tthe initiating UE’s layer-2 ID for unicast communication and the destination layer-2 ID used for unicast initial signalling;\nb)\tthe NR Tx profile corresponding to the initial signalling of the PC5 unicast link establishment and that is associated with the V2X service identifier (see clause 5.2.3), if available;\nNOTE 3:\tThe NR Tx profile is used by lower layers to determine the PC5 DRX parameter values (see 3GPP TS 38.300 [8]) for transmitting and receiving initial signalling of the PC5 unicast link establishment.\nand start timer T5000. The UE shall not send a new DIRECT LINK ESTABLISHMENT REQUEST message to the same target UE identified by the same application layer ID while timer T5000 is running. If the target user info IE is not included in the DIRECT LINK ESTABLISHMENT REQUEST message (i.e. V2X service oriented PC5 unicast link establishment procedure), the initiating UE shall handle multiple DIRECT LINK ESTABLISHMENT ACCEPT messages, if any, received from different target UEs for the establishment of multiple PC5 unicast links before the expiry of timer T5000.\nNOTE 4:\tIn order to ensure successful PC5 unicast link establishment, T5000 should be set to a value larger than the sum of T5006 and T5007.\nFigure 6.1.2.2.2 illustrates the process of establishing a PC5 unicast link between a user equipment (UE) and a picocell (PC5) in a telecommunication network. The figure depicts the various stages of link establishment, including the initial connection request, the establishment of the physical link, and the synchronization of the radio resource control protocol. Key components shown include the UE, PC5 base station, and the radio access network. The figure highlights the importance of efficient link establishment for seamless communication and the role of network protocols in ensuring reliable data transmission.\nFigure 6.1.2.2.2: UE oriented PC5 unicast link establishment procedure\n\nFigure 6.1.2.2.3: V2X service oriented PC5 unicast link establishment procedure\nThe target UE shall pass the NR Tx profile corresponding to the initial signalling of the PC5 unicast link establishment and that is associated with the V2X service identifier the target UE is interested in (see clause 5.2.3), if available, to the lower layers.\nNOTE 1:\tThe NR Tx profile is used by lower layers to determine the PC5 DRX parameter values (see 3GPP TS 38.300 [8]) for transmitting and receiving initial signalling of the PC5 unicast link establishment.\nUpon receipt of a DIRECT LINK ESTABLISHMENT REQUEST message, if the target UE accepts this request, the target UE shall uniquely assign a PC5 link identifier, create a PC5 unicast link context and assign a layer-2 ID for this PC5 unicast link. The newly assigned layer-2 ID replaces the target layer-2 ID as received on the DIRECT LINK ESTABLISHMENT REQUEST message. Then the target UE shall store this assigned layer-2 ID and the source layer-2 ID used in the transport of this message provided by the lower layers in the PC5 unicast link context. The target UE may initiate PC5 unicast link authentication procedure as specified in clause 6.1.2.6 and shall initiate PC5 unicast link security mode control procedure as specified in clause 6.1.2.7.\nNOTE 2:\tThe target UE may reuse the target UE's layer-2 ID used in the transport of the DIRECT LINK ESTABLISHMENT REQUEST message provided by the lower layers in case that the target UE's layer-2 ID has been used in previous PC5 unicast link with the same peer.\nIf:\na)\tthe target user info IE is included in the DIRECT LINK ESTABLISHMENT REQUEST message and this IE includes the target UE's application layer ID; and\nthe target UE matches the indicated UE role included in the RSPP metadata if the V2X service identifier is indicating \"ranging and sidelink positioning\"; or\nb)\tthe target user info IE is not included in the DIRECT LINK ESTABLISHMENT REQUEST message and the target UE is interested in the V2X service(s) identified by the V2X service identifier IE in the DIRECT LINK ESTABLISHMENT REQUEST message; and\nthe target UE matches the indicated UE role included in the RSPP metadata if the V2X service identifier is indicating \"ranging and sidelink positioning\";\nthen the target UE shall either:\na)\tidentify an existing KNRP based on the KNRP ID included in the DIRECT LINK ESTABLISHMENT REQUEST message; or\nb)\tif KNRP ID is not included in the DIRECT LINK ESTABLISHMENT REQUEST message, the target UE does not have an existing KNRP for the KNRP ID included in DIRECT LINK ESTABLISHMENT REQUEST message or the target UE wishes to derive a new KNRP, derive a new KNRP. This may require performing one or more PC5 unicast link authentication procedures as specified in clause 6.1.2.6.\nNOTE 3:\tHow many times the PC5 unicast link authentication procedure needs to be performed to derive a new KNRP depends on the authentication method used.\nAfter an existing KNRP was identified or a new KNRP was derived, the target UE shall initiate a PC5 unicast link security mode control procedure as specified in clause 6.1.2.7.\nUpon successful completion of the PC5 unicast link security mode control procedure, in order to determine whether the DIRECT LINK ESTABLISHMENT REQUEST message can be accepted or not, in case of IP communication, the target UE checks whether there is at least one common IP address configuration option supported by both the initiating UE and the target UE.\nIf the target UE accepts the PC5 unicast link establishment procedure, the target UE shall create a DIRECT LINK ESTABLISHMENT ACCEPT message. The target UE:\na)\tshall include the source user info set to the target UE's application layer ID received from upper layers;\nb)\tshall include PQFI(s), the corresponding PC5 QoS parameters and the V2X service identifier(s) that the target UE accepts;\nc)\tshall include an IP address configuration IE set to one of the following values if IP communication is used:\n1)\t\"IPv6 router\" if IPv6 address allocation mechanism is supported by the target UE, i.e. acting as an IPv6 router; or\n2)\t\"IPv6 address allocation not supported\" if IPv6 address allocation mechanism is not supported by the target UE;\nd)\tshall include a link local IPv6 address IE formed locally based on IETF RFC 4862 [16] if IP address configuration IE is set to \"IPv6 address allocation not supported\" and the received DIRECT LINK SECURITY MODE COMPLETE message included a link local IPv6 address IE;\ne)\tshall include the configuration of UE PC5 unicast user plane security protection based on the agreed user plane security policy, as specified in 3GPP TS 33.536 [20]; and\nf)\tshall include the RSPP metadata IE to provide the RSPP metadata information e.g., the specific role(s) of the target UE if the V2X service identifier received in the DIRECT LINK ESTABLISHMENT REQUEST message is indicating \"ranging and sidelink positioning\".\nAfter the DIRECT LINK ESTABLISHMENT ACCEPT message is generated, the target UE shall pass this message to the lower layers for transmission along with the initiating UE's layer-2 ID for unicast communication and the target UE's layer-2 ID for unicast communication, and shall start timer T5011 if at least one of V2X service identifiers for the PC5 unicast links satisfies the privacy requirements as specified in clause 5.2.3.\nAfter sending the DIRECT LINK ESTABLISHMENT ACCEPT message, the target UE shall provide the following information along with the layer-2 IDs to the lower layer, which enables the lower layer to handle the coming PC5 signalling or traffic data:\na)\tthe PC5 link identifier self-assigned for this PC5 unicast link;\nb)\tPQFI(s) and its corresponding PC5 QoS parameters; and\nc)\tan indication of activation of the PC5 unicast user plane security protection for the PC5 unicast link, if applicable.\nIf the target UE accepts the PC5 unicast link establishment request, then the target UE may perform the PC5 QoS flow establishment over PC5 unicast link as specified in clause 6.1.2.12.\nIf the Target user info IE is included in the DIRECT LINK ESTABLISHMENT REQUEST message, upon receipt of the DIRECT LINK ESTABLISHMENT ACCEPT message, the initiating UE shall stop timer T5000. If the Target user info IE is not included in the DIRECT LINK ESTABLISHMENT REQUEST message the initiating UE may keep the timer T5000 running and continue to handle multiple response messages (i.e. the DIRECT LINK ESTABLISHMENT ACCEPT message) from multiple target UEs.\nFor each of the DIRECT LINK ESTABLISHMENT ACCEPT message received, the initiating UE shall uniquely assign a PC5 link identifier and create a PC5 unicast link context for each of the PC5 unicast link(s). Then the initiating UE shall store the source layer-2 ID and the destination layer-2 ID used in the transport of this message provided by the lower layers in the PC5 unicast link context(s) to complete the establishment of the PC5 unicast link with the target UE(s). From this time onward the initiating UE shall use the established link(s) for V2X communication over PC5 and additional PC5 signalling messages to the target UE(s).\nAfter receiving the DIRECT LINK ESTABLISHMENT ACCEPT message, the initiating UE shall provide the following information along with the layer-2 IDs to the lower layer, which enables the lower layer to handle the coming PC5 signalling or traffic data:\na)\tthe PC5 link identifier self-assigned for this PC5 unicast link;\nb)\tPQFI(s) and its corresponding PC5 QoS parameters; and\nc)\tan indication of activation of the PC5 unicast user plane security protection for the PC5 unicast link, if applicable.\nThe initiating UE shall start timer T5011 if at least one of V2X service identifiers for the PC5 unicast links satisfies the privacy requirements as specified in clause 5.2.3.\nIn addition, the initiating UE may perform the PC5 QoS flow establishment over PC5 unicast link as specified in clause 6.1.2.12.\nUpon expiry of the timer T5000, if the DIRECT_LINK_ESTABLISHMENT REQUEST message did not include the Target User Info IE, and the initiating UE received at least one DIRECT LINK ESTABLISHMENT ACCEPT message, it is up to the UE implementation to consider the PC5 unicast link establishment procedure as complete or to restart the timer T5000.\nIf the DIRECT LINK ESTABLISHMENT REQUEST message cannot be accepted, the target UE shall send a DIRECT LINK ESTABLISHMENT REJECT message. The DIRECT LINK ESTABLISHMENT REJECT message contains a PC5 signalling protocol cause IE set to one of the following cause values:\n#1\tdirect communication to the target UE not allowed;\n#3\tconflict of layer-2 ID for unicast communication is detected;\n#5\tlack of resources for PC5 unicast link; or\n#111\tprotocol error, unspecified.\nIf the target UE is not allowed to accept the DIRECT LINK ESTABLISHMENT REQUEST message .e.g. based on operator policy, or configuration parameters for V2X communication over PC5 as specified in clause 5.2.3, or the UE role included in the RSPP metadata is not matching, the target UE shall send a DIRECT LINK ESTABLISHMENT REJECT message containing PC5 signalling protocol cause value #1 \"direct communication to the target UE not allowed\".\nFor a received DIRECT LINK ESTABLISHMENT REQUEST message from a layer-2 ID (for unicast communication), if the target UE already has an existing link established to a UE using this layer-2 ID or is currently processing a DIRECT LINK ESTABLISHMENT REQUEST message from the same layer-2 ID, and with one of following parameters different from the existing link or the link for which the link establishment is in progress:\na)\tthe source user info;\nb)\ttype of data (e.g. IP or non-IP); or\nc)\tsecurity policy,\nthe target UE shall send a DIRECT LINK ESTABLISHMENT REJECT message containing PC5 signalling protocol cause value #3 \"conflict of layer-2 ID for unicast communication is detected\".\nNOTE:\tThe type of data (e.g. IP or non-IP) is indicated by the optional IP address configuration IE included in the corresponding DIRECT LINK SECURITY MODE COMPLETE message, i.e the type of data for the requested link is IP type if this IE is included, and the type of data for the requested link is non-IP if this IE is not included.\nIf the PC5 unicast link establishment fails due to the congestion problems, the implementation-specific maximum number of established NR PC5 unicast links has been reached, or other temporary lower layer problems causing resource constraints, the target UE shall send a DIRECT LINK ESTABLISHMENT REJECT message containing PC5 signalling protocol cause value #5 \"lack of resources for PC5 unicast link\". If the PC5 unicast link establishment fails due to other reasons, the target UE shall send a DIRECT LINK ESTABLISHMENT REJECT message containing PC5 signalling protocol cause value #111 \"protocol error, unspecified\".\nAfter sending the DIRECT LINK ESTABLISHMENT REJECT message, the target UE shall provide the following information along with the initiating UE's layer-2 ID for unicast communication and the target UE's layer-2 ID for unicast communication to the lower layer:\na)\tan indication of deactivation of the PC5 unicast security protection and deletion of security context for the PC5 unicast link, if applicable.\nUpon receipt of the DIRECT LINK ESTABLISHMENT REJECT message, if the Target user info is included in the DIRECT LINK ESTABLISHMENT REQUEST message, the initiating UE shall stop timer T5000 and abort the PC5 unicast link establishment procedure. If the PC5 signalling protocol cause value in the DIRECT LINK ESTABLISHMENT REJECT message is #1 \"direct communication to the target UE not allowed\" or #5 \"lack of resources for PC5 unicast link\", then the UE shall not attempt to start the PC5 unicast link establishment procedure with the same target UE at least for a time period T.\nNOTE:\tThe length of time period T is UE implementation specific and can be different for the case when the UE receives PC5 signalling protocol cause value #1 \"direct communication to the target UE not allowed\" or when the UE receives PC5 signalling protocol cause value #5 \"lack of resources for PC5 unicast link\".\nAfter receiving the DIRECT LINK ESTABLISHMENT REJECT message, the initiating UE shall provide the following information along with the initiating UE's layer-2 ID for unicast communication and the target UE's layer-2 ID for unicast communication to the lower layer:\na)\tan indication of deactivation of the PC5 unicast security protection and deletion of security context for the PC5 unicast link, if applicable.\nIf timer T5000 expires and the Target user info IE is included in the DIRECT LINK ESTABLISHMENT REQUEST message, the initiating UE shall retransmit the DIRECT LINK ESTABLISHMENT REQUEST message and restart timer T5000. After reaching the maximum number of allowed retransmissions, the initiating UE shall abort the PC5 unicast link establishment procedure and may notify the upper layer that the target UE is unreachable.\nUpon expiry of the timer T5000, if the DIRECT_LINK_ESTABLISHMENT REQUEST message did not include the Target User Info IE and the initiating UE did not receive any DIRECT LINK ESTABLISHMENT ACCEPT message, the initiating UE may retransmit the DIRECT LINK ESTABLISHMENT REQUEST message and restart timer T5000. If the DIRECT_LINK_ESTABLISHMENT REQUEST message did not include the Target User Info IE and the initiating UE did not receive any DIRECT LINK ESTABLISHMENT ACCEPT message, then after reaching the maximum number of allowed retransmissions, the initiating UE shall abort the PC5 unicast link establishment procedure and may notify the upper layer that no target UE is available.\nNOTE:\tThe maximum number of allowed retransmissions is UE implementation specific.\nIf the need to establish a link no longer exists before the procedure is completed, the initiating UE shall abort the procedure.\nWhen the initiating UE aborts the PC5 unicast link establishment procedure, the initiating UE shall provide the following information along with the initiating UE's layer-2 ID for unicast communication and the target UE's layer-2 ID for unicast communication to the lower layer:\na)\tan indication of deactivation of the PC5 unicast security protection and deletion of security context for the PC5 unicast link, if applicable.\nFor a received DIRECT LINK ESTABLISHMENT REQUEST message from a source layer-2 ID (for unicast communication), if the target UE already has an existing link established to the UE known to use the same source layer-2 ID, the same source user info, the same type of data (IP or non-IP) and the same security policy, the UE shall process the new request. However, the target UE shall only delete the existing link context after the new link establishment procedure succeeds.\nNOTE:\tThe type of data (e.g. IP or non-IP) is indicated by the optional IP address configuration IE included in the corresponding DIRECT LINK SECURITY MODE COMPLETE message, i.e the type of data for the requested link is IP type if this IE is included, and the type of data for the requested link is non-IP if this IE is not included.\nThe purpose of the PC5 unicast link modification procedure is to modify the existing PC5 unicast link to:\na)\tadd new PC5 QoS flow(s) to the existing PC5 unicast link;\nb)\tmodify existing PC5 QoS flow(s) for updating PC5 QoS parameters of the existing PC5 QoS flow(s);\nc)\tmodify existing PC5 QoS flow(s) for associating new V2X service(s) with the existing PC5 QoS flow(s);\nd)\tmodify existing PC5 QoS flow(s) for removing the associated V2X service(s) from the existing PC5 QoS flow(s); or\ne)\tremove existing PC5 QoS flow(s) from the existing PC5 unicast link.\nIn this procedure, the UE sending the DIRECT LINK MODIFICATION REQUEST message is called the \"initiating UE\" and the other UE is called the \"target UE\".\nThe initiating UE shall meet the following pre-conditions before initiating this procedure for adding a new V2X service to the existing PC5 unicast link:\na)\tthere is a PC5 unicast link between the initiating UE and the target UE; and\nb)\tthe pair of application layer IDs and the network layer protocol of this PC5 unicast link are identical to those required by the application layer in the initiating UE for this V2X service.\nc)\tthe security policy corresponding to the V2X service identifier(s) (e.g. ITS-AID of the new V2X service) is aligned with the security policy of the existing PC5 unicast link.\nAfter receiving the service data or request from the upper layers, the initiating UE shall perform the PC5 QoS flow match as apecified in clause 6.1.2.13. If there is no matched PC5 QoS flow, the initiating UE shall derive the PC5 QoS parameters and assign the PQFI(s) for the PC5 QoS flows(s) to be established as specified in clause 6.1.2.12.\nIf the PC5 unicast link modification procedure is to add new PC5 QoS flow(s) to the existing PC5 unicast link, the initiating UE shall create a DIRECT LINK MODIFICATION REQUEST message. In this message, initiating UE:\na)\tshall include the PQFI(s) and the corresponding PC5 QoS parameters, including the V2X service identifier(s); and\nb)\tshall include the link modification operation code set to \"Add new PC5 QoS flow(s) to the existing PC5 unicast link \".\nIf the PC5 unicast link modification procedure is to modify the PC5 QoS parameters for existing PC5 QoS flow(s) in the existing PC5 unicast link, the initiating UE shall create a DIRECT LINK MODIFICATION REQUEST message. In this message, the initiating UE:\na)\tshall include the PQFI(s) and the corresponding PC5 QoS parameters, including the V2X service identifier(s); and\nb)\tshall include the link modification operation code set to \"Modify PC5 QoS parameters of the existing PC5 QoS flow(s)\".\nIf the PC5 unicast link modification procedure is to associate new V2X service(s) with existing PC5 QoS flow(s), the initiating UE shall create a DIRECT LINK MODIFICATION REQUEST message. In this message, the initiating UE:\na)\tshall include the PQFI(s) and the corresponding PC5 QoS parameters, including the V2X service identifier(s); and\nb)\tshall include the link modification operation code set to \"Associate new V2X service(s) with existing PC5 QoS flow(s)\".\nIf the PC5 unicast link modification procedure is to remove the associated V2X service(s) from existing PC5 QoS flow(s), the initiating UE shall create a DIRECT LINK MODIFICATION REQUEST message. In this message, the initiating UE:\na)\tshall include the PQFI(s) and the corresponding PC5 QoS parameters including the V2X service identifier(s); and\nb)\tshall include the link modification operation code set to \"Remove V2X service(s) from existing PC5 QoS flow(s)\".\nIf the PC5 unicast link modification procedure is to remove any PC5 QoS flow(s) from the existing PC5 unicast link, the initiating UE shall create a DIRECT LINK MODIFICATION REQUEST message. In this message, the initiating UE:\na)\tshall include the PQFI(s); and\nb)\tshall include the link modification operation code set to \"Remove existing PC5 QoS flow(s) from the existing PC5 unicast link\".\nAfter the DIRECT LINK MODIFICATION REQUEST message is generated, the initiating UE shall pass this message to the lower layers for transmission along with the initiating UE's layer-2 ID for unicast communication and the target UE's layer-2 ID for unicast communication, and start timer T5001. The UE shall not send a new DIRECT LINK MODIFICATION REQUEST message to the same target UE while timer T5001 is running.\nFigure 6.1.2.3.2 presents a detailed procedure for modifying a PC5 unicast link, illustrating the step-by-step process from the initial state to the final configuration. The figure outlines the necessary steps, including the identification of the affected link, the execution of specific commands, and the verification of the changes. Key components such as the network interface controller (NIC), the link aggregation group (LAG), and the spanning tree protocol (STP) are highlighted, emphasizing their role in the modification process. The figure serves as a valuable resource for network administrators and engineers, providing a clear and concise visual guide to ensure the successful modification of PC5 unicast links.\nFigure 6.1.2.3.2: PC5 unicast link modification procedure\nIf the DIRECT LINK MODIFICATION REQUEST message is accepted, the target UE shall respond with the DIRECT LINK MODIFICATION ACCEPT message.\nIf the DIRECT LINK MODIFICATION REQUEST message is to add a new V2X service, add new PC5 QoS flow(s) or modify any existing PC5 QoS flow(s) in the PC5 unicast link, the target UE shall include in the DIRECT LINK MODIFICATION ACCEPT message:\na)\tthe PQFI(s), the corresponding PC5 QoS parameters and the V2X service identifier(s) that the target UE accepts.\nIf the DIRECT LINK MODIFICATION REQUEST message is to remove an existing V2X service from the PC5 unicast link, the target UE shall delete the V2X service identifier received in the DIRECT LINK MODIFICATION REQUEST message and the corresponding PQFI(s) and PC5 QoS parameters from the profile associated with the PC5 unicast link.\nIf the DIRECT LINK MODIFICATION REQUEST message is to remove existing PC5 QoS flow(s) from the PC5 unicast link, the target UE shall delete the PQFI(s) and the corresponding PC5 QoS parameters from the profile associated with the PC5 unicast link.\nIf the DIRECT LINK MODIFICATION REQUEST message is to add a new V2X service, add new PC5 QoS flow(s) or modify any existing PC5 QoS flow(s) in the PC5 unicast link, after sending the DIRECT LINK MODIFICATION ACCEPT message, the target UE shall provide the added or modified PQFI(s) and corresponding PC5 QoS parameters along with PC5 link identifier to the lower layer.\nIf the DIRECT LINK MODIFICATION REQUEST message is to remove an existing V2X service or to remove the existing PC5 QoS flow(s) from the PC5 unicast link, after sending the DIRECT LINK MODIFICATION ACCEPT message, the target UE shall provide the removed PQFI(s) along with the PC5 link identifier to the lower layer.\nIf the target UE accepts the PC5 unicast link modification request, then the target UE may perform the PC5 QoS flow establishment over PC5 unicast link as specified in clause 6.1.2.12 and perform the PC5 QoS flow match over PC5 unicast link as specified in clause 6.1.2.13.\nUpon receipt of the DIRECT LINK MODIFICATION ACCEPT message, the initiating UE shall stop timer T5001.\nUpon receipt of the DIRECT LINK MODIFICATION ACCEPT message, if the DIRECT LINK MODIFICATION REQUEST message is to add a new V2X service, add new PC5 QoS flow(s) or modify any existing PC5 QoS flow(s) in the PC5 unicast link, the initiating UE shall provide the added or modified PQFI(s) and corresponding PC5 QoS parameters along with PC5 link identifier to the lower layer.\nUpon receipt of the DIRECT LINK MODIFICATION ACCEPT message, if the DIRECT LINK MODIFICATION REQUEST message is to remove an existing V2X service or to remove the existing PC5 QoS flow(s) from the PC5 unicast link, the initiating UE shall provide the removed PQFI(s) along with the PC5 link identifier to the lower layer.\nIn addition, the initiating UE may perform the PC5 QoS flow establishment over PC5 unicast link as specified in clause 6.1.2.12.\nIf the PC5 unicast link modification request cannot be accepted, the target UE shall send a DIRECT LINK MODIFICATION REJECT message. The DIRECT LINK MODIFICATION REJECT message contains a PC5 signalling protocol cause IE set to one of the following cause values:\n#5\tlack of resources for PC5 unicast link;\n#11\trequired service not allowed;\n#12\tsecurity policy not aligned; or\n#111\tprotocol error, unspecified.\nIf the target UE is not allowed to accept this request, .e.g. because the V2X service to be added is not allowed per the operator policy or configuration parameters for V2X communication over PC5 as specified in clause 5.2.3, the target UE shall send a DIRECT LINK MODIFICATION REJECT message with PC5 signalling protocol cause value #11 \"required service not allowed\".\nIf the PC5 unicast link modification fails due to the congestion problems or other temporary lower layer problems causing resource constraints, the target UE shall send a DIRECT LINK MODIFICATION REJECT message with PC5 signalling protocol cause value #5 \"lack of resources for PC5 unicast link\".\nIf the link modification operation code is set to \"Associate new V2X service(s) with existing PC5 QoS flow(s)\", and the security policy corresponding to the V2X service identifier(s) (e.g. ITS-AID of the new V2X service) is not aligned with the security policy applied to the existing PC5 unicast link, then the target UE shall send a DIRECT LINK MODIFICATION REJECT message with PC5 signalling protocol cause value #12 \"security policy not aligned\".\nFor other reasons causing the failure of link modification, the target UE shall send a DIRECT LINK MODIFICATION REJECT message with PC5 signalling protocol cause value #111 \"protocol error, unspecified\".\nUpon receipt of the DIRECT LINK MODIFICATION REJECT message, the initiating UE shall stop timer T5001 and abort the PC5 unicast link modification procedure. If the PC5 signalling protocol cause value in the DIRECT LINK MODIFICATION REJECT message is #11 \"required service not allowed\" or #5 \"lack of resources for PC5 unicast link\" or #12 \"security policy not aligned\", then the initiating UE shall not attempt to start PC5 unicast link modification with the same target UE to add the same V2X service, or to add or modify the same PC5 QoS flow(s) at least for a time period T.\nNOTE:\tThe length of time period T is UE implementation specific and can be different for the case when the UE receives PC5 signalling protocol cause value #11 \"required service not allowed\" or when the UE receives PC5 signalling protocol cause value #5 \"lack of resources for PC5 unicast link\" or when the UE receives PC5 signalling protocol cause value #12 \"security policy not aligned\",. The length of time period T is not less than 30 minutes.\nThe following abnormal cases can be identified:\na)\tIf timer T5001 expires, the initiating UE shall retransmit the DIRECT LINK MODIFICATION REQUEST message and restart timer T5001. After reaching the maximum number of allowed retransmissions, the initiating UE shall abort the PC5 unicast link modification procedure and may notify the upper layer that the target UE is unreachable.\nNOTE 1:\tThe maximum number of allowed retransmissions is UE implementation specific.\nNOTE 2:\tAfter reaching the maximum number of allowed retransmissions, whether the initiating UE releases this PC5 unicast link depends on its implementation.\nb)\tFor the same PC5 unicast link, if the initiating UE receives a DIRECT LINK RELEASE message after the initiation of UE-requested PC5 unicast link modification procedure, the initiating UE shall stop the timer T5001 and abort the PC5 unicast link modification procedure and proceed with the PC5 unicast link release procedure.\nc)\tFor the same PC5 unicast link, if the initiating UE receives a DIRECT LINK MODIFICATION REQUEST message during the PC5 unicast link modification procedure, the initiating UE shall stop the timer T5001 and abort the PC5 unicast link modification procedure. Following handling is implementation dependent, e.g., the initiating UE waits for an implementation dependent time for initiating a new PC5 unicast link modification procedure, if still needed.\nNOTE 3:\tThe implementation dependent timer value needs to be set to avoid further collisions (e.g. random timer value).\nThe PC5 unicast link release procedure is used to release a PC5 unicast link between two UEs. The link can be released from either end point. The UE sending the DIRECT LINK RELEASE REQUEST message is called the \"initiating UE\" and the other UE is called the \"target UE\".\nf the UE receives an indication of radio link failure from the lower layer, the UE shall release the PC5 unicast link locally and may delete the KNRP ID associated with this link after an implementation specific time.\nThe initiating UE shall initiate the procedure if a request from upper layers to release a PC5 unicast link with the target UE which uses a known layer-2 ID (for unicast communication) is received and there is an existing PC5 unicast link between these two UEs.\nThe initiating UE may initiate the procedure if the target UE has been non-responsive, e.g. no response in the PC5 unicast link modification procedure, PC5 unicast link identifier update procedure, PC5 unicast link re-keying procedure or PC5 unicast link keep-alive procedure.\nThe initiating UE may initiate the procedure to release an established PC5 unicast link if the UE has reached the maximum number of established PC5 unicast links and there is a need to establish a new PC5 unicast link. In this case, which PC5 unicast link is to be released is up to UE implementation.\nThe initiating UE may initiate the procedure to release an established PC5 unicast link upon expiry of the timer T5005.\nIn order to initiate the PC5 unicast link release procedure, the initiating UE shall create a DIRECT LINK RELEASE REQUEST message with a PC5 signalling protocol cause IE indicating one of the following cause values:\n#1\tdirect communication to the target UE not allowed;\n#2\tdirect communication to the target UE no longer needed;\n#4\tdirect connection is not available anymore;\n#5\tlack of resources for PC5 unicast link; or\n#111\tprotocol error, unspecified.\nThe initiating UE shall include the new 2 MSBs of KNRP ID in the DIRECT LINK RELEASE REQUEST message.\nAfter the DIRECT LINK RELEASE REQUEST message is generated, the initiating UE shall pass this message to the lower layers for transmission along with the initiating UE's layer-2 ID for unicast communication and the target UE's layer-2 ID for unicast communication, and shall stop T5011 if running. The initiating UE shall start timer T5002.\nFigure 6.1.2.4.2.1 illustrates the PC5 unicast link release procedure, which is a crucial step in the process of releasing a link in a network. The figure depicts the various stages of the procedure, including the initial state where the link is established, the intermediate state where the link is being released, and the final state where the link has been completely released. The figure also shows the role of the PC5 unicast link release procedure in ensuring the efficient and reliable operation of the network.\nFigure 6.1.2.4.2.1: PC5 unicast link release procedure\nUpon receiving a DIRECT LINK RELEASE REQUEST message, the target UE shall stop all running timers for this PC5 unicast link and abort any other ongoing PC5 signalling protocol procedures on this PC5 unicast link. The target UE shall respond with a DIRECT LINK RELEASE ACCEPT message. The target UE shall include the new 2 LSBs of KNRP ID in the DIRECT LINK RELEASE ACCEPT message. After the message is sent, the target UE shall release the PC5 unicast link by performing the following behaviors:\na)\tinform the lower layer along with the PC5 link identifier that the PC5 unicast link has been released; and\nb)\tdelete the PC5 unicast link context of the PC5 unicast link after an implementation specific time.\nThe target UE shall form the new KNRP ID from the new 2 MSBs of KNRP ID received in the DIRECT LINK RELEASE REQUEST message and the new 2 LSBs of KNRP ID included in the DIRECT LINK RELEASE ACCEPT message. The target UE shall replace the existing KNRP ID with the new KNRP ID. The target UE may include the new KNRP ID in DIRECT LINK ESTABLISHMENT REQUEST message with the initiating UE as specified in clause 6.1.2.2.2.\nUpon receipt of the DIRECT LINK RELEASE ACCEPT message, the initiating UE shall stop timer T5002 and shall release the PC5 unicast link by performing the following behaviors:\na)\tinform the lower layer along with the PC5 link identifier that the PC5 unicast link has been released; and\nb)\tdelete the PC5 unicast link context of the PC5 unicast link after an implementation specific time.\nThe initiating UE shall form the new KNRP ID from the 2 MSBs of KNRP ID included in the DIRECT LINK RELEASE REQUEST message and the 2 LSBs of KNRP ID received in the DIRECT LINK RELEASE ACCEPT message. The initiating UE shall replace the existing KNRP ID with the new KNRP ID. The initiating UE may include the new KNRP ID in DIRECT LINK ESTABLISHMENT REQUEST message with the target UE as specified in clause 6.1.2.2.2.\nIf retransmission timer T5002 expires and the PC5 signalling protocol cause included in the PC5 signalling protocol cause IE in the DIRECT LINK RELEASE REQUEST message was #4 \"direct connection is not available anymore\", the initiating UE shall release the PC5 unicast link locally and delete the KNRP ID associated with this link. From this time onward the initiating UE shall no longer send or receive any messages via this link.\nIf retransmission timer T5002 expires and the PC5 signalling protocol cause included in the PC5 signalling protocol cause IE in the DIRECT LINK RELEASE REQUEST message was not #4 \"direct connection is not available anymore\", the initiating UE shall initiate the transmission of the DIRECT LINK RELEASE REQUEST message again and restart timer T5002.\nIf no response is received from the target UE after reaching the maximum number of allowed retransmissions, the initiating UE shall release the PC5 unicast link locally and delete the KNRP ID associated with this link. From this time onward the initiating UE shall no longer send or receive any messages via this link.\nNOTE:\tThe maximum number of allowed retransmissions is UE implementation specific.\nThe PC5 unicast link identifier update procedure is used to update and exchange the new identifiers (e.g. application layer ID, layer-2 ID, security information and IP address/prefix) between two UEs for a PC5 unicast link before using the new identifiers. The UE sending the DIRECT LINK IDENTIFIER UPDATE REQUEST message is called the \"initiating UE\" and the other UE is called the \"target UE\".\nThe initiating UE shall initiate the procedure if:\na)\tthe initiating UE receives a request from upper layers to change the application layer ID and there is an existing PC5 unicast link associated with this application layer ID; or\nb)\tthe privacy timer (see clause 5.2.3) of the initiating UE's layer-2 ID expires for an existing PC5 unicast link.\nIf the PC5 unicast link identifier update procedure is triggered by a change of the initiating UE's application layer ID, the initiating UE shall create a DIRECT LINK IDENTIFIER UPDATE REQUEST message. In this message, the initiating UE\na)\tshall include the initiating UE's new application layer ID received from upper layer;\nb)\tshall include the initiating UE's new layer-2 ID assigned by itself;\nc)\tshall include the new MSB of KNRP-sess ID, or set to all zeros if the selected integrity protection algorithm is the null integrity protection algorithm; and\nd)\tshall include the new IP address/prefix if IP communication is used.\nIf the PC5 unicast link identifier update procedure is triggered by the expiry of the initiating UE's privacy timer T5011 as specified in clause 5.2.3, the initiating UE shall create a DIRECT LINK IDENTIFIER UPDATE REQUEST message. In this message, the initiating UE\na)\tshall include the initiating UE's new layer-2 ID assigned by itself;\nb)\tshall include the new MSB of KNRP-sess ID;\nc)\tmay include the initiating UE's new application layer ID if received from upper layer; and\nd)\tshall include the new IP address/prefix if IP communication is used and changed.\nAfter the DIRECT LINK IDENTIFIER UPDATE REQUEST message is generated, the initiating UE shall pass this message to the lower layers for transmission along with the initiating UE's old layer-2 ID for unicast communication and the target UE's layer-2 ID for unicast communication, and start timer T5009. The UE shall not send a new DIRECT LINK IDENTIFIER UPDATE REQUEST message to the same target UE while timer T5009 is running.\nFigure 6.1.2.5.2.1 illustrates the PC5 unicast link identifier update procedure, which involves the transmission control protocol (TCP) and the internet protocol (IP) header fields. The figure depicts the process of updating the link identifier in a network, highlighting the role of the network layer (Layer 3) and the transport layer (Layer 4) in this operation. The figure demonstrates the exchange of information between the sender and receiver, ensuring efficient and reliable data transmission.\nFigure 6.1.2.5.2.1: PC5 unicast link identifier update procedure\nUpon receipt of a DIRECT LINK IDENTIFIER UPDATE REQUEST message, if the target UE determines:\na)\tthe PC5 unicast link associated with this request message is still valid; and\nb)\tthe timer T5010 for the PC5 unicast link identified by this request message is not running,\nthen the target UE accepts this request, and responds with a DIRECT LINK IDENTIFIER UPDATE ACCEPT message.\nThe target UE shall create the DIRECT LINK IDENTIFIER UPDATE ACCEPT message. In this message, the target UE:\na)\tshall include the target UE's new layer-2 ID assigned by itself;\nb)\tshall include the new LSB of KNRP-sess ID;\nc)  shall include the initiating UE's new MSB of KNRP-sess ID;\nd)  shall include the initiating UE's new layer-2 ID;\ne)\tshall include the target UE's new application layer ID if received from upper layer;\nf)\tshall include the initiating UE's new IP address/prefix if received from the initiating UE and IP communication is used;\ng)\tshall include the initiating UE's new application layer ID if received from the initiating UE; and\nh)\tshall include the target UE's new IP address/prefix if IP communication is used and changed.\nAfter the DIRECT LINK IDENTIFIER UPDATE ACCEPT message is generated, the target UE shall pass this message to the lower layers for transmission along with the initiating UE's old layer-2 ID for unicast communication and the target UE's old layer-2 ID for unicast communication, and start timer T5010. The UE shall not send a new DIRECT LINK IDENTIFIER UPDATE ACCEPT message to the same initiating UE while timer T5010 is running.\nBefore target UE receives the traffic using the new layer-2 IDs, the target UE shall continue to receive the traffic with the old layer-2 IDs (i.e. initiating UE's old layer-2 ID and target UE's old layer-2 ID) from initiating UE.\nBefore target UE receives the DIRECT LINK IDENTIFIER UPDATE ACK message from initiating UE, the target UE shall keep sending traffic to the initiating UE using the old layer-2 IDs (i.e. initiating UE's old layer-2 ID for unicast communication and target UE's old layer-2 ID for unicast communication).\nUpon receipt of the DIRECT LINK IDENTIFIER UPDATE ACCEPT message, the initiating UE shall stop timer T5009 and respond with a DIRECT LINK IDENTIFIER UPDATE ACK message. In this message, the initiating UE:\na)\tshall include the target UE's new layer-2 ID;\nb)\tshall include the target UE's new LSB of KNRP-sess ID;\nc)\tshall include the target UE's new application layer ID, if received; and\nd)\tshall include the target UE's new IP address/prefix, if received.\nAfter the DIRECT LINK IDENTIFIER UPDATE ACK message is generated, the initiating UE shall pass this message to the lower layers for transmission along with the initiating UE's old layer-2 ID for unicast communication and the target UE's old layer-2 ID for unicast communication and shall stop timer T5011 if running and start a timer T5011 as configured if at least one of V2X service identifiers for the PC5 unicast link satisfying the privacy requirements as specified in clause 5.2.3.\nUpon sending the DIRECT LINK IDENTIFIER UPDATE ACK message, the initiating UE shall update the associated PC5 unicast link context with the new identifiers and pass the new layer-2 IDs (i.e. initiating UE's new layer-2 ID for unicast communication and target UE's new layer-2 ID for unicast communication if changed) along with the PC5 link identifier down to the lower layer. Then the initiating UE shall use the new layer-2 IDs (i.e. initiating UE's new layer-2 ID for unicast communication and target UE's new layer-2 ID for unicast communication if changed) to transmit the PC5 signalling message and PC5 user plane data.\nThe initiating UE shall continue to receive traffic with the old layer-2 IDs (i.e. initiating UE's old layer-2 ID for unicast communication and target UE's old layer-2 ID for unicast communication) from the target UE until it receives traffic with the new layer-2 IDs (i.e. initiating UE's new layer-2 ID and target UE's new layer-2 ID if changed) from the target UE.\nUpon receipt of the DIRECT LINK IDENTIFIER UPDATE ACK message, the target UE shall update the associated PC5 unicast link context with the new identifiers, pass the new layer-2 IDs (i.e. initiating UE's new layer-2 ID and target UE's new layer-2 ID if changed) down to the lower layer, stop timer T5010 and timer T5011 if running and start a timer T5011 as configured if at least one of V2X service identifiers for the PC5 unicast link satisfying the privacy requirements as specified in clause 5.2.3. Then the target UE shall use the new layer-2 IDs (i.e. initiating UE's new layer-2 ID for unicast communication and target UE's new layer-2 ID for unicast communication if changed) to transmit the PC5 signalling message and PC5 user plane data.\nIf the DIRECT LINK IDENTIFIER UPDATE REQUEST message cannot be accepted, the target UE shall send a DIRECT LINK IDENTIFIER UPDATE REJECT message. The DIRECT LINK IDENTIFIER UPDATE REJECT message contains a PC5 signalling protocol cause IE set to one of the following cause values:\n#3\tconflict of layer-2 ID for unicast communication is detected; or\n#111\tprotocol error, unspecified.\nFor a received DIRECT LINK IDENTIFIER UPDATE REQUEST message from a layer-2 ID (for unicast communication), if the target UE already has an existing link using this layer-2 ID or is currently processing a DIRECT LINK IDENTIFIER UPDATE REQUEST message from the same layer-2 ID, but with user info different from the user info IE included in this new incoming message, the target UE shall send a DIRECT LINK IDENTIFIER UPDATE REJECT message with PC5 signalling protocol cause value #3 \"conflict of layer-2 ID for unicast communication is detected\".\nNOTE:\tAfter receiving the DIRECT LINK IDENTIFIER UPDATE REJECT message, whether the initiating UE initiates the PC5 unicast link release procedure or initiates another PC5 unicast link identifier update procedure with a new layer-2 ID depends on UE implementation.\nFor other reasons causing the failure of link identifier update, the target UE shall send a DIRECT LINK IDENTIFIER UPDATE REJECT message with PC5 signalling protocol cause value #111 \"protocol error, unspecified\".\nUpon receipt of the DIRECT LINK IDENTIFIER UPDATE REJECT message, the initiating UE shall stop timer T5009 and abort this PC5 unicast link identifier update procedure.\nThe following abnormal cases can be identified:\na)\tIf timer T5009 expires, the initiating UE shall retransmit the DIRECT LINK IDENTIFIER UPDATE REQUEST message and restart timer T5009. After reaching the maximum number of allowed retransmissions, the initiating UE shall abort the PC5 unicast link identifier update procedure and may notify the upper layer that the target UE is unreachable.\nNOTE 1:\tThe maximum number of allowed retransmissions is UE implementation specific.\nNOTE 2:\tAfter reaching the maximum number of allowed retransmissions, whether the initiating UE releases this PC5 unicast link depends on its implementation.\nb)\tFor the same PC5 unicast link, if the initiating UE receives a DIRECT LINK IDENTIFIER UPDATE REQUEST message during the PC5 unicast link identifier update procedure, the initiating UE shall stop the timer T5009 and abort the PC5 unicast link identifier update procedure. Following handling is implementation dependent, e.g., the initiating UE waits for an implementation dependent time for initiating a new PC5 unicast link identifier update procedure, if still needed.\nNOTE 3:\tThe implementation dependent timer value needs to be set to avoid further collisions (e.g. random timer value).\nc)\tFor the same PC5 unicast link, if the initiating UE receives a DIRECT LINK REKEYING REQUEST message after initiating the PC5 unicast link identifier update procedure, the initiating UE shall ignore the DIRECT LINK REKEYING REQUEST message and proceed with the PC5 unicast link identifier update procedure.\nd)\tFor the same PC5 unicast link, if the initiating UE receives a DIRECT LINK RELEASE REQUEST message after the initiation of PC5 unicast link identifier update procedure, the initiating UE shall stop the timer T5009 and abort the PC5 unicast link identifier update procedure and proceed with the PC5 unicast link release procedure.\nThe following abnormal cases can be identified:\na)\tIf timer T5010 expires, the target UE shall retransmit the DIRECT LINK IDENTIFIER UPDATE ACCEPT message and restart timer T5010. After reaching the maximum number of allowed retransmissions, the target UE shall abort the PC5 unicast link identifier update procedure and may notify the upper layer that the initiating UE is unreachable.\nNOTE 1:\tThe maximum number of allowed retransmissions is UE implementation specific.\nNOTE 2:\tAfter reaching the maximum number of allowed retransmissions, whether the target UE releases this PC5 unicast link depends on its implementation.\nb)\tIf DIRECT LINK IDENTIFIER UPDATE REQUEST is received when the timer T5010 is running, the target UE shall stop the timer T5010 and abort the ongoing PC5 unicast link identifier update procedure. The target UE shall handle the new DIRECT LINK IDENTIFIER UPDATE REQUEST as specified in clause 6.1.2.5.3.\nc)\tAfter sending the DIRECT LINK IDENTIFIER UPDATE ACK message to the target UE, if another DIRECT LINK IDENTIFIER UPDATE ACCEPT message from the target UE is received before the traffic from the target UE with the new layer-2 IDs is received, the initiating UE shall retransmit the DIRECT LINK IDENTIFIER UPDATE ACK message along with the initiating UE's old layer-2 ID and the target UE's old layer-2 ID\nNOTE 3:\tIt is up to implementation to handle the failure of traffic delivery for new layer-2 IDs if such traffic has been sent before the initiating UE retransmits the DIRECT LINK IDENTIFIER UPDATE ACK message.\nd)\tAfter sending the DIRECT LINK IDENTIFIER UPDATE ACK message to the target UE, if the initiating UE keeps receiving traffic from the target UE with the old layer-2 IDs and traffic from the target UE with the new layer-2 IDs is not received during an implementation specific time which is greater than the value of timer T5010, the initiating UE shall abort the PC5 unicast link identifier update procedure and may release the PC5 unicast link.\nThe PC5 unicast link authentication procedure is used to perform mutual authentication of UEs establishing a PC5 unicast link and to derive a new KNRP shared between two UEs during a PC5 unicast link establishment procedure or a PC5 unicast link re-keying procedure. After successful completion of the PC5 unicast link authentication procedure, the new KNRP is used for security establishment during the PC5 unicast link security mode control procedure as specified in clause 6.1.2.7. The UE sending the DIRECT LINK AUTHENTICATION REQUEST message is called the \"initiating UE\" and the other UE is called the \"target UE\".\nThe initiating UE shall meet one of the following pre-conditions when establishing the non-null signalling integrity protection based on the decision of the initiating UE, before initiating the PC5 unicast link authentication procedure:\na)\tthe target UE has initiated a PC5 unicast link establishment procedure toward the initiating UE by sending a DIRECT LINK ESTABLISHMENT REQUEST message and:\n1)\tthe DIRECT LINK ESTABLISHMENT REQUEST message:\ni)\tincludes a target user info IE which includes the application layer ID of the initiating UE; or\nii)\tdoes not include a target user info IE and the initiating UE is interested in the V2X service identified by the V2X service identifier in the DIRECT LINK ESTABLISHMENT REQUEST message; and\n2)\tthe KNRP ID is not included in the DIRECT LINK ESTABLISHMENT REQUEST message or the initiating UE does not have an existing KNRP for the KNRP ID included in DIRECT LINK ESTABLISHMENT REQUEST message or the initiating UE derives a new KNRP; or\nb)\tthe target UE has initiated a PC5 unicast link re-keying procedure toward the initiating UE by sending a DIRECT LINK REKEYING REQUEST message and the DIRECT LINK REKEYING REQUEST message includes a Re-authentication indication.\nIn order to initiate the PC5 unicast link authentication procedure, the initiating UE shall create a DIRECT LINK AUTHENTICATION REQUEST message. In this message, the initiating UE:\na)\tshall include the key establishment information container IE.\nNOTE:\tThe Key establishment information container is provided by upper layers.\nAfter the DIRECT LINK AUTHENTICATION REQUEST message is generated, the initiating UE shall pass this message to the lower layers for transmission along with the initiating UE's layer-2 ID for unicast communication and the target UE's layer-2 ID for unicast communication.\nThe initiating UE shall start timer T5006. The UE shall not send a new DIRECT LINK AUTHENTICATION REQUEST message to the same target UE while timer T5006 is running.\nFigure 6.1.2.6.2 illustrates the PC5 unicast link authentication procedure, which involves the use of a pre-authentication handshake to ensure secure communication between devices. The figure depicts the process of key exchange and mutual authentication between the sender and receiver, highlighting the importance of secure data transmission in modern networking. Key components include the use of EAP-AKA for authentication and the exchange of cryptographic keys to establish a secure link. The figure emphasizes the need for robust security measures in wireless communication, particularly in the context of 5G networks.\nFigure 6.1.2.6.2: PC5 unicast link authentication procedure\nUpon receipt of a DIRECT LINK AUTHENTICATION REQUEST message, if a new assigned initiating UE's layer-2 ID is included, the target UE shall replace the original initiating UE's layer-2 ID with the new assigned initiating UE's layer-2 ID for unicast communication. If the target UE determines that the DIRECT LINK AUTHENTICATION REQUEST message can be accepted, the target UE shall create a DIRECT LINK AUTHENTICATION RESPONSE message. The target UE shall check if the number of established PC5 unicast links is less than the implementation-specific maximum number of established NR PC5 unicast links allowed in the UE at a time. In this message, the target UE:\na)\tshall include the Key establishment information container IE.\nNOTE:\tThe key establishment information container is provided by upper layers.\nAfter the DIRECT LINK AUTHENTICATION RESPONSE message is generated, the target UE shall pass this message to the lower layers for transmission along with the target UE's layer-2 ID for unicast communication and the initiating UE's layer-2 ID for unicast communication.\nUpon receiving a DIRECT LINK AUTHENTICATION RESPONSE message, if the initiating UE determines that the DIRECT LINK AUTHENTICATION RESPONSE message can be accepted, the initiating UE shall stop timer T5006.\nNOTE:\tWhen the initiating UE derives the new KNRP during the PC5 unicast link authentication procedure depends on the authentication method in use.\nIf the DIRECT LINK AUTHENTICATION REQUEST message cannot be accepted, the target UE shall create a DIRECT LINK AUTHENTICATION REJECT message. In this message, the target UE shall include a PC5 signalling protocol cause IE indicating one of the following cause values:\n#6:\tauthentication failure;\n#5:\tlack of resources for PC5 unicast link.\nIf this PC5 unicast link authentication procedure is triggered during the PC5 unicast link establishment procedure and the implementation-specific maximum number of established NR PC5 unicast links has been reached, then the target UE shall send a DIRECT LINK AUTHENTICATION REJECT message containing PC5 signalling protocol cause value #5 \"lack of resources for PC5 unicast link\".\nAfter the DIRECT LINK AUTHENTICATION REJECT message is generated, the target UE shall pass this message to the lower layers for transmission along with the initiating UE's layer-2 ID for unicast communication and the target UE's layer-2 ID for unicast communication.\nThe target UE shall abort the ongoing procedure that triggered the initiation of the PC5 unicast link authentication procedure if the ongoing procedure is the PC5 unicast link establishment procedure and the Target user info is included in the DIRECT LINK ESTABLISHMENT REQUEST message.\nUpon receipt of the DIRECT LINK AUTHENTICATION REJECT message, the initiating UE shall stop timer T5006 and abort the ongoing procedure that triggered the initiation of the PC5 unicast link authentication procedure.\nIf the DIRECT LINK AUTHENTICATION RESPONSE message cannot be accepted, the initiating UE shall stop timer T5006 and create a DIRECT LINK AUTHENTICATION FAILURE message. In this message, the initiating UE may include the Key establishment information container IE if provided by upper layers.\nAfter the DIRECT LINK AUTHENTICATION FAILURE message is generated, the initiating UE shall pass this message to the lower layers for transmission along with the initiating UE's layer-2 ID for unicast communication and the target UE's layer-2 ID for unicast communication.\nThe initiating UE shall abort the ongoing procedure that triggered the initiation of the PC5 unicast link authentication procedure.\nUpon receipt of the DIRECT LINK AUTHENTICATION FAILURE message and if the PC5 unicast link authentication procedure was initiated due to a PC5 unicast link establishment procedure that includes a Target user info in the DIRECT LINK ESTABLISHMENT REQUEST message, the target UE shall abort the ongoing procedure that triggered the initiation of the PC5 unicast link authentication procedure and shall indicate to upper layers that authentication has failed.\na)\tTimer T5006 expires.\nThe initiating UE shall retransmit the DIRECT LINK AUTHENTICATION REQUEST message and restart timer T5006. After reaching the maximum number of allowed retransmissions, the initiating UE shall abort the PC5 unicast link authentication procedure and shall abort the ongoing procedure that triggered the initiation of the PC5 unicast link authentication procedure.\nNOTE:\tThe maximum number of allowed retransmissions is UE implementation specific.\nb)\tThe need to use this PC5 unicast link no longer exists before the PC5 unicast link authentication procedure is completed.\nThe initiating UE shall abort the procedure and shall abort the ongoing procedure that triggered the initiation of the PC5 unicast link authentication procedure.\nThe PC5 unicast link security mode control procedure is used to establish security between two UEs during a PC5 unicast link establishment procedure or a PC5 unicast link re-keying procedure. After successful completion of the PC5 unicast link security mode control procedure, the selected security algorithms and their non-null associated keys are used to integrity protect and cipher all PC5 signalling messages exchanged over this PC5 unicast link between the UEs and the security context can be used to protect all PC5 user plane data exchanged over this PC5 unicast link between the UEs. The UE sending the DIRECT LINK SECURITY MODE COMMAND message is called the \"initiating UE\" and the other UE is called the \"target UE\".\nThe initiating UE shall meet the following pre-conditions before initiating the PC5 unicast link security mode control procedure:\na)\tthe target UE has initiated a PC5 unicast link establishment procedure toward the initiating UE by sending a DIRECT LINK ESTABLISHMENT REQUEST message and:\n1)\tthe DIRECT LINK ESTABLISHMENT REQUEST message:\ni)\tincludes a target user info IE which includes the application layer ID of the initiating UE; or\nii)\tdoes not include a target user info IE and the initiating UE is interested in the V2X service identified by the V2X service identifier in the DIRECT LINK ESTABLISHMENT REQUEST message; and\n2)\tthe initiating UE:\ni)\thas either identified an existing KNRP based on the KNRP ID included in the DIRECT LINK ESTABLISHMENT REQUEST message or derived a new KNRP; or\nii)\thas decided not to activate security protection based on its UE PC5 unicast signalling security policy and the target UE's PC5 unicast signalling security policy; or\nb)\tthe target UE has initiated a PC5 unicast link re-keying procedure toward the initiating UE by sending a DIRECT LINK REKEYING REQUEST message and:\n1)\tif the target UE has included a Re-authentication indication in the DIRECT LINK REKEYING REQUEST message, the initiating UE has derived a new KNRP.\nIf a new KNRP has been derived by the initiating UE, the initiating UE shall generate the 2 MSBs of KNRP ID to ensure that the resultant KNRP ID will be unique in the initiating UE.\nThe initiating UE shall select security algorithms in accordance with its UE PC5 unicast signalling security policy and the target UE's PC5 unicast signalling security policy. If the PC5 unicast link security mode control procedure was triggered during a PC5 unicast link establishment procedure, the initiating UE shall not select the null integrity protection algorithm if the initiating UE or the target UE's PC5 unicast signalling integrity protection policy is set to \"signalling integrity protection required\". If the PC5 unicast link security mode control procedure was triggered during a PC5 unicast link re-keying procedure, the initiating UE:\na)\tshall not select the null integrity protection algorithm if the integrity protection algorithm currently in use for the PC5 unicast link is different from the null integrity protection algorithm;\nb)\tshall not select the null ciphering protection algorithm if the ciphering protection algorithm currently in use for the PC5 unicast link is different from the null ciphering protection algorithm;\nc)\tshall select the null integrity protection algorithm if the integrity protection algorithm currently in use is the null integrity protection algorithm; and\nd)\tshall select the null ciphering protection algorithm if the ciphering protection algorithm currently in use is the null ciphering protection algorithm.\nThen the initiating UE shall:\na)\tgenerate a 128-bit Nonce_2 value;\nb)\tderive KNRP-sess from KNRP, Nonce_2 and Nonce_1 received in the DIRECT LINK ESTABLISHMENT REQUEST message as specified in 3GPP TS 33.536 [20];\nc)\tderive the NR PC5 encryption key NRPEK and the NR PC5 integrity key NRPIK from KNRP-sess and the selected security algorithms as specified in 3GPP TS 33.536 [20], and\nd)\tcreate a DIRECT LINK SECURITY MODE COMMAND message. In this message, the initiating UE:\n1)\tshall include the key establishment information container IE if a new KNRP has been derived at the initiating UE and the authentication method used to generate KNRP requires sending information to complete the authentication procedure;\nNOTE:\tThe key establishment information container is provided by upper layers.\n2)\tshall include the MSBs of KNRP ID IE if a new KNRP has been derived at the initiating UE;\n3)\tshall include a Nonce_2 IE set to the 128-bit nonce value generated by the initiating UE for the purpose of session key establishment over this PC5 unicast link if the selected integrity protection algorithms is not the null integrity protection algorithm;\n4)\tshall include the selected security algorithms;\n5)\tshall include the UE security capabilities received from the target UE in the DIRECT LINK ESTABLISHMENT REQUEST message or DIRECT LINK REKEYING REQUEST message;\n6)\tshall include the UE PC5 unicast signalling security policy received from the target UE in the DIRECT LINK ESTABLISHMENT REQUEST message; and\n7)\tshall include the LSB of KNRP-sess ID chosen by the initiating UE as specified in 3GPP TS 33.536 [20] if the selected integrity protection algorithms is not the null integrity protection algorithm.\nIf the security protection of this PC5 unicast link is activated by using non-null integrity protection algorithm or non-null ciphering protection algorithm, the initiating UE shall form the KNRP-sess ID from the MSB of KNRP-sess ID received in the DIRECT LINK ESTABLISHMENT REQUEST message or DIRECT LINK REKEYING REQUEST message and the LSB of KNRP-sess ID included in the DIRECT LINK SECURITY MODE COMMAND message. The initiating UE shall use the KNRP-sess ID to identify the new security context.\nAfter the DIRECT LINK SECURITY MODE COMMAND message is generated, the initiating UE shall pass this message to the lower layers for transmission along with the initiating UE's layer-2 ID for unicast communication and the target UE's layer-2 ID for unicast communication, NRPIK, NRPEK if applicable, KNRP-sess ID, the selected security algorithm as specified in TS 33.536 [20]; an indication of activation of the PC5 unicast signalling security protection for the PC5 unicast link with the new security context, if applicable, and start timer T5007. The initiating UE shall not send a new DIRECT LINK SECURITY MODE COMMAND message to the same target UE while timer T5007 is running.\nNOTE:\tThe DIRECT LINK SECURITY MODE COMMAND message is integrity protected (and not ciphered) at the lower layer using the new security context.\nIf the PC5 unicast link security mode control procedure was triggered during a PC5 unicast link re-keying procedure, the initiating UE shall provide to the lower layers an indication of activation of the PC5 unicast user plane security protection for the PC5 unicast link with the new security context, if applicable, along with the initiating UE's layer-2 ID for unicast communication and the target UE's layer-2 ID for unicast communication.\nFigure 6.1.2.7.2 illustrates the PC5 unicast link security mode control procedure, which involves the establishment of a secure connection between two endpoints. The figure depicts the process of authentication, encryption, and key exchange between the sender and receiver. Key components include the PC5 interface, which facilitates the communication between the two devices, and the security mechanisms such as Transport Layer Security (TLS) and Internet Protocol Security (IPsec) that ensure data confidentiality and integrity. The figure highlights the importance of secure communication in modern networking, particularly in the context of cloud-based services and IoT devices.\nFigure 6.1.2.7.2: PC5 unicast link security mode control procedure\nUpon receipt of a DIRECT LINK SECURITY MODE COMMAND message, if a new assigned initiating UE's layer-2 ID is included and if the authentication procedure has not been executed, the target UE shall replace the original initiating UE's layer-2 ID with the new assigned initiating UE's layer-2 ID for unicast communication. The target UE shall check the selected security algorithms IE included in the DIRECT LINK SECURITY MODE COMMAND message. If \"null integrity algorithm\" is included in the selected security algorithms IE, the integrity protection is not offered for the PC5 unicast linkand the signalling messages are transmitted unprotected. If \"null ciphering algorithm\" and an integrity algorithm other than \"null integrity algorithm\" are included in the selected algorithms IE, the ciphering protection is not offered for the PC5 unicast link and signalling messages are transmitted unprotected. If the target UE's PC5 unicast signalling integrity protection policy is set to \"signalling integrity protection required\", the target UE shall check the selected security algorithms IE in the DIRECT LINK SECURITY MODE COMMAND message does not include the null integrity protection algorithm. If the selected integrity protection algorithm is not the null integrity protection algorithm, the target UE shall:\na)\tderive KNRP-sess from KNRP, Nonce_1 and Nonce_2 received in the DIRECT LINK SECURITY MODE COMMAND message as specified in 3GPP TS 33.536 [20]; and\nb)\tderive NRPIK from KNRP-sess and the selected integrity algorithm as specified in 3GPP TS 33.536 [20].\nIf the KNRP-sess is derived and the selected ciphering protection algorithm is not the null ciphering protection algorithm, then the target UE shall derive NRPEK from KNRP-sess and the selected ciphering algorithm as specified in 3GPP TS 33.536 [20].\nThe target UE shall determine whether or not the DIRECT LINK SECURITY MODE COMMAND message can be accepted by:\na)\tchecking that the selected security algorithms in the DIRECT LINK SECURITY MODE COMMAND message does not include the null integrity protection algorithm if the target UE's PC5 unicast signalling integrity protection policy is set to \"signalling integrity protection required\";\nb)\tasking the lower layers to check the integrity of the DIRECT LINK SECURITY MODE COMMAND message using NRPIK and the selected integrity protection algorithm, if the selected integrity protection algorithm is not the null integrity protection algorithm;\nc)\tchecking that the received UE security capabilities have not been altered compared to the values that the target UE sent to the initiating UE in the DIRECT LINK ESTABLISHMENT REQUEST message or DIRECT LINK REKEYING REQUEST message;\nd)\tif the PC5 unicast link security mode control procedure was triggered during a PC5 unicast link establishment procedure,\n1)\tchecking that the received UE PC5 unicast signalling security policy has not been altered compared to the values that the target UE sent to the initiating UE in the DIRECT LINK ESTABLISHMENT REQUEST message; and\n2)\tchecking that the LSB of KNRP-sess ID included in the DIRECT LINK SECURITY MODE COMMAND message are not set to the same value as those received from another UE in response to the target UE's DIRECT LINK ESTABLISHMENT REQUEST message; and\ne)\tif the PC5 unicast link security mode control procedure was triggered during a PC5 unicast link re-keying procedure and the integrity protection algorithm currently in use for the PC5 unicast link is different from the null integrity protection algorithm, checking that the selected security algorithms in the DIRECT LINK SECURITY MODE COMMAND message do not include the null integrity protection algorithm.\nIf the target UE did not include a KNRP ID in the DIRECT LINK ESTABLISHMENT REQUEST message, the target UE included a Re-authentication indication in the DIRECT LINK REKEYING REQUEST message or the initiating UE has chosen to derive a new KNRP, the target UE shall derive KNRP as specified in 3GPP TS 33.536 [20]. The target UE shall choose the 2 LSBs of KNRP ID to ensure that the resultant KNRP ID will be unique in the target UE. The target UE shall form KNRP ID from the received 2 MSBs of KNRP ID and its chosen 2 LSBs of KNRP ID and shall store the complete KNRP ID with KNRP.\nIf the target UE accepts the DIRECT LINK SECURITY MODE COMMAND message, the target UE shall create a DIRECT LINK SECURITY MODE COMPLETE message. In this message, the target UE:\na)\tshall include the PQFI and the corresponding PC5 QoS parameters;\nb)\tif IP communication is used and the PC5 unicast link security mode control procedure was triggered during a PC5 unicast link establishment procedure, shall include an IP address configuration IE set to one of the following values:\n1)\t\"IPv6 router\" if IPv6 address allocation mechanism is supported by the target UE, i.e. acting as an IPv6 router; or\n2)\t\"IPv6 address allocation not supported\" if IPv6 address allocation mechanism is not supported by the target UE;\nc)\tif IP communication is used, the IP address configuration IE is set to \"IPv6 address allocation not supported\" and the PC5 unicast link security mode control procedure was triggered during a PC5 unicast link establishment procedure, shall include a link local IPv6 address IE formed locally based on IETF RFC 4862 [6];\nd)\tif a new KNRP was derived, shall include the 2 LSBs of KNRP ID; and\ne)\tif the PC5 unicast link security mode control procedure was triggered during a PC5 unicast link establishment procedure, shall include its UE PC5 unicast user plane security policy for this PC5 unicast link. In the case where the different V2X services are mapped to the different PC5 unicast user plane security policies, when more than one V2X service identifier is included in the DIRECT LINK ESTABLISHMENT REQUEST message, each of the user plane security polices of those V2X services shall be compatible, e.g. \"user plane integrity protection not needed\" and \" user plane integrity protection required\" are not compatible.\nIf the selected integrity protection algorithm is not the null integrity protection algorithm, the target UE shall form the KNRP-sess ID from the MSB of KNRP-sess ID it had sent in the DIRECT LINK ESTABLISHMENT REQUEST message or DIRECT LINK REKEYING REQUEST message and the LSB of KNRP-sess ID received in the DIRECT LINK SECURITY MODE COMMAND message. The target UE shall use the KNRP-sess ID to identify the new security context.\nAfter the DIRECT LINK SECURITY MODE COMPLETE message is generated, the target UE shall pass this message to the lower layers for transmission along with the target UE's layer-2 ID for unicast communication and the initiating UE's layer-2 ID for unicast communication, NRPIK, NRPEK if applicable, KNRP-sess ID, the selected security algorithm as specified in 3GPP TS 33.536 [20] , and an indication of activation of the PC5 unicast signalling security protection for the PC5 unicast link with the new security context, if applicable.\nNOTE:\tThe DIRECT LINK SECURITY MODE COMPLETE message and further PC5 unicast signalling messages are integrity protected and ciphered (if applicable) at the lower layer using the new security context.\nIf the PC5 unicast link security mode control procedure was triggered during a PC5 unicast link re-keying procedure, the target UE shall provide to the lower layers an indication of activation of the PC5 unicast user plane security protection for the PC5 unicast link with the new security context, if applicable, along with the initiating UE's layer-2 ID for unicast communication and the target UE's layer-2 ID for unicast communication.\nUpon receiving a DIRECT LINK SECURITY MODE COMPLETE message, the initiating UE shall stop timer T5007. If the selected integrity protection algorithm is not the null integrity protection algorithm, the UE checks the integrity of the DIRECT LINK SECURITY MODE COMPLETE message. If the integrity check passes, the initiating UE shall then continue the procedure which triggered the PC5 unicast link security mode control procedure. If the selected integrity protection algorithm is the null integrity protection algorithm, the UE continues the procedure without checking the integrity protection.\nAfter receiving the DIRECT LINK SECURITY MODE COMPLETE message, the initiating UE shall delete the old security context it has for the target UE, if any.\nIf the DIRECT LINK SECURITY MODE COMMAND message cannot be accepted, the target UE shall send a DIRECT LINK SECURITY MODE REJECT message, and the target UE shall abort the ongoing procedure that triggered the initiation of the PC5 unicast link security mode control procedure unless the ongoing procedure is a PC5 unicast link establishment procedure and the Target user info is not included in the DIRECT LINK ESTABLISHMENT REQUEST message. The DIRECT LINK SECURITY MODE REJECT message contains a PC5 signalling protocol cause IE indicating one of the following cause values:\n#7:\tintegrity failure;\n#8:\tUE security capabilities mismatch;\n#9:\tLSB of KNRP-sess ID conflict;\n#10:\tUE PC5 unicast signalling security policy mismatch;\n#5\tlack of resources for PC5 unicast link; or\n#111:\tprotocol error, unspecified.\nIf this PC5 unicast link security mode control procedure is triggered during the PC5 unicast link establishment procedure and the implementation-specific maximum number of established NR PC5 unicast links has been reached, then the target UE shall send a DIRECT LINK SECURITY MODE REJECT message containing PC5 signalling protocol cause value #5 \"lack of resources for PC5 unicast link\".\nIf the DIRECT LINK SECURITY MODE COMMAND message cannot be accepted because the PC5 unicast link security mode control procedure was triggered during a PC5 unicast link establishment procedure, that the selected security algorithms in the DIRECT LINK SECURITY MODE COMMAND message included the null integrity protection algorithm and the target UE's PC5 unicast signalling integrity protection policy is set to \"signalling integrity protection required\", the target UE shall include PC5 signalling protocol cause #10 \"UE PC5 unicast signalling security policy mismatch\" in the DIRECT LINK SECURITY MODE REJECT message.\nIf the DIRECT LINK SECURITY MODE COMMAND message cannot be accepted because the PC5 unicast link security mode control procedure was triggered during a PC5 unicast link re-keying procedure, the integrity protection algorithm currently in use for the PC5 unicast link is different from the null integrity protection algorithm and the selected security algorithms in the DIRECT LINK SECURITY MODE COMMAND message include the null integrity protection algorithm, the target UE, the target UE shall include PC5 signalling protocol cause #10 \"UE PC5 unicast signalling security policy mismatch\" in the DIRECT LINK SECURITY MODE REJECT message.\nIf the target UE detects that the received UE security capabilities IE in the DIRECT LINK SECURITY MODE COMMAND message has been altered compared to the latest values that the target UE sent to the initiating UE in the DIRECT LINK ESTABLISHMENT REQUEST message or DIRECT LINK REKEYING REQUEST message, the target UE shall include PC5 signalling protocol cause #8 \"UE security capabilities mismatch\" in the DIRECT LINK SECURITY MODE REJECT message.\nIf the target UE detects that the LSB of KNRP-sess ID included in the DIRECT LINK SECURITY MODE COMMAND message are set to the same value as those received from another UE in response to the target UE's DIRECT LINK ESTABLISHMENT REQUEST message, the target UE shall include PC5 signalling protocol cause #9 \"LSB of KNRP-sess ID conflict\" in the DIRECT LINK SECURITY MODE REJECT message.\nAfter the DIRECT LINK SECURITY MODE REJECT message is generated, the target UE shall pass this message to the lower layers for transmission along with the initiating UE's layer-2 ID for unicast communication and the target UE's layer-2 ID for unicast communication.\nUpon receipt of the DIRECT LINK SECURITY MODE REJECT message, the initiating UE shall stop timer T5007, provide an indication to the lower layer of deactivation of the PC5 unicast security protection and deletion of security context for the PC5 unicast link, if applicable and:\na)\tif the PC5 signalling protocol cause IE in the DIRECT LINK SECURITY MODE REJECT message is set to #9 \"LSB of KNRP-sess ID conflict\", retransmit the DIRECT LINK SECURITY MODE COMMAND message with a different value for the LSB of KNRP-sess ID and restart timer T5007; or\nb)\tif the PC5 signalling protocol cause IE is set to the value other than #9 \"LSB of KNRP-sess ID conflict\", abort the ongoing procedure that triggered the initiation of the PC5 unicast link security mode control procedure.\na)\tTimer T5007 expires.\nThe initiating UE shall retransmit the DIRECT LINK SECURITY MODE COMMAND message and restart timer T5007. After reaching the maximum number of allowed retransmissions, the initiating UE shall abort the PC5 unicast link security mode control procedure, shall provide an indication to the lower layer of deactivation of the PC5 unicast security protection and deletion of security context for the PC5 unicast link, if applicable, and shall abort the ongoing procedure that triggered the initiation of the PC5 unicast link security mode control procedure.\nNOTE:\tThe maximum number of allowed retransmissions is UE implementation specific.\nb)\tThe need to use this PC5 unicast link no longer exists before the PC5 unicast link security mode control procedure is completed.\nThe initiating UE shall abort the procedure, shall provide an indication to the lower layer of deactivation of the PC5 unicast security protection and deletion of security context for the PC5 unicast link, if applicable, and shall abort the ongoing procedure that triggered the initiation of the PC5 unicast link security mode control procedure.\nThe PC5 unicast link keep-alive procedure is used to maintain a PC5 unicast link between two UEs, i.e., check that the link between the two UEs is still viable. The UE sending the DIRECT LINK KEEPALIVE REQUEST message is called the \"initiating UE\" and the other UE is called the \"target UE\".\nThe PC5 unicast link keep-alive procedure can be initiated by only one UE or both UEs in the established PC5 unicast link.\nNOTE:\tWhether the PC5 unicast link keep-alive procedure is initiated by only one UE or both UEs in the established PC5 unicast link is UE implementation specific.\nThe initiating UE shall meet the following pre-condition before initiating the PC5 unicast link keep-alive procedure:\na)\tthere is a PC5 unicast link between the initiating UE and the target UE.\nThe initiating UE shall manage a keep-alive timer T5003 and a keep-alive counter for the PC5 unicast link keep-alive procedure. Timer T5003 is used to trigger the periodic initiation of the PC5 unicast link keep-alive procedure. The UE shall start or restart timer T5003 whenever the UE receives a PC5 signalling message or PC5 user plane data from the target UE over this PC5 unicast link. The UE shall set the keep-alive counter to an initial value of zero after PC5 unicast link establishment.\nThe initiating UE shall initiate the PC5 unicast link keep-alive procedure when:\na)\ttimer T5003 for this link expires;\nb)\toptionally, a request from the lower layers to check the viability of the PC5 unicast link is received; or\nNOTE 1:\tWhether the lower layers can request the initiation of the PC5 unicast link keep-alive procedure, and what the triggers for the lower layers are to request the initiation of the PC5 unicast link keep-alive procedure, are UE implementation specific.\nc)\toptionally, a request from the upper layers to check the viability of the PC5 unicast link is received.\nNOTE 2:\tWhether the upper layers can request the initiation of the PC5 unicast link keep-alive procedure, and what the triggers for the upper layers are to request the initiation of the PC5 unicast link keep-alive procedure, are UE implementation specific.\nIn order to initiate the PC5 unicast link keep-alive procedure, the initiating UE shall stop timer T5003, if running, and shall create a DIRECT LINK KEEPALIVE REQUEST message. In this message, the initiating UE:\na)\tshall include the keep-alive counter for the PC5 unicast link; and\nb)\tmay include a maximum inactivity period to indicate the maximum inactivity period of the initiating UE over this PC5 unicast link.\nNOTE 3:\tThe value chosen for the maximum inactivity period of the initiating UE is UE implementation specific with the objective to minimize the number of keep-alive procedures as much as possible. It is desirable to have the maximum inactivity period value to be slightly higher than the value of keep-alive timer T5003.\nAfter the DIRECT LINK KEEPALIVE REQUEST message is generated, the initiating UE shall pass this message to the lower layers for transmission along with the initiating UE's layer-2 ID for unicast communication and the target UE's layer-2 ID for unicast communication, and start timer T5004. The UE shall not send a new DIRECT LINK KEEPALIVE REQUEST message to the same target UE while timer T5004 is running.\nFigure 6.1.2.8.2 illustrates the PC5 unicast link keep-alive procedure, which is a crucial aspect of maintaining network connectivity and ensuring data integrity. The figure depicts the process of sending a keep-alive packet from the sender to the receiver, with intermediate nodes involved in the transmission. The procedure includes the use of a timer to ensure timely acknowledgments from the receiver, as well as the potential for retransmission in case of failure. This figure is significant in understanding the mechanisms that prevent link degradation and ensure reliable communication in a network.\nFigure 6.1.2.8.2: PC5 unicast link keep-alive procedure\nUpon receipt of a DIRECT LINK KEEPALIVE REQUEST message, the target UE shall create a DIRECT LINK KEEPALIVE RESPONSE message. In this message, the target UE:\na)\tshall include the keep-alive counter set to the same value as that received in the DIRECT LINK KEEPALIVE REQUEST message.\nAfter the DIRECT LINK KEEPALIVE RESPONSE message is generated, the target UE shall pass this message to the lower layers for transmission along with the target UE's layer-2 ID for unicast communication and the initiating UE's layer-2 ID for unicast communication.\nIf a maximum inactivity period is included in the DIRECT LINK KEEPALIVE REQUEST message, the target UE shall stop T5005, if running, and start T5005 with its value set to the maximum inactivity period. The target UE shall restart T5005 whenever the target UE receives a PC5 signalling message or PC5 user plane data from the initiating UE over this PC5 unicast link.\nUpon receipt of a DIRECT LINK KEEPALIVE RESPONSE message, the initiating UE shall stop timer T5004, start timer T5003 and increment the keep-alive counter for the PC5 unicast link.\na)\tTimer T5004 expires.\nThe initiating UE shall retransmit the DIRECT LINK KEEPALIVE REQUEST message with the last used value of the keep-alive counter and restart timer T5004. After reaching the maximum number of allowed retransmissions, the initiating UE shall abort the PC5 unicast link keep-alive procedure and locally release the PC5 unicast link.\nNOTE:\tThe maximum number of allowed retransmissions is UE implementation specific.\nb)\tThe need to use this PC5 unicast link no longer exists before the PC5 unicast link keep-alive procedure is completed.\nThe initiating UE shall abort the PC5 unicast link keep-alive procedure and initiate a PC5 unicast link release procedure.\nc)\tThe initiating UE receives a DIRECT LINK KEEPALIVE RESPONSE message with a keep-alive counter value different from the value which the initiating UE had included in the last sent DIRECT LINK KEEPALIVE REQUEST message.\nThe initiating UE shall discard the DIRECT LINK KEEPALIVE RESPONSE message.\nd)\tThe initiating UE receives a PC5 signalling message other than a DIRECT LINK KEEPALIVE RESPONSE message or PC5 user plane data from the target UE over this PC5 unicast link while timer T5004 is running.\nThe initiating UE shall stop timer T5004, abort the PC5 unicast link keep-alive procedure, start timer T5003 and increment the keep-alive counter for the PC5 unicast link.\ne)\tThe initiating UE receives a DIRECT LINK KEEPALIVE RESPONSE message when T5004 is not running.\nThe initiating UE shall discard the DIRECT LINK KEEPALIVE RESPONSE message.\na)\tTimer T5005 expires.\nThe target UE shall:\n1)\tinitiate a PC5 unicast link keep-alive procedure to check the link; or\n2)\tinitiate the PC5 unicast link release procedure.\nWhether the UE chooses 1) or 2) is left to UE implementation.\nb)\tThe target UE receives a DIRECT LINK KEEPALIVE REQUEST message with a keep-alive counter value lower than the value which the target UE had included in the last sent DIRECT LINK KEEPALIVE RESPONSE message.\nThe target UE shall discard the DIRECT LINK KEEPALIVE REQUEST message.\nc)\tThe target UE receives a DIRECT LINK KEEPALIVE REQUEST message if there is a pending PC5 signalling message or PC5 user plane data to be sent to the initiating UE over this PC5 unicast link.\nThe target UE:\n1)\tshall pass this PC5 signalling message to the lower layers for transmission along with the target UE's layer-2 ID for unicast communication and the initiating UE's layer-2 ID for unicast communication, or perform the data transmission over PC5 unicast link as specified in clause 6.1.2.9; and\n2)\tshall consider transmission of this PC5 signalling message or PC5 user plane data to be an implicit DIRECT LINK KEEPALIVE RESPONSE message and skip generating a DIRECT LINK KEEPALIVE RESPONSE message. If a maximum inactivity period is included in the DIRECT LINK KEEPALIVE REQUEST message, the target UE shall stop T5005, if running, and start T5005 with its value set to the maximum inactivity period.\nWhen receiving user data from upper layers to be sent over PC5 unicast link to a specific UE, the transmitting UE shall determine the PC5 unicast link context corresponding to the application layer ID, and then shall tag each outgoing protocol data unit with the following information before passing it to the lower layers for transmission:\na)\ta layer-3 protocol data unit type (see 3GPP TS 38.323 [10]) set to:\n1)\tIP packet, if the V2X message contains IP data; or\n2)\tnon-IP packet, if the V2X message contains non-IP data;\nb)\tthe PC5 link identifier associated with the PC5 unicast link context;\nc)\toptionally, the source layer-2 ID set to the source layer-2 ID associated with the PC5 unicast link context;\nd)\toptionally, the destination layer-2 ID set to the destination layer-2 ID associated with the PC5 unicast link context; and\ne)\tthe PQFI set to the value corresponding to the V2X service identifier and the optional V2X application requirements according to the mapping rules specified in clause 5.2.3.\nThe procedures described for using NR-PC5 in clause 6.1.3.2.3 apply.\nThe purpose of the PC5 unicast link re-keying procedure is to derive a new KNRP-sess and, optionally, a new KNRP for an existing PC5 unicast link. The UE sending the DIRECT LINK REKEYING REQUEST message is called the \"initiating UE\" and the other UE is called the \"target UE\".\nNOTE:\tThere is no benefit in performing the PC5 unicast link re-keying procedure when using the null integrity protection algorithm, hence it is recommended not to trigger it when using the null integrity protection algorithm.\nThe initiating UE shall meet the following pre-condition before initiating the PC5 unicast link re-keying procedure:\na)\tthere is a PC5 unicast link between the initiating UE and the target UE; and\n1)\tif the session key KNRP-sess used to protect PC5 unicast link needs to be refreshed and neither timer T5007 nor T5008 are running;\n2)\tif the UE wants to refresh KNRP and neither timer T5007 nor T5008 are running; or\n3)\tif the lower layers indicate that a PC5 unicast link re-keying procedure needs to be performed.\nIn order to initiate the PC5 unicast link re-keying procedure, the initiating UE shall create a DIRECT LINK REKEYING REQUEST message. In this message, the initiating UE:\na)\tshall include the Key establishment information container IE if the null integrity protection algorithm is not in use;\nNOTE 1:\tThe key establishment information container is provided by upper layers.\nb)\tshall include a Nonce_1 IE set to the 128-bit nonce value generated by the initiating UE for the purpose of session key refresh over this PC5 unicast link if the null integrity protection algorithm is not in use;\nc)\tshall include its UE security capabilities indicating the list of algorithms that the initiating UE supports for the re-keying of this PC5 unicast link;\nd)\tshall include the MSB of KNRP-sess ID chosen by the initiating UE as specified in 3GPP TS 33.536 [20] if the null integrity protection algorithm is not in use; and\ne)\tmay include a Re-authentication indication if the initiating UE wants to derive a new KNRP.\nAfter the DIRECT LINK REKEYING REQUEST message is generated, the initiating UE shall pass this message to the lower layers for transmission along with the initiating UE's layer-2 ID for unicast communication and the target UE's layer-2 ID for unicast communication, and start timer T5008. The UE shall not send a new DIRECT LINK REKEYING REQUEST message to the same target UE while timer T5008 is running.\nNOTE 2:\tIn order to ensure successful PC5 unicast link re-keying, T5008 should be set to a value larger than the sum of T5006 and T5007.\nFigure 6.1.2.10.2 illustrates the PC5 unicast link re-keying procedure, which is a crucial step in maintaining secure communication between network nodes. The figure depicts the process of key exchange and re-keying between the sender and receiver, ensuring that data is encrypted and decrypted correctly. Key components include the initiator and responder, as well as the PC5 link, which facilitates the re-keying process. The figure highlights the importance of secure communication in maintaining data integrity and confidentiality in modern network infrastructure.\nFigure 6.1.2.10.2: PC5 unicast link re-keying procedure\nUpon receipt of a DIRECT LINK REKEYING REQUEST message, if the DIRECT LINK REKEYING REQUEST message includes a Re-authentication indication, the target UE shall derive a new KNRP. This may require performing one or more PC5 unicast link authentication procedures as specified in clause 6.1.2.6.\nNOTE:\tHow many times the PC5 unicast link authentication procedure needs to be performed to derive a new KNRP depends on the authentication method used.\nThen the target UE shall initiate a PC5 unicast link security mode control procedure as specified in in clause 6.1.2.7.\nUpon successful completion of the PC5 unicast link security mode control procedure, the target UE shall create a DIRECT LINK REKEYING RESPONSE message.\nAfter the DIRECT LINK REKEYING RESPONSE message is generated, the target UE shall pass this message to the lower layers for transmission along with the initiating UE's layer-2 ID for unicast communication and the target UE's layer-2 ID for unicast communication.\nUpon receipt of the DIRECT LINK REKEYING RESPONSE message, the initiating UE shall stop timer T5008 and check the integrity of the DIRECT LINK REKEYING RESPONSE message using the new NRPIK.\nAfter receiving the DIRECT LINK REKEYING RESPONSE message, the initiating UE shall delete the old security context it has for the target UE.\nThe following abnormal cases can be identified:\na)\tTimer T5008 expires.\nThe initiating UE shall retransmit the DIRECT LINK REKEYING REQUEST message and restart timer T5008. After reaching the maximum number of allowed retransmissions, the initiating UE shall abort the PC5 unicast link re-keying procedure, shall provide an indication of deactivation of the PC5 unicast security protection and deletion of security context for the PC5 unicast link to the lower layer, if applicable, along with the initiating UE's layer-2 ID for unicast communication and the target UE's layer-2 ID for unicast communication and may initiate the PC5 unicast link release procedure.\nNOTE:\tThe maximum number of allowed retransmissions is UE implementation specific.\nb)\tThe need to use this PC5 unicast link no longer exists before the PC5 unicast link re-keying procedure is completed.\nThe initiating UE shall abort the procedure and shall provide an indication of deactivation of the PC5 unicast security protection and deletion of security context for the PC5 unicast link to the lower layer, if applicable, along with the initiating UE's layer-2 ID for unicast communication and the target UE's layer-2 ID for unicast communication.\nc)\tFor the same PC5 unicast link, if the initiating UE receives a DIRECT LINK IDENTIFIER UPDATE REQUEST message after initiating the PC5 unicast link re-keying procedure, the initiating UE shall stop the timer T5008, abort the PC5 unicast link re-keying procedure and proceed with the PC5 unicast link identifier update procedure.\nThis clause describes the principles for the handling of PC5 unicast security contexts in the UE and the procedures used for the security protection of PC5 signalling messages exchanged between UEs over a PC5 unicast link. Based on the security policies of UEs, security protection for a PC5 unicast link involves integrity protection and ciphering of the PC5 signalling messages, and integrity protection and ciphering of PC5 user plane data. The use of integrity protection and ciphering using null key value or non-null key value over a PC5 unicast link is mandated (see 3GPP TS 33.536 [20]).\nThe signalling procedures for the control of PC5 unicast security are part of the PC5 signalling protocol and are described in detail in clause 6.1.2.\nNOTE:\tIt is recommended to set the UE PC5 unicast signalling integrity protection policy to \"signalling integrity protection required\" in order to guarantee security protection over PC5. In this clause, for the ease of description, it is assumed that integrity protection and ciphering are used, unless explicitly indicated otherwise. Operation of a PC5 unicast link without integrity protection or ciphering is achieved by configuring the UE so that it always selects the \"null integrity protection algorithm\", 5G-IA0, or the \"null ciphering algorithm\", 5G-EA0.\nThe security parameters for authentication, integrity protection and ciphering are tied together in a PC5 unicast security context and identified by a KNRP-sess identifier (KNRP-sess ID). The relationship between the security parameters is defined in 3GPP TS 33.536 [20]. The KNRP-sess ID is self-assigned by the UEs.\nBefore security can be established by using non-null security protection algorithms, the UEs establishing a PC5 unicast link need to establish a PC5 unicast security context. The PC5 unicast security context is created as the result of a PC5 unicast link authentication procedure and PC5 unicast link security mode control procedure between the UEs.\nThe PC5 unicast security context is taken into use by the UEs when one of the UEs initiates a PC5 unicast link security mode control procedure.\nThe creation of a security context also results in the establishment of a key KNRP and its identifier KNRP ID at the UEs.\nThe PC5 unicast security context can be created using KNRP when a new PC5 unicast link is established without executing a new PC5 unicast link authentication procedure (see clause 6.1.2.11.2.2). For this purpose, the DIRECT LINK ESTABLISHMENT REQUEST message contains a KNRP ID indicating the PC5 unicast security context.\nSecure exchange of PC5 signalling messages over a PC5 unicast link is established during the PC5 unicast link establishment procedure by initiating a PC5 unicast link security mode control procedure. After successful completion of the PC5 unicast link security mode control procedure, all PC5 signalling messages exchanged between the UEs are sent integrity protected using the PC5 unicast security algorithms, and except for the DIRECT LINK SECURITY MODE COMMAND message, all PC5 signalling messages exchanged between the UEs are sent ciphered using the PC5 unicast security algorithms. The security exchange of PC5 signalling messages is maintained for the lifetime of the PC5 unicast link.\nWhen one of the UEs using the PC5 unicast link initiates a PC5 unicast link re-keying procedure to create a new PC5 unicast security context, the PC5 signalling messages exchanged during the PC5 unicast link authentication procedure, if any, are integrity protected and ciphered using the old PC5 unicast security context, i.e. the PC5 unicast security context that was in use before the start of the PC5 unicast link re-keying procedure.\nBoth UEs shall continue to use the old PC5 unicast security context until the UE which has received the DIRECT LINK REKEYING REQUEST message initiates a PC5 unicast link security mode control procedure. The UE shall send the DIRECT LINK SECURITY MODE COMMAND message integrity protected with the new PC5 unicast security context, but unciphered. When the peer UE responds with a DIRECT LINK SECURITY MODE COMPLETE message, it shall send the message integrity protected and ciphered with the new PC5 unicast security context.\nIf the signalling integrity protection is not activated for PC5 unicast link, all PC5 signalling messages are processed by the UE without integrity protection.\nIf the signalling non-null integrity protection is activated for PC5 unicast link, except the messages listed below, the UE shall not process any of the PC5 signalling messages that are not integrity protected:\na)\tDIRECT LINK ESTABLISHMENT REQUEST message;\nb)\tDIRECT LINK ESTABLISHMENT REJECT message;\nc)\tDIRECT LINK AUTHENTICATION REQUEST message;\nd)\tDIRECT LINK AUTHENTICATION RESPONSE message;\ne)\tDIRECT LINK AUTHENTICATION REJECT message;\nf)\tDIRECT LINK SECURITY MODE REJECT message; and\ng)\tDIRECT LINK AUTHENTICATION FAILURE message.\nNOTE:\tThese messages are accepted by the receiving UE without protection, as in certain situations they are sent by the peer UE before security can be activated.\nOnce the secure exchange of PC5 signalling messages has been established, the receiving UE shall not process any PC5 signalling message that does not successfully pass the integrity check. The DIRECT LINK SECURITY MODE COMMAND message shall be processed as specified in clause 6.1.2.7.3. If the signalling non-null ciphering and integrity protections are established and any PC5 signalling message that is received as not integrity protected and not ciphered even though the secure exchange of PC5 signalling messages has been established, then the receiving UE shall discard this message.\nIn order to establish a PC5 QoS flow establishment over PC5 unicast link, the UE shall derive the PC5 QoS parameters based on the V2X application requirements provided by the upper layers (if available) and the V2X service identifier(s) (e.g. PSID or ITS-AID) according to the PC5 QoS mapping rules defined in clause 5.2.3. The UE shall create the PC5 QoS flow(s) based on the derived PC5 QoS parameters. For each PC5 QoS flow to be created, the UE shall perform the following operations:\na)\tself-assign a PQFI;\nb)\tcreate a PC5 QoS flow context, which contains:\n1)\tthe PQFI;\n2)\tthe V2X service identifier(s); and\n3)\tthe derived PC5 QoS parameters;\nc)\tcreate a new PC5 QoS rule which contains:\n1)\ta PC5 QoS rule identifier;\n2)\tthe PQFI;\n3)\ta set of packet filters; and\n4)\ta precedence value; and\nd)\tpass the following parameters to the lower layers:\n1)\tthe PQFI;\n2)\tthe PC5 QoS parameters;\n3)\tthe PC5 link identifier;\n4)\toptionally, the source and destination layer-2 IDs; and\n5)\toptionally, the NR Tx profile corresponding to the initial signalling of the PC5 unicast link establishment and that is associated with the V2X service identifier (see clause 5.2.3).\nTwo types of packet filters are supported for V2X communication over PC5, i.e. the IP packet filter set and the V2X packet filter set. A PC5 QoS Rule contains either the IP packet filter set or the V2X packet filter set.\nThe IP packet filter set is defined as content of the packet filter contents field specified in 3GPP TS 24.501 [6] figure 9.11.4.13.4 and table 9.11.4.13.1.\nThe V2X packet filter set shall support packet filters based on at least any combination of:\na)\tV2X Service identifier (e.g. PSID or ITS-AID);\nb)\tthe source layer-2 ID and the destination layer-2 ID; and\nc)\tapplication layer ID (e.g. Station ID).\nThe UE shall also pass the one or more V2X frequencies associated with the V2X service identifier and the communication mode which is set to unicast mode for the V2X service identifier to the lower layers, if:\na)\tthe UE is configured with V2X service identifier to V2X frequency mapping rules for V2X communication over PC5 as specified in clause 5.2.3; and\nb)\tthere is one or more V2X frequencies associated with the V2X service identifier in the current geographical area.\nWhen service data or request from the upper layers is received, the UE determines if there is any existing PC5 QoS flow(s) matching the service data or request, i.e. based on the PC5 QoS rules for the existing PC5 QoS flow(s).\nIf there is no PC5 QoS rules for the existing PC5 QoS flow(s) matching the service data or request, the UE shall derive the PC5 QoS parameters based on the V2X application requirements provided by the upper layers (if available) and the V2X service identifier(s) (e.g. PSID or ITS-AID) according to the PC5 QoS mapping rules defined in clause 5.2.3 and shall perform the following:\na)\tif there is no existing PC5 QoS flow that fulfils the derived PC5 QoS parameters, then the UE shall create a new PC5 QoS flow as specified in clause 6.1.2.12;\nb)\tif there is an existing PC5 QoS flow that fulfils the derived PC5 QoS parameters, then the UE shall update the PC5 packet filter set in the PC5 QoS rule of this PC5 QoS flow, e.g. add the new packet filter in the PC5 QoS rule of this existing PC5 QoS flow; and\nc)\tthe UE shall use the new PC5 QoS flow created as described in bullet a) or the existing PC5 QoS flow with the updated PC5 QoS rules as described in bullet b) to perform the transmission of V2X communication over PC5 as specified in clause 6.1.2.9.\nIf there is a PC5 QoS rule for the existing PC5 QoS flow matching the service data or request, the UE shall use this existing PC5 QoS flow to perform transmission of V2X communication over PC5 as specified in clause 6.1.2.9.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.1.3\tBroadcast mode communication over PC5",
                            "text_content": "This clause describes the V2X communication over PC5 reference point in broadcast mode operation. The UE is configured with the related information as described in clause 5.2.3.\nWhen the upper layers request the UE to send a V2X message of a V2X service identified by a V2X service identifier using V2X communication over PC5, the request from the upper layers includes:\na)\tthe V2X message;\nb)\tthe V2X service identifier of the V2X service for the V2X message;\nc)\tthe type of data in the V2X message (i.e. IP or non-IP);\nd)\tif the V2X message contains non-IP data, the V2X message family (see clause 9.2) of data in the V2X message;\ne)\toptionally the communication mode which is set to broadcast mode; and\nf)\toptionally the V2X application requirements (e.g. priority requirement, reliability requirement, delay requirement).\nUpon a request from upper layers to send a V2X message of a V2X service identified by a V2X service identifier using V2X communication over PC5, if:\na)\tthe UE is configured with V2X service identifier to V2X frequency mapping rules for V2X communication over PC5 as specified in clause 5.2.3; and\nb)\tthere is one or more V2X frequencies associated with the V2X service identifier of the V2X service for the V2X message in the current geographical area,\nthen the UE passes the one or more V2X frequencies associated with the V2X service identifier of the V2X service and the communication mode which is set to broadcast mode for the V2X message to the lower layers.\nThen, if any of the following conditions are met:\na)\tthe following conditions are met:\n1)\tthe UE is served by NR or served by E-UTRA for NR-PC5 V2X communication;\n2)\tthe UE intends to use the radio resources (i.e. carrier frequency) provided by a serving cell;\n3)\tthe registered PLMN is in the list of PLMNs in which the UE is authorized to use V2X communication over PC5 when the UE is served by NR or served by E-UTRA for V2X communication over PC5 as specified in clause 5.2.3; and\n4)\tthe V2X service identifier of the V2X service is included in the list of V2X services authorized for V2X communication over PC5 as specified in clause 5.2.3 or the UE is configured with a default destination layer-2 ID for V2X communication over PC5 as specified in clause 5.2.3;\nb)\tthe following conditions are met:\n1)\tthe UE is:\ni)\tnot served by NR and not served by E-UTRA for V2X communication over PC5;\nii)\tin limited service state as specified in 3GPP TS 23.122 [2], if the reason for the UE being in limited service state is one of the following:\nA)\tthe UE is unable to find a suitable cell in the selected PLMN as specified in 3GPP TS 38.304 [9];\nB)\tthe UE received a REGISTRATION REJECT message or a SERVICE REJECT message with the 5GMM cause #11 \"PLMN not allowed\" as specified in 3GPP TS 24.501 [6]; or\nC)\tthe UE received a REGISTRATION REJECT message or a SERVICE REJECT message with the 5GMM cause #7 \"5GS services not allowed\" as specified in 3GPP TS 24.501 [6]; or\niii)\tin limited service state as specified in 3GPP TS 23.122 [2] for reasons other than A), B) or C) above, and located in a geographical area for which the UE is provisioned with \"non-operator managed\" radio parameters as specified in clause 5.2.3;\n2)\tthe UE is authorized to use V2X communication over PC5 when the UE is not served by NR and not served by E-UTRA for V2X communication as specified in clause 5.2.3; and\n3)\tthe V2X service identifier of the V2X service is included in the list of V2X services authorized for V2X communication over PC5 as specified in clause 5.2.3 or the UE is configured with a default destination layer-2 ID for V2X communication over PC5 as specified in clause 5.2.3;\nthen the UE shall proceed as specified in clause 6.1.3.2.1.2, else the UE shall not perform transmission of V2X communication over PC5.\nWhen determining if any existing PC5 QoS flow match the request from upper layers, UE shall proceeds as follows:\na)\taccording to the PC5 QoS mapping rules specified in clause 5.2.3, the UE shall use the PC5 QoS parameters corresponding to the V2X service identifier and optionally V2X application requirements;\nb)\taccording to the V2X service identifier to destination layer-2 ID for broadcast mapping rules specified in clause 5.2.3, the UE shall use the destination layer-2 ID corresponding to the V2X service identifier;\nc)\tif there is no existing context for the destination layer-2 ID, then:\n1)\tbuild a new context for the destination layer-2 ID;\n2)\tself-assign a new source layer-2 ID; and\n3)\tpass the source layer-2 ID and the destination layer-2 ID to lower layers.\nd)\tif in the context for the destination layer-2 ID, there is no PC5 QoS rule for the existing PC5 QoS flow(s) matching the service data or request, the UE shall derive the PC5 QoS parameters based on the V2X application requirements provided by the upper layers (if available) and the V2X service identifier(s) (e.g. PSID or ITS-AID) according to the PC5 QoS mapping rules defined in clause 5.2.3 and shall perform the following::\n1)\tif there is no existing PC5 QoS flow that fulfils the derived PC5 QoS parameters, then the UE shall create a new PC5 QoS flow by performing the following operations:\ni)\tself-assign a new PQFI;\nii)\tcreate a new PC5 QoS flow context which contains:\n-\tthe PQFI;\n-\tthe V2X service identifier(s); and;\n-\tthe derived PC5 QoS parameters;\niii)\tcreate a new PC5 QoS rule which contains:\n-\ta PC5 QoS rule identifier;\n-\tthe PQFI;\n-\ta set of packet filters; and\n-\ta precedence value; and\niv)\tpass the following parameters to the lower layers:\n-\tthe PQFI;\n-\tthe PC5 QoS parameters;\n-\tthe source layer-2 ID and the destination layer-2 ID;\n-\tthe V2X frequency information based on the configuration parameters described in clause 5.2.3; and\n-\tthe NR Tx Profile corresponding to the V2X service identifier, if all the V2X service identifier(s) for the given destination layer-2 ID have NR Tx profiles available, as determined for the respective V2X service identifier based on the configuration parameters and conditions described in clause 5.2.3;\nNOTE:\tWhen the PC5 DRX operation is needed based on the provided NR Tx Profile, the lower layers use PC5 QoS parameters to determine the PC5 DRX parameter values (see 3GPP TS 38.300 [8]) for transmission operation over PC5 reference point.\n2)\tif there is an existing PC5 QoS flow that fulfils the derived PC5 QoS parameters, then the UE shall update the PC5 packet filter set in the PC5 QoS rule of this PC5 QoS flow, e.g. add the new packet filter in the PC5 QoS rule of this existing PC5 QoS flow; and\n3)\tthe UE shall use the new PC5 QoS flow created as described in bullet 1) or the existing PC5 QoS flow with the updated PC5 QoS rules as described in bullet 2) to perform the transmission of V2X communication over PC5 as specified in clause 6.1.3.2.2; and\ne)\tif in the context for the destination layer-2 ID, there is a PC5 QoS rule for the existing PC5 QoS flow matching the service data or request, the UE shall use this existing PC5 QoS flow to perform transmission of V2X communication over PC5 as specified in clause 6.1.3.2.2.\nTwo types of packet filters are supported for V2X communication over PC5, i.e. the IP packet filter set and the V2X packet filter set. A PC5 QoS Rule contains either the IP packet filter set or the V2X packet filter set.\nThe IP packet filter set is defined as content of the packet filter contents field specified in 3GPP TS 24.501 [6] figure 9.11.4.13.4 and table 9.11.4.13.1.\nThe V2X packet filter set shall support packet filters based on at least any combination of:\n-\tV2X service identifier (e.g. PSID or ITS-AID);\n-\tthe source layer-2 ID and the destination layer-2 ID; and\n-\tApplication Layer ID (e.g. Station ID);\nThe UE shall include the V2X message in a protocol data unit with the following parameters:\na)\ta layer-3 protocol data unit type (see 3GPP TS 38.323 [10]) set to:\n1)\tIP packet, if the V2X message contains IP data; or\n2)\tnon-IP packet, if the V2X message contains non-IP data;\nb)\tthe source layer-2 ID set to the layer-2 ID self-assigned by the UE for V2X communication over PC5;\nc)\tthe destination layer-2 ID set to:\n1)\tthe destination layer-2 ID associated with the V2X service identifier of the V2X service in this list of V2X services authorized for V2X communication over PC5 as specified in clause 5.2.3, if the V2X service identifier of the V2X service is included in the list of V2X services authorized for V2X communication over PC5 as specified in clause 5.2.3; or\n2)\tthe default destination layer-2 ID configured to the UE for V2X communication over PC5 as specified in clause 5.2.3, if the V2X service identifier of the V2X service is not included in the list of V2X services authorized for V2X communication over PC5 and the UE is configured with a default destination layer-2 ID for V2X communication over PC5;\nd)\tif the V2X message contains non-IP data, an indication to set the non-IP type field of the non-IP type PDU to the value corresponding to the V2X message family (see clause 9.2 and clause 9.3) used by the V2X service as indicated by upper layers;\ne)\tif the V2X message contains IP data, the source IP address set to the source IP address self-assigned by the UE for V2X communication over PC5;\nf)\tthe PQFI set to the value corresponding to the PC5 QoS Rules as specified in clause 6.1.3.2.1;\ng)\tif E-UTRA-PC5 is used for V2X communication over PC5, the UE is configured with V2X service identifier to Tx Profile mapping rules for V2X communication over PC5 as specified in clause 5.2.3, the Tx Profile associated with the V2X service identifier as specified in clause 5.2.3; and\nh)\tif NR-PC5 is used for V2X communication over PC5, the UE is configured with V2X service identifier to NR Tx Profile mapping rules for V2X communication over PC5 as specified in clause 5.2.3 and all the V2X service identifier(s) for the given destination layer-2 ID have NR Tx profiles available, the NR Tx Profile associated with the V2X service identifier as specified in clause 5.2.3;\nthen UE shall request radio resources for V2X communication over PC5 as specified in 3GPP TS 38.300 [8], and pass the V2X message on the PC5 QoS Flow identified by the PQFI to lower layers for transmission. The PC5 QoS Rules corresponding to the PQFIs map V2X messages with the same V2X service identifier and with the same PC5 QoS parameters to the same PC5 QoS Flow, and apply PQFI to V2X messages;\nIf the UE is camped on a serving cell indicating that V2X communication over PC5 is supported by the network, but not broadcasting any carrier frequencies and radio resources for V2X communication over PC5 as specified in 3GPP TS 38.331 [11], the UE shall request radio resources for V2X communication over PC5 as specified in 3GPP TS 24.501 [6].\nIf the UE has an emergency PDN connection, the UE shall send an indication to the lower layers to prioritize transmission over the emergency PDN connection as compared to transmission of V2X communication over PC5.\nWhen the UE is not served by NR and not served by E-UTRA for V2X communication and is authorized to use V2X communication over PC5, the UE shall identify the RAT to be used for V2X communication over PC5 according to the list of RATs in which the UE is authorized to use V2X communication over PC5. If both E-UTRA-PC5 and NR-PC5 for V2X are authorized to the UE for V2X communication over PC5, the UE selects a RAT used for V2X communication over PC5 according to local policy. After identifying E-UTRA-PC5 to be used for V2X communication over PC5, the UE performs the procedure defined in clause 6.1.2.3 of 3GPP TS 24. 386  [5]. After identifying NR-PC5 to be used for V2X communication over PC5, the UE shall select the corresponding radio parameters to be used for V2X communication over PC5 as follows:\na)\tif the UE can determine itself located in a geographical area, and the UE is provisioned with radio parameters for the geographical area, the UE shall select the radio parameters associated with that geographical area; or\nb)\tin all other cases, the UE shall not initiate V2X communication over PC5.\nIt is out of scope of the present specification to define how the UE can locate itself in a specific geographical area. When the UE is in coverage of a 3GPP RAT it can for example use information derived from the serving PLMN. When the UE is not in coverage of a 3GPP RAT it can use other techniques, e.g. global navigation satellite system (GNSS). The UE shall not consider user provided location as a valid input to locate itself in a specific geographical area.\nIf the UE intends to use \"non-operator managed\" radio parameters as specified in clause 5.2.3, the UE shall initiate V2X communication over PC5 with the selected radio parameters.\nIf the UE intends to use \"operator managed\" radio parameters as specified in clause 5.2.3, before initiating V2X communication over PC5, the UE shall check with lower layers whether the selected radio parameters can be used in the current location without causing interference to other cells as specified in 3GPP TS 38.331 [11], and:\na)\tif the lower layers indicate that the usage would not cause any interference, the UE shall initiate V2X communication over PC5; or\nNOTE:\tIf the lower layers find that there exists a cell operating the provisioned radio resources (i.e., carrier frequency), and the cell belongs to the registered PLMN or a PLMN equivalent to the registered PLMN, and the UE is authorized for V2X communication over PC5 in this PLMN, the UE can use the radio parameters indicated by the cell as specified in 3GPP TS 38.331 [11].\nb)\telse if the lower layers report that one or more PLMNs operate in the provisioned radio resources (i.e. carrier frequency) then:\n1)\tif the following conditions are met:\ni)\tnone of the PLMNs reported by the lower layers is the registered PLMN or equivalent to the registered PLMN;\nii)\tat least one of the PLMNs reported by the lower layers is in the list of authorized PLMNs for V2X communication over PC5 and provides radio resources for V2X communication over PC5 as specified in 3GPP TS 38.331 [11]; and\niii)\tthe UE does not have an emergency PDU session;\nthen the UE shall:\ni)\tif in 5GMM-IDLE mode, perform PLMN selection triggered by V2X communication over PC5 as specified in 3GPP TS 23.122 [2]; or\nii)\telse if in 5GMM-CONNECTED mode, either:\nA)\tperform a Deregistration procedure as specified in 3GPP TS 24.501 [6] and then perform PLMN selection triggered by V2X communication over PC5 as specified in 3GPP TS 23.122 [2]; or\nB)\tnot initiate V2X communication over PC5.\nWhether the UE performs i) or ii) above is left up to UE implementation; or\n2)\telse the UE shall not initiate V2X communication over PC5.\nIf the registration to the selected PLMN is successful, the UE shall proceed with the procedure to initiate V2X communication over PC5 as specified in clause 6.1.3.2.1.\nIf the UE is performing V2X communication over PC5 using radio parameters associated with a geographical area and moves out of that geographical area, the UE shall stop performing V2X communication over PC5 and then:\na)\tif the UE is not served by NR and not served by E-UTRA for V2X communication over PC5 or the UE intends to use radio resources for V2X communication over PC5 other than those operated by the serving cell, the UE shall select appropriate radio parameters for the new geographical area as specified above; or\nb)\tif the UE is served by NR or served by E-UTRA for V2X communication over PC5 and intends to use radio resources for V2X communication over PC5 operated by the serving cell, the UE shall proceed with the procedure to initiate V2X communication over PC5 when served by NR or served by E-UTRA for V2X communication over PC5.\nUpon initiating transmission of V2X communication over PC5, if:\na)\tthe V2X service identifier of a V2X service requesting transmission of V2X communication over PC5 is in the list of of V2X services which require privacy for V2X communication over PC5 as specified in clause 5.2.3; and\nb)\tthe UE is located in a geographical area in which this V2X service requires privacy for V2X communication over PC5 as specified in clause 5.2.3, or the UE is not provisioned any geographical areas in which this V2X services requires privacy for V2X communication over PC5,\nthen the UE shall proceed as follows:\na)\tif timer T5020 is not running, start timer T5020 and set its timer value as the privacy timer value as specified in clause 5.2.3;\nb)\tupon:\n1)\tgetting an indication from upper layers that the application layer identifier has been changed; or\n2)\ttimer T5020 expiry,\nthen:\n1)\tchange the value of the source layer-2 ID self-assigned by the UE for the V2X communication over PC5;\n2)\tif the V2X message contains IP data, change the value of the source IP address self-assigned by the UE for V2X communication over PC5;\n3)\tprovide an indication to upper layers that the source layer-2 ID and/or the source IP address are changed;\n4)\tpass the changed source layer-2 ID and destination layer-2 ID, along with the corresponding PQFI down to the lower layer;\n5)\trestart timer T5020; and\n6)\tupon stopping transmission of the V2X communication over PC5, stop timer T5020.\nThe UE may be configured by upper layers with one or more destination layer-2 ID(s) for reception of V2X messages over PC5. The receiving UE shall determine the PC5 QoS parameters for this broadcast V2X service in the same way described in clause 6.1.3.2.1.2 and shall determine the NR Tx Profile as described in clause 5.2.3, and shall provide:\na)\tthe PC5 QoS parameters;\nb)\tthe NR Tx Profile corresponding to the V2X service identifier, if all the V2X service identifier(s) for the given destination layer-2 ID have NR Tx profiles available;\nc)\tthe destination layer-2 ID(s); and\nd)\tthe V2X frequency information based on the configuration parameters described in clause 5.2.3;\nto lower layers. When the UE derives new PC5 QoS parameters for a destination layer-2 ID that has been provided to lower layers (e.g., due to a change in application requirements), the UE shall provide the new PC5 QoS parameters for that destination layer-2 ID to lower layers. For each received protocol data unit over PC5, the receiving UE shall check if the destination layer-2 ID of the received protocol data unit matches one of the configured destination Layer-2 IDs. If yes, the UE shall then check whether the protocol data unit type as defined 3GPP TS 38.323 [10] provided by the lower layers for the received packet is set to IP packet or non-IP packet, and pass the protocol data unit to the corresponding upper layer entity.\nNOTE:\tWhen the PC5 DRX operation is needed based on the provided NR Tx Profile if any, the lower layers use PC5 QoS parameters and the destination layer-2 ID(s) to determine the PC5 DRX parameter values (see 3GPP TS 38.300 [8]) for reception operation over PC5 reference point.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.1.4\tGroupcast mode communication over PC5",
                            "text_content": "This clause describes the V2X communication over PC5 reference point in groupcast mode operation. The UE is configured with the related information as described in clause 5.2.3.\nThe requirements for groupcast mode V2X communication over PC5 is the same as described in clause 6.1.3.2.1.1, with the following additions:\na)\tWhen the upper layers request the UE to send a V2X message of a V2X service identified by a V2X service identifier using V2X communication over PC5, then the request from the upper layers may include:\n1)\tthe group identifier information (i.e. an application-layer V2X group identifier);\n2)\tthe group size and the member IDs;\n3)\tthe range requirement; or\n4)\tthe communication mode which is set to groupcast mode.\nThe PC5 QoS flow match and establishment for groupcast mode V2X communication over PC5 is the same as described in clause 6.1.3.2.1.2, with the following modifications:\na)\tThe UE shall determine the destination layer-2 ID as:\n1)\tif no group identifier information is provided, then according to the mapping rules specified in clause 5.2.3, the UE shall use the destination layer-2 ID corresponding to the V2X service identifier;\n2)\tif group identifier information is provided and there is a context for the group identifier information, then UE shall use the destination layer-2 ID in the context for the group identifier information; and\n3)\tif group identifier information is provided and there is no context for the group identifier information, then the UE shall:\ni)\tuse the group identifier as the input to the SHA-256 hashing algorithm as specified in ISO/IEC 10118-3:2018 [23]; and\nii)\tuse the 24 least significant bits of the 256 bits of the output as destination layer-2 ID; and\nNOTE:\tSHA-256 hashing algorithm is pre-configured in the ME.\nb)\tIf there is no existing context for the destination layer-2 ID and optional group identifier, the UE shall proceed as:\n1)\tto establish a new context for the destination layer-2 ID and optional group identifier;\n2)\tself-assign a new source layer-2 ID; and\n3)\tto pass the source/destination layer-2 IDs, optional group size and optional member IDs to lower layers.\nThe transmission of groupcast mode V2X communication over PC5 is same as described in clause 6.1.3.2.2, with the following additions:\na)\tIf group identifier is provided, then the destination layer-2 ID shall be set to the destination layer-2 ID in the context for the group identifier as specified in clause 6.1.4.2.1.2.\nThe procedures described for using NR-PC5 in clause 6.1.3.2.3 apply.\nThe procedures described in clause 6.1.3.2.4 apply with using the privacy timer T5030 for groupcast.\nThe reception of groupcast mode V2X communication over PC5 is the same as described in clause 6.1.3.3, with the following additions:\na)\tBesides the configured destination layer-2 ID(s) for reception of V2X messages over PC5, the UE shall also derive the destination layer-2 ID(s) based on group identifier(s) if provided by upper layers as specified in clause 6.1.4.2.1.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.2\tV2X communication over Uu",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.2.1\tGeneral",
                            "text_content": "This clause describes the procedures at the UE and the V2X application server, for V2X communication over Uu.\nThere are no additional security or privacy procedures of V2X communication over Uu beyond those specified in 3GPP TS 33.501 [21] for Uu connectivity with 5GCN.\nBoth IP based and non-IP based V2X communication over Uu are supported.\nV2X messages carried over Uu are sent or received over unicast only in this release of the specification. Furthermore, V2X messages are carried over Uu using user data over user plane. For this, the UE first performs the UE-requested PDU session establishment procedure to establish user-plane resouces as specified in 3GPP TS 24.501 [6].\nProcedures for V2X communication over Uu for V2X services not identified by a V2X service identifier are out of scope of the present version of the present specification.\nNOTE:\tThe upper layers are responsible for re-assembly of V2X messages and that is out of scope of 3GPP.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.2\tTransmission of V2X communication over Uu from UE to V2X application server",
                            "text_content": "The upper layers can request the UE to send a V2X message of a V2X service identified by a V2X service identifier using V2X communication over Uu. The request from the upper layers includes:\na)\tthe V2X message;\nb)\tthe V2X service identifier of the V2X service for the V2X message;\nc)\tthe type of data in the V2X message (IP or non-IP); and\nd)\tif the V2X message contains non-IP data, the V2X message family (see clause 9.2) of data in the V2X message.\nUpon a request from upper layers to send a V2X message of a V2X service identified by a V2X service identifier using V2X communication over Uu:\na)\tif the registered PLMN of the UE is not in the list of PLMNs in which the UE is configured to use V2X communication over Uu as specified in clause 5.2.4, the UE shall determine that the transmission of V2X communication over Uu from UE to V2X application server is not configured and shall not continue with the rest of the steps; and\nb)\tif the V2X service identifier is included in the list of V2X service identifier to PDU session parameters mapping rules specified in clause 5.2.4;\nthen:\n1)\tthe UE shall determine the mapping rule in the list of V2X service identifier to PDU session parameters mapping rules specified in clause 5.2.4, such that the mapping rule contains the V2X service identifier provided by upper layers;\n2)\tthe UE shall consider the PDU session type, the SSC mode (if indicated in determined mapping rule), an S-NSSAI (if indicated in determined mapping rule) and a DNN (if indicated in determined mapping rule) indicated in the determined mapping rule as the UE local configuration and request information of the PDU session via which to send a PDU according to 3GPP TS 24.526 [22]. The UE shall use the transport layer protocol, if indicated in the determined mapping rule, to transport the V2X message;\n3)\tif the PDU session is of \"IPv4\", \"IPv6\" or \"IPv4v6\" PDU session type:\ni)\tif the V2X service identifier is included in the list of V2X service identifier to V2X application server address mapping rules as specified in clause 5.2.4, then:\nA)\tthe UE shall discover the V2X application server address for uplink transport as described in clause 6.2.6. If the V2X application server address cannot be discovered, the UE shall determine that the transmission of V2X communication over Uu from UE to V2X application server is not possible and shall not continue with the rest of the steps;\nB)\tif UDP is to be used for the determined V2X application server address, the UE shall generate a UDP message as described in IETF RFC 768 [14]. In the UDP message, the UE shall include the V2X message provided by upper layers in the data octets field. The UE shall send the UDP message to the determined V2X application server address; and\nC)\tif TCP is to be used for the determined V2X application server address:\n1)\tif a TCP connection with the determined V2X application server address is not established yet, the UE shall establish a TCP connection with the determined V2X application server address; and\n2)\tthe UE shall generate one or more TCP message(s) as described in IETF RFC 793 [25]. In the one or more TCP message(s), the UE shall include the V2X message provided by upper layers in the data octets filed. The UE shall send the one or more TCP message(s) to the determined V2X application server address via the TCP connection; and\n4)\tif the PDU session is of \"Unstructured\" PDU session type and the type of data in the V2X message is non-IP, the UE shall generate a UDP message as described in IETF RFC 768 [14]. In the UDP message, the UE shall encapsulate the V2X message provided by upper layers in the data octets field. The UE shall send the UDP message to the determined V2X application server address.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.3\tReception of V2X communication over Uu from UE to V2X application server",
                            "text_content": "If the V2X application server is configured with one or more UDP ports for uplink transport or one or more TCP ports for bidirectional transport, of V2X message(s) of V2X service(s) identified by V2X service identifier(s) using the V2X communication over Uu as specified in clause 6.2.7:\n1)\tif the V2X application server is configured with a UDP port for uplink transport, the V2X application server shall extract a V2X message of the V2X service from a UDP message received on a local IP address and a UDP port; and\n2)\tif the V2X application server is configured with a TCP port for bidirectional transport, the V2X application server shall listen for incoming TCP connection(s) on a local IP address and the TCP port, shall accept the incoming TCP connection(s), shall receive one or more TCP message(s)via the accepted TCP connection(s) and shall extract a V2X message of the V2X service from the received one or more TCP message(s).\nIf the V2X application server is configured to handle data of \"Unstructured\" PDU Session type for transport of V2X message(s) of V2X service(s) identified by V2X service identifier(s) using V2X communication over Uu as specified in clause 6.2.7, the V2X application server shall receive one or more UDP message(s) as data of a point-to-point tunnel established over N6 and shall extract a V2X message and a V2X message family (if the V2X message is non-IP based) from the received UDP message.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.4\tTransmission of V2X communication over Uu from V2X application server to UE",
                            "text_content": "The V2X application server shall be configured with UDP port(s), TCP port(s) or any combination of them for transport of the V2X communication over Uu to the UE.\nIf the V2X application server supports V2X messages of IP type of data and of non-IP type of data, then the V2X application server shall be configured with different UDP ports or TCP ports for V2X messages of different types of data.\nIf the V2X application server supports V2X messages of several V2X message families, then the V2X application server shall be configured with different UDP ports or TCP ports for V2X messages of different V2X message families.\nIf the V2X application server determines to use UDP for transmission of the V2X message identified by a V2X service identifier, the V2X application server shall generate a UDP message.\nIn order to tranport a V2X message of a V2X service identified by a V2X service identifier via unicast, if the V2X message is of \"Unstructured\" PDU Session type, then the V2X application server shall encapsulate the V2X message into IP type data. In the UDP message, the V2X application server:\na)\tshall set data octets field to the V2X message if the V2X message is of IP type;\na)\tshall set data octets field to the encapsulated IP type data if the V2X message is of \"Unstructured\" PDU Session type; and\nc)\tshall set the destination IP address and the destination UDP port to the UE's IP address and the configured UDP port associated the type of data of the V2X message and the V2X message family of the data of the V2X message (in case of non-IP).\nIn order to transport a V2X message of a V2X service identified by a V2X service identifier via MBS, in the UDP message, the V2X application server:\na)\tshall set data octets field to the V2X message if the V2X message is of IP type;\nb)\tshall set the destination IP address and the destination UDP port to the configured multicast IP address and the configured UDP port associated the type of data of the V2X message and the V2X message family of the data of the V2X message (in case of non-IP).The V2X application server sends the UDP message as the user plane data to the UE.\nIf the V2X application server determines to use TCP for transmission of the V2X message identified by a V2X service identifier, the V2X application server establishes a TCP connection with the UE if no TCP connection exists, then the V2X application server shall generate one or more TCP message(s). In the one or more TCP message(s), the V2X application server:\na)\tshall set data octets field to the V2X message; and\nb)\tshall set the destination IP address and the destination TCP port to the UE's IP address and the configured TCP port associated the type of data of the V2X message and the V2X message family of the data of the V2X message (in case of non-IP).\nThe V2X application server sends the one or more TCP message(s) as the user plane data to the UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.5\tReception of V2X communication over Uu from V2X application server to UE",
                            "text_content": "The upper layers can request the UE to receive a V2X message of a V2X service identified by a V2X service identifier using V2X communication over Uu. The request from the upper layers includes:\na)\tthe V2X service identifier of the V2X service for the V2X message to be received;\nb)\tthe type of data in the V2X message to be received (IP or non-IP); and\nc)\tif the V2X message to be received contains non-IP data, the V2X message family (see clause 9.2) of data in the V2X message to be received.\nIn order to tranport a V2X message of a V2X service identified by a V2X service identifier via unicast, upon a request from upper layers to receive a V2X message of a V2X service identified by a V2X service identifier using V2X communication over Uu:\na)\tif the registered PLMN of the UE is not in the list of PLMNs in which the UE is configured to use V2X communication over Uu as specified in clause 5.2.4, the UE shall determine that the transmission of V2X communication over Uu from V2X application server to UE is not configured and shall not continue with the rest of the steps; and\nb)\tif the V2X service identifier is included in the list of V2X service identifier to PDU session parameters mapping rules specified in clause 5.2.4;\nthen:\n1)\tthe UE shall determine the mapping rule in the list of V2X service identifier to PDU session parameters mapping rules specified in clause 5.2.4, such that the mapping rule contains the V2X service identifier provided by upper layers;\n2)\tthe UE shall establish a PDU session with the PDU session type, the SSC mode (if indicated in determined mapping rule), an S-NSSAI (if indicated in determined mapping rule) and a DNN (if indicated in determined mapping rule) indicated in the determined mapping rule, if such PDU session does not exist yet. The UE shall use the transport layer protocol, if indicated in the determined mapping rule, to receive the V2X message;\n3)\tif the PDU session is of \"IPv4\", \"IPv6\" or \"IPv4v6\" PDU session type:\ni)\tif the V2X service identifier is included in the list of V2X service identifier to V2X application server address mapping rules as specified in clause 5.2.4, then:\nA)\tthe UE shall discover the V2X application server address for downlink transport as described in clause 6.2.6. If the V2X application server address cannot be discovered, the UE shall determine that the transmission of V2X communication over Uu from V2X application server to UE is not possible and shall not continue with the rest of the steps. If the V2X service identifier is not included in the list of V2X service identifier to V2X application server address mapping rules as specified in clause 5.2.4, the UE shall continue with the rest of the steps; and\nB)\tif UDP is to be used for the determined V2X application server address:\n1)\tthe UE shall  select the UDP port for downlink transport based on configuration parameters for V2X communication as defined in clause 5.2.4; and\n2)\tthe UE shall listen for UDP packets over the determined UDP port, and provide the UDP packets to the upper layers if received; and\nC)\tif TCP is to be used for the determined V2X application server address:\n1)\tif a TCP connection with the determined V2X application server address is not established yet, the UE shall establish a TCP connection with the determined V2X application server address; and\n2)\tthe UE shall listen for TCP packets over the established TCP connection, and provide the TCP packets to the upper layers if received; and\n4)\tif the PDU session is of \"Unstructured\" PDU session type and the type of data in the V2X message is non-IP, the UE shall proceed as UDP is to be used for the determined V2X application server address with the exeption that the V2X message is encapsulated as IP type data packets.\nIn order to tranport a V2X message of a V2X service identified by a V2X service identifier via MBS, upon a request from upper layers to receive a V2X message of a V2X service identified by a V2X service identifier using V2X communication over Uu:\na)\tif the registered PLMN of the UE is not in the list of PLMNs in which the UE is configured to use V2X communication over Uu as specified in clause 5.2.4, the UE shall determine that the transmission of V2X communication over Uu from V2X application server to UE is not configured and shall not continue with the rest of the steps; and\nb)\tif the V2X service identifier is included in the list of V2X service identifier to PDU session parameters mapping rules specified in clause 5.2.4;\nthen:\n1)\tthe UE shall discover one or more V2X MBS configuration(s) for receiving V2X communication over Uu via MBS as described in subclause 6.2;\n2)\tif the V2X MBS configuration for receiving V2X communication over Uu via MBS is discovered:\nA)\tif the type of data in the V2X message is IP, the UE shall listen for a UDP packet:\nEditor’s note (WI: TEI18_MBS4V2X, CR: 0274):\tThe details of the V2X MBS configuration for receiving V2X communication over Uu using MBS is discovered and the type of data in the V2X message is IP are FFS.\nB)\tif the type of data in the V2X message is non-IP,, the UE shall listen for a UDP packet:\nEditor’s note (WI: TEI18_MBS4V2X, CR: 0274):\tThe details of the V2X MBS configuration for receiving V2X communication over Uu using MBS is discovered and the type of data in the V2X message is non-IP are FFS.\nC)\tthe UE shall extract the V2X message from the data octets field of the received UDP message as described in IETF RFC 768 [14] and pass the V2X message to upper layers; and\n3)\tif the V2X MBS configuration for receiving V2X communication over Uu using MBS is not discovered:\nA)\tthe UE shall discover the V2X application server address for downlink transport as described in subclause 6.2.6. If the V2X application server address cannot be discovered, the UE shall determine that the transmission of V2X communication over Uu from V2X application server to UE is not possible and shall not continue with the rest of the steps.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.6\tV2X application server discovery",
                            "text_content": "Before initiating V2X communication over Uu, the UE needs to discover the V2X application server to which the V2X messages shall be sent or received.\nTo discover the V2X application server address for uplink transport, the UE shall proceed as follows, in priority order:\na)\tif the V2X service of the V2X message is identified by a V2X service identifier and this V2X service identifier is associated with a V2X application server IP address and a UDP port for uplink transport or a TCP port for bidirectional transport in the list of V2X service identifier to V2X application server address mapping rules for the serving PLMN and the geographical area in which the UE is located as specified in clause 5.2.4, the UE shall use this IP address and the UDP or TCP port for V2X communication over Uu;\nb)\telse if the V2X service of the V2X message is identified by a V2X service identifier and this V2X service identifier is associated with a V2X application server FQDN and a UDP port for uplink transport or a TCP port for bidirectional transport in the list of V2X service identifier to V2X application server address mapping rules for the serving PLMN and the geographical area in which the UE is located as specified in clause 5.2.4, the UE shall perform DNS lookup as specified in IETF RFC 1035 [19], then use the resulting IP address and the UDP or TCP port for V2X communication over Uu;\nc)\telse if the V2X service of the V2X message is identified by a V2X service identifier and this V2X service identifier is associated with a V2X application server IP address and a UDP port for uplink transport or a TCP port for bidirectional transport in the list of V2X service identifier to V2X application server address mapping rules for the serving PLMN as specified in clause 5.2.4, the UE shall use this IP address and the UDP or TCP port for V2X communication over Uu;\nd)\telse if the V2X service of the V2X message is identified by a V2X service identifier and this V2X service identifier is associated with a V2X application server FQDN and a UDP port for uplink transport or a TCP port for bidirectional transport in the list of V2X service identifier to V2X application server address mapping rules for the serving PLMN as specified inclause 5.2.4, the UE shall perform DNS lookup as specified in IETF RFC 1035 [19], then use the resulting IP address and the UDP or TCP port for V2X communication over Uu;\ne)\telse if the V2X service of the V2X message is identified by a V2X service identifier, the V2X message contains IP data, and the default V2X application server address applicable for the serving PLMN, the geographical area in which the UE is located and the IP type of data as specified in clause 5.2.4 is configured and contains an IP address and a UDP port for uplink transport or a TCP port for bidirectional transport, then the UE shall use the IP address and the UDP or TCP port for V2X communication over Uu;\nf)\telse if the V2X service of the V2X message is identified by a V2X service identifier, the V2X message contains IP data, and the default V2X application server address applicable for the serving PLMN, the geographical area in which the UE is located and the IP type of data as specified in clause 5.2.4 is configured and contains an FQDN and a UDP port for uplink transport or a TCP port for bidirectional transport, then the UE shall perform DNS lookup of the FQDN as specified in IETF RFC 1035 [19], and shall use the resulting IP address and the UDP or TCP port for V2X communication over Uu;\ng)\telse if the V2X service of the V2X message is identified by a V2X service identifier, the V2X message contains IP data, and the default V2X application server address applicable for the serving PLMN and the IP type of data as specified in clause 5.2.4 is configured and contains an IP address and a UDP port for uplink transport or a TCP port for bidirectional transport, then the UE shall use the IP address and the UDP or TCP port for V2X communication over Uu;\nh)\telse if the V2X service of the V2X message is identified by a V2X service identifier, the V2X message contains IP data, and the default V2X application server address applicable for the serving PLMN and the IP type of data as specified in clause 5.2.4 is configured and contains an FQDN and a UDP port for uplink transport or a TCP port for bidirectional transport, then the UE shall perform DNS lookup of the FQDN as specified in IETF RFC 1035 [19], and shall use the resulting IP address and the UDP or TCP port for V2X communication over Uu;\ni)\telse if the V2X service of the V2X message is identified by a V2X service identifier, the V2X message contains non-IP data, and the default V2X application server address applicable for the serving PLMN, the geographical area in which the UE is located and the V2X message family of the non-IP data as specified in clause 5.2.4 is configured and contains an IP address and a UDP port for uplink transport or a TCP port for bidirectional transport, then the UE shall use the IP address and the UDP or TCP port for V2X communication over Uu;\nj)\telse if the V2X service of the V2X message is identified by a V2X service identifier, the V2X message contains non-IP data, and the default V2X application server address applicable for the serving PLMN, the geographical area in which the UE is located and the V2X message family of the non-IP data as specified in clause 5.2.4 is configured and contains an FQDN and a UDP port for uplink transport or a TCP port for bidirectional transport, then the UE shall perform DNS lookup of the FQDN as specified in IETF RFC 1035 [19], and shall use the resulting IP address and the UDP or TCP port for V2X communication over Uu;\nk)\telse if the V2X service of the V2X message is identified by a V2X service identifier, the V2X message contains non-IP data, and the default V2X application server address applicable for the serving PLMN and the V2X message family of the non-IP data as specified in clause 5.2.4 is configured and contains an IP address and a UDP port for uplink transport or a TCP port for bidirectional transport, then the UE shall use the IP address and the UDP or TCP port for V2X communication over Uu;\nl)\telse if the V2X service of the V2X message is identified by a V2X service identifier, the V2X message contains non-IP data, and the default V2X application server address applicable for the serving PLMN and the V2X message family of the non-IP data as specified in clause 5.2.4 is configured and contains an FQDN and a UDP port for uplink transport or a TCP port for bidirectional transport, then the UE shall perform DNS lookup of the FQDN as specified in IETF RFC 1035 [19], and shall use the resulting IP address and the UDP or TCP port for V2X communication over Uu;\nm)\telse if the V2X service of the V2X message is not identified by a V2X service identifier and the UE is configured with a V2X application server IP address for the serving PLMN and the geographical area in which the UE is located as specified in clause 5.2.4, the UE shall use this IP address for V2X communication over Uu;\nn)\telse if the V2X service of the V2X message is not identified by a V2X service identifier and the UE is configured with a V2X application server FQDN for the serving PLMN and the geographical area in which the UE is located as specified in clause 5.2.4, the UE shall perform DNS lookup as specified in IETF RFC 1035 [19], then use the resulting IP address for V2X communication over Uu;\no)\telse if the V2X service of the V2X message is not identified by a V2X service identifier and the UE is configured with a V2X application server IP address for the serving PLMN as specified in clause 5.2.4, the UE shall use this IP address for V2X communication over Uu; and\np)\telse if the V2X service of the V2X message is not identified by a V2X service identifier and the UE is configured with a V2X application server FQDN for the serving PLMN as specified in clause 5.2.4, the UE shall perform DNS lookup as specified in IETF RFC 1035 [19], then use the resulting IP address for V2X communication over Uu.\nNOTE:\tIt is out of scope of the present specification to define how the UE can locate itself in a specific geographical area. When the UE is in coverage of a 3GPP RAT it can for example use information derived from the serving PLMN. When the UE is not in coverage of a 3GPP RAT it can use other techniques.\nTo discover the V2X application server address for downlink transport, the UE shall proceed as follows, in priority order:\na)\tif the V2X service of the V2X message is identified by a V2X service identifier and this V2X service identifier is associated with a V2X application server IP address and a UDP port for downlink transport or a TCP port for bidirectional transport in the list of V2X service identifier to V2X application server address mapping rules for the serving PLMN and the geographical area in which the UE is located as specified in clause 5.2.4, the UE shall use this IP address and the UDP or TCP port for V2X communication over Uu;\nb)\telse if the V2X service of the V2X message is identified by a V2X service identifier and this V2X service identifier is associated with a V2X application server FQDN and a UDP port for downlink transport or a TCP port for bidirectional transport in the list of V2X service identifier to V2X application server address mapping rules for the serving PLMN and the geographical area in which the UE is located as specified in clause 5.2.4, the UE shall perform DNS lookup as specified in IETF RFC 1035 [19], then use the resulting IP address and the UDP or TCP port for V2X communication over Uu;\nc)\telse if the V2X service of the V2X message is identified by a V2X service identifier and this V2X service identifier is associated with a V2X application server IP address and a UDP port for downlink transport or a TCP port for bidirectional transport in the list of V2X service identifier to V2X application server address mapping rules for the serving PLMN as specified in clause 5.2.4, the UE shall use this IP address and the UDP or TCP port for V2X communication over Uu;\nd)\telse if the V2X service of the V2X message is identified by a V2X service identifier and this V2X service identifier is associated with a V2X application server FQDN and a UDP port for downlink transport or a TCP port for bidirectional transport in the list of V2X service identifier to V2X application server address mapping rules for the serving PLMN as specified in clause 5.2.4, the UE shall perform DNS lookup as specified in IETF RFC 1035 [19], then use the resulting IP address and the UDP or TCP port for V2X communication over Uu;\ne)\telse if the V2X service of the V2X message is identified by a V2X service identifier, the V2X message contains IP data, and the default V2X application server address applicable for the serving PLMN, the geographical area in which the UE is located and the IP type of data as specified in clause 5.2.4 is configured and contains an IP address and a UDP port for downlink transport or a TCP port for bidirectional transport, then the UE shall use the IP address and the UDP or TCP port for V2X communication over Uu;\nf)\telse if the V2X service of the V2X message is identified by a V2X service identifier, the V2X message contains IP data, and the default V2X application server address applicable for the serving PLMN, the geographical area in which the UE is located and the IP type of data as specified in clause 5.2.4 is configured and contains an FQDN and a UDP port for downlink transport or a TCP port for bidirectional transport, then the UE shall perform DNS lookup of the FQDN as specified in IETF RFC 1035 [19], and shall use the resulting IP address and the UDP or TCP port for V2X communication over Uu;\ng)\telse if the V2X service of the V2X message is identified by a V2X service identifier, the V2X message contains IP data, and the default V2X application server address applicable for the the serving PLMN and the IP type of data as specified in clause 5.2.4 is configured and contains an IP address and a UDP port for downlink transport or a TCP port for bidirectional transport, then the UE shall use the IP address and the UDP or TCP port for V2X communication over Uu;\nh)\telse if the V2X service of the V2X message is identified by a V2X service identifier, the V2X message contains IP data, and the default V2X application server address applicable for the serving PLMN and the IP type of data as specified in clause 5.2.4 is configured and contains an FQDN and a UDP port for downlink transport or a TCP port for bidirectional transport, then the UE shall perform DNS lookup of the FQDN as specified in IETF RFC 1035 [19], and shall use the resulting IP address and the UDP or TCP port for V2X communication over Uu;\ni)\telse if the V2X service of the V2X message is identified by a V2X service identifier, the V2X message contains non-IP data, and the default V2X application server address applicable for the serving PLMN, the geographical area in which the UE is located and the V2X message family of the non-IP data as specified in clause 5.2.4 is configured and contains an IP address and a UDP port for downlink transport or a TCP port for bidirectional transport, then the UE shall use the IP address and the UDP or TCP port for V2X communication over Uu;\nj)\telse if the V2X service of the V2X message is identified by a V2X service identifier, the V2X message contains non-IP data, and the default V2X application server address applicable for the serving PLMN, the geographical area in which the UE is located and the V2X message family of the non-IP data as specified in clause 5.2.4 is configured and contains an FQDN and a UDP port for downlink transport or a TCP port for bidirectional transport, then the UE shall perform DNS lookup of the FQDN as specified in IETF RFC 1035 [19], and shall use the resulting IP address and the UDP or TCP port for V2X communication over Uu;\nk)\telse if the V2X service of the V2X message is identified by a V2X service identifier, the V2X message contains non-IP data, and the default V2X application server address applicable for the serving PLMN and the V2X message family of the non-IP data as specified in clause 5.2.4 is configured and contains an IP address and a UDP port for downlink transport or a TCP port for bidirectional transport, then the UE shall use the IP address and the UDP or TCP port for V2X communication over Uu; and\nl)\telse if the V2X service of the V2X message is identified by a V2X service identifier, the V2X message contains non-IP data, and the default V2X application server address applicable for the serving PLMN and the V2X message family of the non-IP data as specified in clause 5.2.4 is configured and contains an FQDN and a UDP port for downlink transport or a TCP port for bidirectional transport, then the UE shall perform DNS lookup of the FQDN as specified in IETF RFC 1035 [19], and shall use the resulting IP address and the UDP or TCP port for V2X communication over Uu.\nIf multiple V2X application servers are discovered, the V2X application server to be used is selected by the V2X application layer.\nThe UE shall perform V2X application server discovery again when the UE changes its registered PLMN.\nIf the V2X application server used by the UE is associated with a particular geographical area, the UE shall perform V2X application server discovery again when the UE moves out of that geographical area.\nThe purpose of the V2X application server discovery using MBS procedure is to allow the UE to receive the V2X application server information viar MBS.\nThe UE shall only initiate the V2X application server discovery using MBS procedure if:\na)\tthe UE is configured to use V2X communication over Uu in the serving PLMN as specified in clause 5.2.4; and\nb)\tthe serving PLMN is associated with a V2X MBS configuration for receiving V2X application server information via MBS in the configuration parameters for V2X communication over Uu provisioned to the UE as specified in subclause 5.2.4.\nThe UE should use the V2X application server information received via MBS for transmission of V2X communication over Uu via unicast only when the UE is registered in the PLMN from which this V2X application server information was received.\nThe UE shall proceed as follows:\na)\tthe UE shall start listening to the MBS radio bearer corresponding to the TMGI, list of SAIs and frequency included in the V2X AS MBS configuration (see 3GPP TS 38.331 [11] clause 5.9) associated with the serving PLMN in the configuration parameters for V2X communication over Uu provisioned to the UE as specified in subclause 5.2.4\nb)\tthe UE shall use the IP multicast address and port included in the V2X AS MBS configuration associated with the serving PLMN in the configuration parameters for V2X communication over Uu provisioned to the UE as specified in subclause 5.2.4 to receive the V2X local service information; and\nEditor’s note (WI: TEI18_MBS4V2X, CR: 0275):\tThe details of the encoding of V2X local service information are FFS.\nc)\tIf the V2X service identifier of the V2X service requesting V2X communication over Uu maps to a V2X application server FQDN in the V2X application server information obtained at step 2, the UE shall perform DNS lookup as specified in IETF RFC 1035 [19] to resolve the IP address(es) of the V2X application server.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.7\tV2X application server configuration",
                            "text_content": "For transport of V2X message(s) of V2X service(s) identified by V2X service identifier(s) using V2X communication over Uu, the V2X application server shall be configured:\na)\twith one or more UDP ports for uplink transport;\nb)\twith one or more UDP ports for downlink transport;\nc)\twith one or more TCP ports for bidirectional transport;\nd)\tto handle data of \"Unstructured\" PDU Session type; or\ne)\tany combination of the above.\nIf the V2X application server is configured with one or more UDP ports for uplink transport of V2X message(s) of a V2X service(s) identified by V2X service identifier(s) using V2X communication over Uu:\n1)\tif the V2X application server supports V2X messages of IP type of data and of non-IP type of data, then the V2X application server shall be configured with different UDP ports for V2X messages of different types of data; and\n2)\tif the V2X application server supports V2X messages of several V2X message families, then the V2X application server shall be configured with different UDP ports for V2X messages of different V2X message families.\n6.2.8\tV2X MBS parameter discovery\nBefore receiving a V2X communication over Uu using MBS bearer, the UE needs to discover the V2X MBS parameters via which the V2X communication is to be received.\nThe UE shall proceed as follows, in priority order:\na)\tif the V2X message to be received is of IP type of data, the V2X service of the V2X message to be received is identified by a V2X service identifier, and this V2X service identifier is associated with a V2X MBS configuration for receiving V2X communication over Uu using MBS in the list of V2X services authorized for V2X communication over Uu for the registered PLMN of the UE and the SDP body of the V2X MBS configuration for receiving V2X communication over Uu using MBS contains a \"m=\" line of the application/vnd.3gpp.v2x media type with the type parameter indicating IP, the UE shall use the V2X MBS configuration for receiving V2X communication over Uu using MBS. If several such V2X MBS configurations are configured, the UE shall use all such V2X MBS configurations for receiving V2X communication over Uu using MBS;\nb)\telse if the V2X message to be received is of non-IP type of data, the V2X message to be received is of V2X message family, the V2X service of the V2X message to be received is identified by a V2X service identifier, and this V2X service identifier is associated with a V2X MBS configuration for receiving V2X communication over Uu using MBS in the list of V2X services authorized for V2X communication over Uu for the registered PLMN of the UE and the SDP body of the V2X MBS configuration for receiving V2X communication over Uu using MBS contains a \"m=\" line of the application/vnd.3gpp.v2x media type with:\n1)\tthe type parameter indicating non-IP; and\n2)\tthe v2x-message-family parameter indicating the V2X message family;\nthe UE shall use the V2X MBS configuration for receiving V2X communication over Uu using MBS. If several such V2X MBS configurations are configured, the UE shall use all such V2X MBS configurations for receiving V2X communication over Uu using MBS;\nc)\telse if the V2X message to be received is of IP type of data, the V2X service of the V2X message to be received is identified by a V2X service identifier, and the default V2X MBS configuration for receiving V2X communication over Uu using MBS as specified in clause 5.2.4 is configured and the SDP body of the V2X MBS configuration for receiving V2X communication over Uu using MBS contains a \"m=\" line of the application/vnd.3gpp.v2x media type with the type parameter indicating IP, the UE shall use the default V2X MBS configuration for receiving V2X communication over Uu using MBS. If several such V2X MBS configurations are configured, the UE shall use all such V2X MBS configurations for receiving V2X communication over Uu using MBS;\nd)\telse if the V2X message to be received is of non-IP type of data, the V2X message to be received is of V2X message family, the V2X service of the V2X message to be received is identified by a V2X service identifier, and the default V2X MBS configuration for receiving V2X communication over Uu using MBS as specified in clause 5.2.4 is configured and the SDP body of the V2X MBS configuration for receiving V2X communication over Uu using MBS contains a \"m=\" line of the application/vnd.3gpp.v2x media type with:\n1)\tthe type parameter indicating non-IP; and\n2)\tthe v2x-message-family parameter indicating the V2X message family;\nthe UE shall use the default V2X MBS configuration for receiving V2X communication over Uu using MBS. If several such V2X MBS configurations are configured, the UE shall use all such V2X MBS configurations for receiving V2X communication over Uu using MBS; and\ne)\telse if the V2X service of the V2X message to be received is not identified by a V2X service identifier, and the V2X MBS configuration for receiving V2X communication over Uu using MBS as specified in clause 5.2.4 is configured, the UE shall use the V2X MBS configuration for receiving V2X communication over Uu using MBS. If several such V2X MBS configurations are configured, the UE shall use all such V2X MBS configurations for receiving V2X communication over Uu using MBS.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "6A\tHandling of unknown, unforeseen, and erroneous PC5 signalling protocol data",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "6A.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "The procedures specified in clause 6.1 apply to those messages which pass the checks described in clause 6A.\nClause 6A also specifies procedures for the handling of unknown, unforeseen, and erroneous PC5 signalling protocol data by the receiving entity. These procedures are called \"error handling procedures\", but in addition to providing recovery mechanisms for error situations they define a compatibility mechanism for future extensions of the PC5 signalling protocol.\nClauses 6A.1 to 6A.7 shall be applied in order of precedence.\nDetailed error handling procedures in the peer UE are implementation dependent and may vary. However, when extensions of PC5 signalling protocol are developed, the peer UE are assumed to have the error handling which is indicated in this clause as mandatory (\"shall\") and that is indicated as strongly recommended (\"should\").\nAlso, the error handling of the peer UE is only considered as mandatory or strongly recommended when certain thresholds for errors are not reached during a dedicated connection.\nFor definition of semantical and syntactical errors see 3GPP TS 24.007 [26], clause 11.4.2.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "6A.2\tMessage too short or too long",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6A.2.1\tMessage too short",
                            "text_content": "When a message is received that is too short to contain a complete message type information element, that message shall be ignored, cf. 3GPP TS 24.007 [26].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6A.2.2\tMessage too long",
                            "text_content": "The maximum size of a PC5 signalling message is 65535 octets.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6A.3\tUnknown or unforeseen message type",
                    "description": "",
                    "summary": "",
                    "text_content": "If the UE or the peer UE receives a PC5 signalling message with message type not defined for the PC5 signalling protocol or not implemented by the receiver, it shall ignore the PC5 signalling message.\nNOTE:\tA message type not defined for the PC5 signalling protocol in the given direction is regarded by the receiver as a message type not defined for the PC5 signalling protocol, see 3GPP TS 24.007 [26].\nIf the UE receives a message not compatible with the PC5 signalling protocol state, the UE shall ignore the PC5 signalling message.\nIf the peer UE receives a message not compatible with the Pc5 signalling protocol state, the peer UE actions are implementation dependent.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "6A.4\tNon-semantical mandatory information element errors",
                    "description": "",
                    "summary": "",
                    "text_content": "When on receipt of a message,\na)\tan \"imperative message part\" error; or\nb)\ta \"missing mandatory IE\" error\nis diagnosed or when a message containing:\na)\ta syntactically incorrect mandatory IE;\nb)\tan IE unknown in the message, but encoded as \"comprehension required\" (see 3GPP TS 24.007 [26]); or\nc)\tan out of sequence IE encoded as \"comprehension required\" (see 3GPP TS 24.007 [26]) is received,\nthe UE shall ignore the PC5 signalling message and the peer UE shall:\na)\ttry to treat the message (the exact further actions are implementation dependent); or\nb)\tignore the message.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "6A.5\tUnknown and unforeseen IEs in the non-imperative message part",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6A.5.1\tIEIs unknown in the message",
                            "text_content": "The UE shall ignore all IEs unknown in a message which are not encoded as \"comprehension required\" (see 3GPP TS 24.007 [26]).\nThe peer UE shall take the same approach.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6A.5.2\tOut of sequence IEs",
                            "text_content": "The UE shall ignore all out of sequence IEs in a message which are not encoded as \"comprehension required\" (see 3GPP TS 24.007 [26]).\nThe peer UE should take the same approach.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6A.5.3\tRepeated IEs",
                            "text_content": "If an information element with format T, TV, TLV, or TLV-E is repeated in a message in which repetition of the information element is not specified in clause 8.4, the UE shall handle only the contents of the information element appearing first and shall ignore all subsequent repetitions of the information element. When repetition of information elements is specified, the UE shall handle only the contents of specified repeated information elements. If the limit on repetition of information elements is exceeded, the UE shall handle the contents of information elements appearing first up to the limit of repetitions and shall ignore all subsequent repetitions of the information element.\nThe peer UE should follow the same procedures.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6A.6\tNon-imperative message part errors",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6A.6.1\tGeneral",
                            "text_content": "This category includes:\na)\tsyntactically incorrect optional IEs; and\nb)\tconditional IE errors.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6A.6.2\tSyntactically incorrect optional IEs",
                            "text_content": "The UE shall treat all optional IEs that are syntactically incorrect in a message as not present in the message.\nThe peer UE shall take the same approach.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6A.6.3\tConditional IE errors",
                            "text_content": "When upon receipt of a PC5 signalling message the UE diagnoses a \"missing conditional IE\" error or an \"unexpected conditional IE\" error, or when it receives a PC5 signalling message containing at least one syntactically incorrect conditional IE, the UE shall ignore the message.\nWhen the peer UE receives a message and diagnoses a \"missing conditional IE\" error or an \"unexpected conditional IE\" error or when it receives a message containing at least one syntactically incorrect conditional IE, the peer UE shall either:\na)\ttry to treat the message (the exact further actions are implementation dependent); or\nb)\tignore the message.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6A.7\tMessages with semantically incorrect contents",
                    "description": "",
                    "summary": "",
                    "text_content": "When a message with semantically incorrect contents is received, the UE shall perform the foreseen reactions of the procedural part of clause 6.1. If, however no such reactions are specified, the UE shall ignore the message.\nThe peer UE should follow the same procedure.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "7\tMessage functional definition and contents",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "7.1\tOverview",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause contains the definition and contents of the messages used in the procedures described in the present document.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.2\tProvisioning of parameters for V2X configuration signalling messages",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.2.1\tUE policy provisioning request",
                            "text_content": "The UE POLICY PROVISIONING REQUEST message is sent by the UE to the PCF to request the PCF to manage V2XP, ProSeP, A2XP, RSLPP or all of them, see table 7.2.1.1.1\nMessage type:\tUE POLICY PROVISIONING REQUEST\nSignificance:\tdual\nDirection:\tUE to network\nTable 7.2.1.1.1: UE POLICY PROVISIONING REQUEST message content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.2.1.1.1: UE POLICY PROVISIONING REQUEST message content",
                                    "table number": 3,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.2.2\tUE policy provisioning reject",
                            "text_content": "The UE POLICY PROVISIONING REJECT message is sent by the PCF to the UE to report that the PCF rejects request, to manage V2XP, ProSeP, A2XP, RSLPP or all of them, see table 7.2.2.1.1\nMessage type:\tUE POLICY PROVISIONING REJECT\nSignificance:\tdual\nDirection:\tnetwork to UE\nTable 7.2.2.1.1: UE POLICY PROVISIONING REJECT message content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.2.2.1.1: UE POLICY PROVISIONING REJECT message content",
                                    "table number": 4,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "7.3\tV2X communication over PC5 signalling messages",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.3.1\tDirect link establishment request",
                            "text_content": "This message is sent by a UE to another peer UE to establish a direct link. See table 7.3.1.1.1.\nMessage type:\tDIRECT LINK ESTABLISHMENT REQUEST\nSignificance:\tdual\nDirection:\tUE to peer UE\nTable 7.3.1.1.1: DIRECT LINK ESTABLISHMENT REQUEST message content\n\nThe UE shall include this IE if it has received the target UE's application layer ID from upper layers or if the destination layer-2 ID is the unicast layer-2 ID of target UE.\nThe UE shall include this IE if the UE PC5 unicast signalling security policy is set to \"signalling integrity protection required\" or \"signalling integrity protection preferred\".\nThe UE shall include this IE if the UE PC5 unicast signalling security policy is set to \"signalling integrity protection required\" or \"signalling integrity protection preferred\".\nThe UE shall include this IE if the UE PC5 unicast signalling security policy is set to \"signalling integrity protection required\" or \"signalling integrity protection preferred\".\nThe UE may include this IE if it has an existing KNRP for the target UE.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.3.1.1.1: DIRECT LINK ESTABLISHMENT REQUEST message content",
                                    "table number": 5,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.3.2\tDirect link establishment accept",
                            "text_content": "This message is sent by a UE to another peer UE to accept the received DIRECT LINK ESTABLISHMENT REQUEST message. See table 7.3.2.1.1.\nMessage type:\tDIRECT LINK ESTABLISHMENT ACCEPT\nSignificance:\tdual\nDirection:\tUE to peer UE\nTable 7.3.2.1.1: DIRECT LINK ESTABLISHMENT ACCEPT message content\nEditor's note:\tThe RSPP metadata information to provide e.g., the specific Role(s) of to related UE, the value is determined by RAN2.\nThe UE shall include this IE if IP communication is used.\nThe UE shall include this IE if IP communication is used and the IP address configuration is set to \"IPv6 address allocation not supported\".\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.3.2.1.1: DIRECT LINK ESTABLISHMENT ACCEPT message content",
                                    "table number": 6,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.3.3\tVoid",
                            "text_content": "",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.3.4\tDirect link modification request",
                            "text_content": "This message is sent by the UE to another peer UE to initiate the direct link modification procedure. See table 7.3.4.1.1.\nMessage type:\tDIRECT LINK MODIFICATION REQUEST\nSignificance:\tdual\nDirection:\tUE to peer UE\nTable 7.3.4.1.1: DIRECT LINK MODIFICATION REQUEST message content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.3.4.1.1: DIRECT LINK MODIFICATION REQUEST message content",
                                    "table number": 7,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.3.5\tDirect link modification accept",
                            "text_content": "This message is sent by the UE to another peer UE to indicate that the link modification request is accepted. See table 7.3.5.1.1\nMessage type:\tDIRECT LINK MODIFICATION ACCEPT\nSignificance:\tdual\nDirection:\tUE to peer UE\nTable 7.3.5.1.1: DIRECT LINK MODIFICATION ACCEPT message content\n\nThe UE shall include this IE if the PC5 unicast link modification procedure is to:\na)\tadd new PC5 QoS flow(s) to the existing PC5 unicast link;\nb)\tmodify PC5 QoS parameters of the existing PC5 QoS flow(s);\nc)\tassociate new V2X service(s) with existing PC5 QoS flow(s); or\nd)\tremove V2X service(s) from existing PC5 QoS flow(s).\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.3.5.1.1: DIRECT LINK MODIFICATION ACCEPT message content",
                                    "table number": 8,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.3.6\tDirect link release request",
                            "text_content": "This message is sent by the UE to another peer UE to initiate the direct link release procedure. See table 7.3.6.1.1.\nMessage type:\tDIRECT LINK RELEASE REQUEST\nSignificance:\tdual\nDirection:\tUE to peer UE\nTable 7.3.6.1.1: DIRECT LINK RELEASE REQUEST message content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.3.6.1.1: DIRECT LINK RELEASE REQUEST message content",
                                    "table number": 9,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.3.7\tDirect link release accept",
                            "text_content": "This message is sent by the UE to another peer UE to indicate that the link release request is accepted. See table 7.3.7.1.\nMessage type:\tDIRECT LINK RELEASE ACCEPT\nSignificance:\tdual\nDirection:\tUE to peer UE\nTable 7.3.7.1: DIRECT LINK RELEASE ACCEPT message content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.3.7.1: DIRECT LINK RELEASE ACCEPT message content",
                                    "table number": 10,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.3.8\tDirect link keepalive request",
                            "text_content": "This message is sent by a UE to another peer UE when a PC5 unicast link keep-alive procedure is initiated. See table 7.3.8.1.1.\nMessage type:\tDIRECT LINK KEEPALIVE REQUEST\nSignificance:\tdual\nDirection:\tUE to peer UE\nTable 7.3.8.1.1: DIRECT LINK KEEPALIVE REQUEST message content\n\nThe UE may include this IE to indicate its maximum inactivity period to the peer UE.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.3.8.1.1: DIRECT LINK KEEPALIVE REQUEST message content",
                                    "table number": 11,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.3.9\tDirect link keepalive response",
                            "text_content": "This message is sent by a UE to another peer UE to respond to a DIRECT LINK KEEPALIVE REQUEST message. See table 7.3.9.1.1.\nMessage type:\tDIRECT LINK KEEPALIVE RESPONSE\nSignificance:\tdual\nDirection:\tUE to peer UE\nTable 7.3.9.1.1: DIRECT LINK KEEPALIVE RESPONSE message content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.3.9.1.1: DIRECT LINK KEEPALIVE RESPONSE message content",
                                    "table number": 12,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.3.10\tDirect link authentication request",
                            "text_content": "This message is sent by a UE to another peer UE when a PC5 unicast link authentication procedure is initiated. See table 7.3.10.1.1.\nMessage type:\tDIRECT LINK AUTHENTICATION REQUEST\nSignificance:\tdual\nDirection:\tUE to peer UE\nTable 7.3.10.1.1: DIRECT LINK AUTHENTICATION REQUEST message content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.3.10.1.1: DIRECT LINK AUTHENTICATION REQUEST message content",
                                    "table number": 13,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.3.11\tDirect link authentication response",
                            "text_content": "This message is sent by a UE to another peer UE to respond to a DIRECT LINK AUTHENTICATION REQUEST message. See table 7.3.11.1.1.\nMessage type:\tDIRECT LINK AUTHENTICATION RESPONSE\nSignificance:\tdual\nDirection:\tUE to peer UE\nTable 7.3.11.1.1: DIRECT LINK AUTHENTICATION RESPONSE message content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.3.11.1.1: DIRECT LINK AUTHENTICATION RESPONSE message content",
                                    "table number": 14,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.3.12\tDirect link authentication reject",
                            "text_content": "This message is sent by a UE to another peer UE to reject a DIRECT LINK AUTHENTICATION REQUEST message. See table 7.3.12.1.1.\nMessage type:\tDIRECT LINK AUTHENTICATION REJECT\nSignificance:\tdual\nDirection:\tUE to peer UE\nTable 7.3.12.1.1: DIRECT LINK AUTHENTICATION REJECT message content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.3.12.1.1: DIRECT LINK AUTHENTICATION REJECT message content",
                                    "table number": 15,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.3.13\tDirect link security mode command",
                            "text_content": "This message is sent by a UE to another peer UE when a PC5 unicast link security mode control procedure is initiated. See table 7.3.13.1.1.\nMessage type:\tDIRECT LINK SECURITY MODE COMMAND\nSignificance:\tdual\nDirection:\tUE to peer UE\nTable 7.3.13.1.1: DIRECT LINK SECURITY MODE COMMAND message content\n\nThe UE shall include this IE if the selected integrity protection algorithms is not the null integrity protection algorithm.\nThe UE shall include this IE if the selected integrity protection algorithms is not the null integrity protection algorithm.\nThe UE shall include this IE if the UE has derived a new KNRP and the authentication method used to generate KNRP requires sending information to complete the authentication procedure.\nThe UE shall include this IE if the UE has derived a new KNRP.\nThe UE shall include this IE if the DIRECT LINK SECURITY MODE COMMAND message is triggered by the DIRECT LINK ESTABLISHMENT REQUEST message. The content of the IE is the same as the content of UE PC5 unicast signalling security policy IE in the received DIRECT LINK ESTABLISHMENT REQUEST message in order to provide protection against bidding down attacks.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.3.13.1.1: DIRECT LINK SECURITY MODE COMMAND message content",
                                    "table number": 16,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.3.14\tDirect link security mode complete",
                            "text_content": "This message is sent by a UE to another peer UE to respond to a DIRECT LINK SECURITY MODE COMMAND message. See table 7.3.14.1.1.\nMessage type:\tDIRECT LINK SECURITY MODE COMPLETE\nSignificance:\tdual\nDirection:\tUE to peer UE\nTable 7.3.14.1.1: DIRECT LINK SECURITY MODE COMPLETE message content\n\nThe UE shall include this IE if IP communication is used and the PC5 unicast link security mode control procedure was triggered during a PC5 unicast link establishment procedure.\nThe UE shall include this IE if IP communication is used, the IP address configuration is set to \"IPv6 address allocation not supported\" and the PC5 unicast link security mode control procedure was triggered during a PC5 unicast link establishment procedure.\nThe UE shall include this IE if a new KNRP was derived.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.3.14.1.1: DIRECT LINK SECURITY MODE COMPLETE message content",
                                    "table number": 17,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.3.15\tDirect link security mode reject",
                            "text_content": "This message is sent by a UE to another peer UE to reject a DIRECT LINK SECURITY MODE COMMAND message. See table 7.3.15.1.1.\nMessage type:\tDIRECT LINK SECURITY MODE REJECT\nSignificance:\tdual\nDirection:\tUE to peer UE\nTable 7.3.15.1.1: DIRECT LINK SECURITY MODE REJECT message content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.3.15.1.1: DIRECT LINK SECURITY MODE REJECT message content",
                                    "table number": 18,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.3.16\tDirect link rekeying request",
                            "text_content": "This message is sent by a UE to another peer UE when a PC5 unicast link re-keying procedure is initiated. See table 7.3.16.1.1.\nMessage type:\tDIRECT LINK REKEYING REQUEST\nSignificance:\tdual\nDirection:\tUE to peer UE\nTable 7.3.16.1.1: DIRECT LINK REKEYING REQUEST message content\n\nThe UE shall include this IE if the null integrity protection algorithm is not in use.\nThe UE shall include this IE if the null integrity protection algorithm is not in use.\nThe UE shall include this IE if the null integrity protection algorithm is not in use.\nThe UE shall include this IE if the UE wants to derive a new KNRP.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.3.16.1.1: DIRECT LINK REKEYING REQUEST message content",
                                    "table number": 19,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.3.17\tDirect link rekeying response",
                            "text_content": "This message is sent by a UE to another peer UE to respond to a DIRECT LINK REKEYING REQUEST message. See table 7.3.17.1.1.\nMessage type:\tDIRECT LINK REKEYING RESPONSE\nSignificance:\tdual\nDirection:\tUE to peer UE\nTable 7.3.17.1.1: DIRECT LINK REKEYING RESPONSE message content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.3.17.1.1: DIRECT LINK REKEYING RESPONSE message content",
                                    "table number": 20,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.3.18\tDirect link identifier update request",
                            "text_content": "This message is sent by a UE to another peer UE to initiate the direct link identifier procedure. See table 7.3.18.1.1.\nMessage type:\tDIRECT LINK IDENTIFIER UPDATE REQUEST\nSignificance:\tdual\nDirection:\tUE to peer UE\nTable 7.3.18.1.1: DIRECT LINK IDENTIFIER UPDATE REQUEST message content\n\nThis IE is included when the initiating UE receives a new application layer ID.\nThis IE is included when the link local IPv6 address changes at the initiating UE.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.3.18.1.1: DIRECT LINK IDENTIFIER UPDATE REQUEST message content",
                                    "table number": 21,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.3.19\tDirect link identifier update accept",
                            "text_content": "This message is sent by the UE to another peer UE to indicate that the link identifier update request is accepted. See table 7.3.19.1.1.\nMessage type:\tDIRECT LINK IDENTIFIER UPDATE ACCEPT\nSignificance:\tdual\nDirection:\tUE to peer UE\nTable 7.3.19.1.1: DIRECT LINK IDENTIFIER UPDATE ACCEPT message content\n\nThis IE is included if the target UE receives the Source user info IE in the DIRECT LINK IDENTIFIER UPDATE REQUEST message.\nThis IE is included if the target UE receives the Source link local IPv6 address IE in the DIRECT LINK IDENTIFIER UPDATE REQUEST message.\nThis IE is included when the application layer ID changes at the target UE and the target UE receives a new application layer ID from the upper layers.\nThis IE is included when the link local IPv6 address changes at the target UE and the target UE receives a new Link local IPv6 address from the upper layers.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.3.19.1.1: DIRECT LINK IDENTIFIER UPDATE ACCEPT message content",
                                    "table number": 22,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.3.20\tDirect link identifier update ack",
                            "text_content": "This message is sent by the initiating UE to target UE to indicate that the initiating UE has received target UE's accept message. See table 7.3.20.1.1.\nMessage type:\tDIRECT LINK IDENTIFIER UPDATE ACK\nSignificance:\tdual\nDirection:\tUE to peer UE\nTable 7.3.20.1.1: DIRECT LINK IDENTIFIER UPDATE ACK message content\n\nThis IE is included when the initiating UE receives the Source user info IE in the DIRECT LINK IDENTIFIER UPDATE ACCEPT message.\nThis IE is included when the initiating UE receives the Source link local IPv6 address IE in the DIRECT LINK IDENTIFIER UPDATE ACCEPT message.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.3.20.1.1: DIRECT LINK IDENTIFIER UPDATE ACK message content",
                                    "table number": 23,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.3.21\tDirect link identifier update reject",
                            "text_content": "This message is sent by the target UE to initiating UE to indicate that the link identifier update request is not accepted. See table 7.3.21.1.1.\nMessage type:\tDIRECT LINK IDENTIFIER UPDATE REJECT\nSignificance:\tdual\nDirection:\tUE to peer UE\nTable 7.3.21.1.1: DIRECT LINK IDENTIFIER UPDATE REJECT message content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.3.21.1.1: DIRECT LINK IDENTIFIER UPDATE REJECT message content",
                                    "table number": 24,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.3.22\tDirect link modification reject",
                            "text_content": "This message is sent by the UE to another peer UE to indicate that the link modification request is not accepted. See table 7.3.22.1.1.\nMessage type:\tDIRECT LINK MODIFICATION REJECT\nSignificance:\tdual\nDirection:\tUE to peer UE\nTable 7.3.22.1.1: DIRECT LINK MODIFICATION REJECT message content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.3.22.1.1: DIRECT LINK MODIFICATION REJECT message content",
                                    "table number": 25,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.3.23\tDirect link establishment reject",
                            "text_content": "This message is sent by the UE to another peer UE to indicate that the link establishment request is not accepted. See table 7.3.23.1.1.\nMessage type:\tDIRECT LINK ESTABLISHMENT REJECT\nSignificance:\tdual\nDirection:\tUE to peer UE\nTable 7.3.23.1.1: DIRECT LINK ESTABLISHMENT REJECT message content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.3.23.1.1: DIRECT LINK ESTABLISHMENT REJECT message content",
                                    "table number": 26,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.3.24\tDirect link authentication failure",
                            "text_content": "This message is sent by a UE to another peer UE to reject a DIRECT LINK AUTHENTICATION RESPONSE message. See table 7.3.24.1.1.\nMessage type:\tDIRECT LINK AUTHENTICATION FAILURE\nSignificance:\tdual\nDirection:\tUE to peer UE\nTable 7.3.24.1.1: DIRECT LINK AUTHENTICATION FAILURE message content\n\nThe UE shall include this IE if it is provided by upper layers.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.3.24.1.1: DIRECT LINK AUTHENTICATION FAILURE message content",
                                    "table number": 27,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "title": "8\tInformation elements coding",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "8.1\tOverview",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause contains the information elements coding for the messages used in the procedures described in the present document.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "8.2\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "The sending entity shall set the value of a spare bit to zero. The receiving entity shall ignore the value of a spare bit.\nThe sending entity shall not set the value of a field to a reserved value. The receiving entity shall discard a message carrying a field with the value set to a reserved value.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "8.3\tProvisioning of parameters for V2X configuration signalling information elements",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "8.3.1\tUPDS cause",
                            "text_content": "The purpose of the UPDS cause information element is to indicate the reason why a UPDS request is rejected.\nThe UPDS cause information element is coded as shown in figure 8.3.1.1 and table 8.3.1.1.\nThe UPDS cause is a type 3 information element with 2 octets length.\nFigure 8.3.1.1: UPDS cause information element\nTable 8.3.1.1: UPDS cause information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The UPDS cause is a type 3 information element with 2 octets length.",
                                    "table number": 28,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.3.1.1: UPDS cause information element",
                                    "table number": 29,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.3.2\tRequested UE policies",
                            "text_content": "The purpose of the Requested UE policies information element is to enable the UE to request the PCF to provide certain UE policies or certain UE policy subsets.\nThe Requested UE policies information element is coded as shown in figure 8.3.2.1 and table 8.3.2.1.\nThe Requested UE policies is a type 4 information element with a minimum length of 3 octets and a maximum length of 5 octets.\n\nFigure 8.3.2.1: Requested UE policies information element\nTable 8.3.2.1: Requested UE policies information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The Requested UE policies is a type 4 information element with a minimum length of 3 octets and a maximum length of 5 octets.",
                                    "table number": 30,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.3.2.1: Requested UE policies information element",
                                    "table number": 31,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "8.4\tV2X communication over PC5 signalling information elements",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "8.4.1\tPC5 signalling message type",
                            "text_content": "The purpose of the PC5 signalling message type information element is to indicate the type of messages used in PC5 signalling protocol.\nThe value part of the PC5 signalling message type information element used in the PC5 signalling messages is coded as shown in table 8.4.1.1.\nThe PC5 signalling message type is a type 3 information element, with the length of 1 octet.\nTable 8.4.1.1: PC5 signalling message type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.4.1.1: PC5 signalling message type",
                                    "table number": 32,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.4.2\tSequence number",
                            "text_content": "The purpose of the Sequence number information element is to uniquely identify a PC5 signalling message being sent or received. The sending UE will increment the sequence number for each outgoing new PC5 signalling message.\nThe Sequence number information element is an integer in the 0-255 range.\nThe Sequence number is a type 3 information element, with a length of 1 octet.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "8.4.3\tV2X service identifier",
                            "text_content": "The purpose of the V2X service identifier parameter is to carry the identifier of a V2X service.\nThe V2X service identifier information element is coded as shown in figure 8.4.3.1 and table 8.4.3.1.\nThe V2X service identifier is a type 4 information element with a minimum length of 6 octets.\nFigure 8.4.3.1: V2X service identifier information element\nTable 8.4.3.1: V2X service identifier information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The V2X service identifier is a type 4 information element with a minimum length of 6 octets.",
                                    "table number": 33,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.4.3.1: V2X service identifier information element",
                                    "table number": 34,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.4.4\tApplication layer ID",
                            "text_content": "The purpose of the Application layer ID parameter information element carries an application layer ID as specified in 3GPP TS 23.287 [3].\nThe Application layer ID information element is coded as shown in figure 8.4.4.1 and table 8.4.4.1.\nThe Application layer ID is a type 4 information element.\nFigure 8.4.4.1: Application layer ID information element\nTable 8.4.4.1: Application layer ID information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The Application layer ID is a type 4 information element.",
                                    "table number": 35,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.4.4.1: Application layer ID information element",
                                    "table number": 36,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.4.5\tPC5 QoS flow descriptions",
                            "text_content": "The purpose of the PC5 QoS flow descriptions information element is to indicate a set of PC5 QoS flow descriptions to be used by the UE over the direct link, where each PC5 QoS flow description is a set of parameters as described in clause 5.4.2 of 3GPP TS 23.287 [3].\nThe PC5 QoS flow descriptions is a type 6 information element with a minimum length of 6 octets. The maximum length for the information element is 65538 octets.\nThe PC5 QoS flow descriptions information element is coded as shown in figure 8.4.5.1, figure 8.4.5.2, figure 8.4.5.3, figure 8.4.5.4, and table 8.4.5.1.\nFigure 8.4.5.1: PC5 QoS flow descriptions information element\n\nFigure 8.4.5.2: PC5 QoS flow description\nFigure 8.4.5.3: Parameters list\nFigure 8.4.5.4: Parameter\nTable 8.4.4.1: PC5 QoS flow descriptions information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The PC5 QoS flow descriptions information element is coded as shown in figure 8.4.5.1, figure 8.4.5.2, figure 8.4.5.3, figure 8.4.5.4, and table 8.4.5.1.",
                                    "table number": 37,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 38,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Figure 8.4.5.2: PC5 QoS flow description",
                                    "table number": 39,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Figure 8.4.5.3: Parameters list",
                                    "table number": 40,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.4.4.1: PC5 QoS flow descriptions information element",
                                    "table number": 41,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.4.6\tIP address configuration",
                            "text_content": "The purpose of the IP address configuration information element is to indicate the configuration options for IP address used by the UE over this direct link.\nThe IP address configuration is a type 3 information element with the length of 2 octets.\nThe IP address configuration information element is coded as shown in figure z.3.1.6.1 and table z.3.1.6.1.\n\nFigure 8.4.6.1: IP address configuration information element\nTable 8.4.6.1: IP address configuration information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The IP address configuration information element is coded as shown in figure z.3.1.6.1 and table z.3.1.6.1.",
                                    "table number": 42,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.4.6.1: IP address configuration information element",
                                    "table number": 43,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.4.7\tLink local IPv6 address",
                            "text_content": "The purpose of the Link local IPv6 address information element is to indicate the link local IPv6 address.\nThe Link local IPv6 address is a type 3 information element with the length of 17 octets.\nThe Link local IPv6 address information element is coded as shown in figure 8.4.7.1 and table 8.4.7.1.\n\nFigure 8.4.7.1: Link local IPv6 address information element\nTable 8.4.7.1: Link local IPv6 address information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The Link local IPv6 address information element is coded as shown in figure 8.4.7.1 and table 8.4.7.1.",
                                    "table number": 44,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.4.7.1: Link local IPv6 address information element",
                                    "table number": 45,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.4.8\tLink modification operation code",
                            "text_content": "The purpose of the Link modification operation code information element is to indicate what the operation of the PC5 unicast link modification procedure triggered by initiating UE is.\nThe Link modification operation code is a type 3 information element, with a length of 2 octets.\nThe Link modification operation code information element is coded as shown in figure 8.4.8.1 and table 8.4.8.1.\n\nFigure 8.4.8.1: Link modification operation code information element\nTable 8.4.8.1: Link modification operation code information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The Link modification operation code information element is coded as shown in figure 8.4.8.1 and table 8.4.8.1.",
                                    "table number": 46,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.4.8.1: Link modification operation code information element",
                                    "table number": 47,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.4.9\tPC5 signalling protocol cause",
                            "text_content": "The purpose of the PC5 signalling protocol cause information element is to indicate the cause used in the PC5 signalling protocol procedures.\nThe PC5 signalling protocol cause is a type 3 information element with a length of 2 octets.\nThe PC5 signalling protocol cause information element is coded as shown in figure 8.4.9.1 and table 8.4.9.1.\n\nFigure 8.4.9.1: PC5 signalling protocol cause information element\nTable 8.4.9.1: PC5 signalling protocol cause information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The PC5 signalling protocol cause information element is coded as shown in figure 8.4.9.1 and table 8.4.9.1.",
                                    "table number": 48,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.4.9.1: PC5 signalling protocol cause information element",
                                    "table number": 49,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.4.10\tKeep-alive counter",
                            "text_content": "The purpose of the Keep-alive counter information element is to indicate the keep-alive counter which is a 32-bit counter used for the PC5 unicast link keep-alive procedure.\nThe Keep-alive counter is a type 3 information element with a length of 5 octets.\nThe Keep-alive counter information element is coded as shown in figure 8.4.10.1 and table 8.4.10.1.\n\nFigure 8.4.10.1: Keep-alive counter information element\nTable 8.4.10.1: Keep-alive counter information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The Keep-alive counter information element is coded as shown in figure 8.4.10.1 and table 8.4.10.1.",
                                    "table number": 50,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.4.10.1: Keep-alive counter information element",
                                    "table number": 51,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.4.11\tMaximum inactivity period",
                            "text_content": "The purpose of the Maximum inactivity period information element is to indicate the maximum inactivity period of the initiating UE during a PC5 unicast link keep-alive procedure.\nThe Maximum inactivity period is a type 3 information element, with a length of 5 octets.\nThe Maximum inactivity period information element is coded as shown in figure 8.4.11.1 and table 8.4.11.1.\n\nFigure 8.4.11.1: Maximum inactivity period information element\nTable 8.4.11.1: Maximum inactivity period information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The Maximum inactivity period information element is coded as shown in figure 8.4.11.1 and table 8.4.11.1.",
                                    "table number": 52,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.4.11.1: Maximum inactivity period information element",
                                    "table number": 53,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.4.12\tKey establishment information container",
                            "text_content": "The Key establishment information container information element contains information for PC5 unicast link key establishment.\nThe Key establishment information container is a type 6 information element with a minimum length of 4 octets.\nThe Key establishment information container information element is coded as shown in figure 8.4.12.1 and table 8.4.12.1.\nFigure 8.4.a.1: Key establishment information container information element\nTable 8.4.a.1: Key establishment information container information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The Key establishment information container information element is coded as shown in figure 8.4.12.1 and table 8.4.12.1.",
                                    "table number": 54,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.4.a.1: Key establishment information container information element",
                                    "table number": 55,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.4.13\tNonce",
                            "text_content": "The Nonce information element contains a 128-bit nonce used during PC5 unicast link security establishment.\nThe Nonce information element is a type 3 information element, with a length of 17 octets.\nThe Nonce information element is coded as shown in figure 8.4.13.1 and table 8.4.13.1.\n\nFigure 8.4.13.1: Nonce information element\nTable 8.4.13.1: Nonce information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The Nonce information element is coded as shown in figure 8.4.13.1 and table 8.4.13.1.",
                                    "table number": 56,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.4.13.1: Nonce information element",
                                    "table number": 57,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.4.14\tUE security capabilities",
                            "text_content": "The UE security capabilities information element is used to indicate which security algorithms are supported by the UE.\nThe UE security capabilities is a type 4 information element with a minimum length of 4 octets and a maximum length of 10 octets.\nThe UE security capabilities information element is coded as shown in figure 8.4.14.1 and table 8.4.14.1.\n\nFigure 8.4.14.1: UE security capabilities information element\nTable 8.4.14.1: UE security capabilities information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The UE security capabilities information element is coded as shown in figure 8.4.14.1 and table 8.4.14.1.",
                                    "table number": 58,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.4.14.1: UE security capabilities information element",
                                    "table number": 59,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.4.15\tUE PC5 unicast signalling security policy",
                            "text_content": "The purpose of the UE PC5 unicast signalling security policy information element is to indicate the UE's configuration for integrity protection and ciphering of PC5 signalling messages.\nThe UE PC5 unicast signalling security policy is a type 3 information element with a length of 2 octets.\nThe UE PC5 unicast signalling security policy information element is coded as shown in figure 8.4.15.1.1 and table 8.4.15.1.\n\nFigure 8.4.15.1: UE PC5 unicast signalling security policy information element\nTable 8.4.15.1: UE PC5 unicast signalling security policy information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The UE PC5 unicast signalling security policy information element is coded as shown in figure 8.4.15.1.1 and table 8.4.15.1.",
                                    "table number": 60,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.4.15.1: UE PC5 unicast signalling security policy information element",
                                    "table number": 61,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.4.16\tMSB of KNRP-sess ID",
                            "text_content": "The purpose of the MSB of KNRP-sess ID information element is to carry the 8 most significant bits of the KNRP-sess ID.\nThe MSB of KNRP-sess ID information element is a type 3 information element with a length of 2 octets.\nThe MSB of KNRP-sess ID information element is coded as shown in figure 8.4.16.1 and table 8.4.16.1.\n\nFigure 8.4.16.1: MSB of KNRP-sess ID information element\nTable 8.4.16.1: MSB of KNRP-sess ID information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The MSB of KNRP-sess ID information element is coded as shown in figure 8.4.16.1 and table 8.4.16.1.",
                                    "table number": 62,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.4.16.1: MSB of KNRP-sess ID information element",
                                    "table number": 63,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.4.17\tKNRP ID",
                            "text_content": "The purpose of the KNRP ID information element is to carry the identity of the KNRP held by a UE.\nThe KNRP ID is a type 3 information element with a length of 5 octets.\nThe KNRP ID information element is coded as shown in figure 8.4.17.1 and table 8.4.17.1\n\nFigure 8.4.17.1: KNRP ID information element\nTable 8.4.17.1: KNRP ID information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The KNRP ID information element is coded as shown in figure 8.4.17.1 and table 8.4.17.1",
                                    "table number": 64,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.4.17.1: KNRP ID information element",
                                    "table number": 65,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.4.18\tSelected security algorithms",
                            "text_content": "The purpose of the Selected security algorithms information element is to indicate the algorithms to be used for ciphering and integrity protection.\nThe Selected security algorithms is a type 3 information element with a length of 2 octets.\nThe Selected security algorithms information element is coded as shown in figure 8.4.18.1 and table 8.4.18.1.\nFigure 8.4.18.1: Selected security algorithms information element\nTable 8.4.18.1: Selected security algorithms information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The Selected security algorithms information element is coded as shown in figure 8.4.18.1 and table 8.4.18.1.",
                                    "table number": 66,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.4.18.1: Selected security algorithms information element",
                                    "table number": 67,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.4.19\tLSB of KNRP-sess ID",
                            "text_content": "The purpose of the LSB of KNRP-sess ID information element is to carry the 8 least significant bits of the KNRP-sess ID.\nThe LSB of KNRP-sess ID is a type 3 information element with a length of 2 octets.\nThe LSB of KNRP-sess ID information element is coded as shown in figure 8.4.19.1 and table 8.4.19.1.\n\nFigure 8.4.19.1: LSB of KNRP-sess ID information element\nTable 8.4.19.1: LSB of KNRP-sess ID information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The LSB of KNRP-sess ID information element is coded as shown in figure 8.4.19.1 and table 8.4.19.1.",
                                    "table number": 68,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.4.19.1: LSB of KNRP-sess ID information element",
                                    "table number": 69,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.4.20\tMSBs of KNRP ID",
                            "text_content": "The purpose of the MSBs of KNRP ID information element is to carry the 16 most significant bits of the KNRP ID.\nThe MSBs of KNRP ID is a type 3 information element with a length of 3 octets.\nThe MSBs of KNRP ID information element is coded as shown in figure 8.4.20.1 and table 8.4.20.1.\n\nFigure 8.4.20.1: MSBs of KNRP ID information element\nTable 8.4.20.1: MSBs of KNRP ID information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The MSBs of KNRP ID information element is coded as shown in figure 8.4.20.1 and table 8.4.20.1.",
                                    "table number": 70,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.4.20.1: MSBs of KNRP ID information element",
                                    "table number": 71,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.4.21\tLSBs of KNRP ID",
                            "text_content": "The purpose of the LSBs of KNRP ID information element is to carry the 16 least significant bits of the KNRP ID.\nThe LSBs of KNRP ID is a type 3 information element with a length of 3 octets.\nThe LSBs of KNRP ID information element is coded as shown in figure 8.4.21.1 and table 8.4.21.1.\n\nFigure 8.4.21.1: LSBs of KNRP ID information element\nTable 8.4.21.1: LSBs of KNRP ID information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The LSBs of KNRP ID information element is coded as shown in figure 8.4.21.1 and table 8.4.21.1.",
                                    "table number": 72,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.4.21.1: LSBs of KNRP ID information element",
                                    "table number": 73,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.4.22\tUE PC5 unicast user plane security policy",
                            "text_content": "The purpose of the UE PC5 unicast user plane security policy information element is to indicate the UE's configuration for integrity protection and ciphering of PC5 user plane data.\nThe UE PC5 unicast user plane security policy is a type 3 information element with a length of 2 octets.\nThe UE PC5 unicast user plane security policy information element is coded as shown in figure 8.4.22.1 and table 8.4.22.1.\nFigure 8.4.22.1: UE PC5 unicast user plane security policy information element\nTable 8.4.22.1: UE PC5 unicast user plane security policy information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The UE PC5 unicast user plane security policy information element is coded as shown in figure 8.4.22.1 and table 8.4.22.1.",
                                    "table number": 74,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.4.22.1: UE PC5 unicast user plane security policy information element",
                                    "table number": 75,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.4.23\tConfiguration of UE PC5 unicast user plane security protection",
                            "text_content": "The purpose of the configuration of UE PC5 unicast user plane security protection information element is to indicate the agreed configuration for security protection of PC5 user plane data between UEs over the PC5 unicast link.\nThe configuration of UE PC5 unicast user plane security protection is a type 3 information element with a length of 2 octets.\nThe configuration of UE PC5 unicast user plane security protection information element is coded as shown in figure 8.4.23.1 and table 8.4.23.1.\nFigure 8.4.23.1: Configuration of UE PC5 unicast user plane security protection information element\nTable 8.4.23.1: Configuration of UE PC5 unicast user plane security protection information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The configuration of UE PC5 unicast user plane security protection information element is coded as shown in figure 8.4.23.1 and table 8.4.23.1.",
                                    "table number": 76,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.4.23.1: Configuration of UE PC5 unicast user plane security protection information element",
                                    "table number": 77,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.4.24\tRe-authentication indication",
                            "text_content": "The purpose of the Re-authentication indication information element is to indication that KNRP needs to be refreshed.\nThe Re-authentication indication information element is a type 3 information element, with a length of 2 octets.\nThe Re-authentication indication information element is coded as shown in figure 8.4.24.1 and table 8.4.24.1.\n\nFigure 8.4.24.1: Re-authentication indication information element\nTable 8.4.24.1: Re-authentication indication information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The Re-authentication indication information element is coded as shown in figure 8.4.24.1 and table 8.4.24.1.",
                                    "table number": 78,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.4.24.1: Re-authentication indication information element",
                                    "table number": 79,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.4.25\tLayer-2 ID",
                            "text_content": "The purpose of the layer-2 ID information element is to indicate the layer-2 ID that is used by UE.\nThe layer-2 ID is a type 3 information element with a length of 4 octets.\nThe layer-2 ID information element is coded as shown in figure 8.4.25.1 and table 8.4.25.1.\n\nFigure 8.4.25.1: Layer-2 ID information element\nTable 8.4.25.1: Layer-2 ID information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The layer-2 ID information element is coded as shown in figure 8.4.25.1 and table 8.4.25.1.",
                                    "table number": 80,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.4.25.1: Layer-2 ID information element",
                                    "table number": 81,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "title": "9\tCoding other than information element coding",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "9.1\tOverview",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause contains the coding of information other than the one provided by the information elements described in clause 8.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "9.2\tV2X message family encoding",
                    "description": "",
                    "summary": "",
                    "text_content": "The values are specified to identify the V2X message family according to table 9.2.1.\nTable 9.2.1: V2X message family\n\n",
                    "tables": [
                        {
                            "description": "Table 9.2.1: V2X message family",
                            "table number": 82,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "9.3\tNon-IP PDU format",
                    "description": "",
                    "summary": "",
                    "text_content": "The non-IP PDU is coded according to figure 9.3.1 and table 9.3.1.\nFigure 9.3.1: Non-IP PDU format\nTable 9.3.1: Non-IP PDU values\n\n",
                    "tables": [
                        {
                            "description": "The non-IP PDU is coded according to figure 9.3.1 and table 9.3.1.",
                            "table number": 83,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "Table 9.3.1: Non-IP PDU values",
                            "table number": 84,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "9.4\tEncoding of V2X MBS configuration SDP",
                            "text_content": "",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "9.4.1\tMinimum components of V2X MBS configuration SDP",
                            "text_content": "The V2X MBS configuration SDP shall contain at least the following parameters:\na)\tIP multicast address used for V2X communication over Uu using MBS; and\nb)\ta list of UDP port numbers used for V2X communication over Uu using MBS, each associated with a V2X message family or IP type of data as defined in clause 9.2.\nThese shall be expressed in SDP syntax (see IETF RFC 4566 [31]) according to the following clauses.\nIn a V2X MBS configuration SDP body, sending entity shall not include any media announcement field (\"m=\") other than the one specified in clause 9.4.3.\nIn a V2X MBS configuration SDP body, receiving entity shall ignore any media announcement field (\"m=\") other than the one specified in clause 9.4.3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "9.4.2\tIP multicast address",
                            "text_content": "The IP multicast address shall be defined according to the \"connection data\" field (\"c=\") of IETF RFC 4566 [31].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "9.4.3\tList of UDP port numbers and associated V2X message family",
                            "text_content": "The association between a UDP port number and a V2X message family is defined according to the media announcement field (\"m=\") of IETF RFC 4566 [31], with:\na)\tthe <port> portion set to the UDP port number;\nb)\tthe <media> portion set to \"application\";\nc)\tthe <transport> portion set to \"udp\";\nd)\tthe <fmt> portion set to \"vnd.3gpp.5gsv2x\"; and\ne)\tan fmtp attribute:\n1)\twith the <format> portion set to \"vnd.3gpp.5gsv2x\"; and\n2)\twith the <format specific parameters> portion containing a semicolon separated list of parameters as specified in clause A.1.2 with:\nA)\ta type parameter set to IP or non-IP; and\nB)\tif a UDP port is used for exchange of V2X messages of non-IP type of data, a v2x-message-family parameter set to the value of the associated V2X message family as specified in clause 9.2.\nIf multiple parameters are indicated in the <format specific parameters> portion of an fmpt attribute with the <format> portion set to \"vnd.3gpp.5gsv2x\", the order of parameters is not significant.\nSending entity shall not include any parameter not defined in the present version of the present specification in the <format specific parameters> portion of an fmpt attribute with the <format> portion set to \"vnd.3gpp.5gsv2x\".\nReceiving entity shall ignore any parameter included in the <format specific parameters> portion of an fmpt attribute with the <format> portion set to \"vnd.3gpp.5gsv2x\", such that the parameter is not specified in the present version of the present specification.\nReceiving entity shall ignore the media announcement field (\"m=\") if the type parameter does not contain a value or contains a value not specified in the present version of the present specification.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "9.4.4\tExample of V2X MBS configuration SDP",
                            "text_content": "Here is an example of a V2X MBS configuration SDP:\nv=0\no=user123 2890844526 2890842807 IN IP6 2201:056D::112E:144A:1E24\ns=V2X MBS configuration SDP example\nc=IN IP6 FF15::101\nm=application 1234 udp vnd.3gpp.5gsv2x\na=fmtp:vnd.3gpp.5gsv2x type=non-IP;v2x-message-family=1\nm=application 1235 udp vnd.3gpp.5gsv2x\na=fmtp:vnd.3gpp.5gsv2x v2x-message-family=2;type=non-IP\nm=application 1236 udp vnd.3gpp.5gsv2x\na=fmtp:vnd.3gpp.5gsv2x v2x-message-family=3;type=non-IP\nm=application 1237 udp vnd.3gpp.5gsv2x\na=fmtp:vnd.3gpp.5gsv2x type=ip\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "9.4.5\tMIME types",
                            "text_content": "The MIME types used by the specification are the followings:\na)\tvnd.3gpp.5gsv2x.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "10\tList of system parameters",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "10.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "The description of timers in the following tables should be considered a brief summary. The complete descriptions of the timers are in the procedures defined in clauses 5 and 6.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "10.2\tTimers of provisioning of parameters for V2X configuration procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "Timers of provisioning of parameters for V2X configuration are shown in table 10.2.1.\nTable 10.2.1: Timers of provisioning of parameters for V2X configuration – UE side\n\n",
                    "tables": [
                        {
                            "description": "Table 10.2.1: Timers of provisioning of parameters for V2X configuration – UE side",
                            "table number": 85,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "10.3\tTimers of PC5 unicast link management procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "Table 10.3.1: PC5 unicast link management timers\n\n",
                    "tables": [
                        {
                            "description": "Table 10.3.1: PC5 unicast link management timers",
                            "table number": 86,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "10.4\tTimers of PC5 broadcast mode communication",
                    "description": "",
                    "summary": "",
                    "text_content": "Table 10.4.1: PC5 mode communication timers\n\n",
                    "tables": [
                        {
                            "description": "Table 10.4.1: PC5 mode communication timers",
                            "table number": 87,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "10.5\tTimers of PC5 groupcast mode communication",
                    "description": "",
                    "summary": "",
                    "text_content": "Table 10.5.1: PC5 groupcast mode communication timers\n\nYour Name:\n<TS rapporteur name>\nYour Email Address:\n<TS rapporteur email address>\nMedia Type Name:\nApplication\nSubtype name:\nVendor tree – vnd.3gpp.5gsv2x\nRequired parameters:\ntype parameter.\nThe type parameter can be set to \"IP\", or \"non-IP\".\nA content of the application/vnd.3gpp.5gsv2x MIME type with the type parameter set to \"IP\" contains one V2X message such that the V2X message is an IP packet.\nA content of the application/vnd.3gpp.5gsv2x MIME type with the type parameter set to \"non-IP\" and the v2x-message-family parameter indicating a V2X message family contains one V2X message of the V2X message family.\nOptional parameters:\nv2x-message-family parameter.\nThe v2x-message-family parameter is included when the type parameter is set to \"non-IP\". Permissible values of the v2x-message-family are specified in 3GPP TS 24.587 clause 9.2.\nEncoding considerations:\nbinary.\nSecurity considerations:\nThis media type does not include provisions for directives that institute actions on a recipient's files or other resources.\nThe information transported in this media type does not include active or executable content.\nThis media type does not include provisions for directives that institute actions that, while not directly harmful to the recipient, may result in disclosure of information that either facilitates a subsequent attack or else violates a recipient's privacy in any way.\nThis media type does not employ compression.\nThis media type is not targeted for applications that require some sort of security assurance but don't provide the necessary security mechanisms themselves. The security assurance is expected to be provided by the environment this media type operates in. When this media type operates in environment described in 3GPP TS 33.185, security mechanisms are described in 3GPP TS 33.185.\nInteroperability considerations:\nReceiving entity shall ignore any media type parameter not defined in this media type registration.\nIf a content of the application/vnd.3gpp.v2x MIME type is transported using UDP transport, the UDP message contains one V2X message.\nPublished specification:\n3GPP TS 24.587 (http://www.3gpp.org/ftp/Specs/html-info/24587.htm)\nApplications which use this media type:\nV2X applications\nFragment identifier considerations:\nThis media type does not specify how applications interpret fragment identifiers associated with the media type.\nRestrictions on usage:\nNone\nProvisional registration? (standards tree only):\nn/a\nAdditional information:\n1. Deprecated alias names for this type:\tn/a\n2. Magic number(s):\tn/a\n3. File extension(s):\tn/a\n4. Macintosh File Type Code(s):\tn/a\n5. Object Identifier(s) or OID(s):\tn/a\nIntended usage:\nCommon.\nOther information/general comment:\nThe media type is intended to be used for V2X communication.\nPerson to contact for further information:\n-\tName: <MCC specification manager>\n-\tEmail: <MCC specification manager email address>\n-\tAuthor/Change controller:\ni)\tAuthor: 3GPP CT1 Working Group/3GPP_TSG_CT_WG1@LIST.ETSI.ORG\nii)\tChange controller: <MCC specification manager name>/<MCC specification manager email address>\n\n",
                    "tables": [
                        {
                            "description": "Table 10.5.1: PC5 groupcast mode communication timers",
                            "table number": 88,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 89,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        }
    ]
}